[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "",
    "text": "Course Info\nThis is a companion site for the same-titled workshop for the 44th annual Applied Statistics Workshop hosted by the Southern California Chapter of the ASA.",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#time-and-place",
    "href": "index.html#time-and-place",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Time and Place",
    "text": "Time and Place\n\nFriday, April 25 · 9am - 4pm PDT\nPlatt Conference Center, Cooper Auditorium\nCity of Hope, 1500 East Duarte Road, Duarte, CA 91010",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#instructor-profile",
    "href": "index.html#instructor-profile",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Instructor Profile",
    "text": "Instructor Profile\n\nLu Mao, PhD\n\nAssociate Professor of Biostatistics at UW-Madison\nMethodologic research\n\nR01HL149875: Novel Statistical Methods for Complex Time-to-Event Data in Cardiovascular Clinical Trials (12/01/2019 – 07/31/2028)\nDMS2015526: Randomized Trials with Non-Compliance (07/01/2020 – 06/30/2024)\n\nCollaborative research\n\nCardiovascular disease, cancer, radiology, behavioral health interventions\n\nTeaching\n\nSurvival Analysis: Theory and Methods (UW; 2020 - 2024)\n\nEditorial service\n\nStatistical Editor, JACC Journals\nAssociate Editor, Statistics for Biopharmaceutical Research",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Learning Outcomes",
    "text": "Learning Outcomes\n\nIdentify statistical and regulatory challenges with composite endpoints\n\nApply key methods such as hypothesis testing, power analysis, and regression\n\nGain hands-on experience with real data using R packages",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#syllabus",
    "href": "index.html#syllabus",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Syllabus",
    "text": "Syllabus\n\n1. Introduction (30 min)\n\n1.1 Examples & guidelines\n1.2 Traditional methods and limitations\n1.3 Win ratio methods and limitations\n\n2. Hypothesis Testing (40 min)\n\n2.1 Win ratio by Pocock et al. (2012)\n2.2 Statistical properties\n2.3 Handling recurrent events (R-package WR)\n2.4 Sample size calculation (R-package WR)\n\n3. Nonparametric Estimation (60 min)\n\n3.1 Restricted win ratio\n3.2 Average win time analysis (R-package rmt)\n\n3.1.1 Restricted mean time in favor of treatment\n3.1.2 Estimation, inference, and graphics\n3.1.3 Real Examples\n\n3.3 While-alive loss rate (R-package WA)\n\n3.2.1 Definition, interpretation, and estimation\n3.2.3 Real Examples\n\n\n4. Semiparametric Regression (45 min)\n\n4.1 Proportional win-fractions model (R-package WR)\n\n4.1.1 Model assumptions\n4.1.2 Estimation, inference, and model diagnostics\n4.1.3 Real Examples\n\n4.2 Variable selection and risk prediction\n\n4.2.1 Elastic net approach (WRNet)\n\n\n5. Discussions (25 min)\n\n5.1. Open problems\n\n5.1.1 Covariate adjustment\n5.1.2 Interim monitoring\n5.1.3 Meta analysis\n\n5.2. Course summary",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#r-packages",
    "href": "index.html#r-packages",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "R-Packages",
    "text": "R-Packages\nYou will need the following R packages for this workshop:\nWcompo, WR, rmt, and WA, along with base packages like tidyverse and survival.\n\ninstall.packages(c(\"Wcompo\", \"WR\", \"rmt\", \"WA\"))\nlibrary(tidyverse)\nlibrary(survival)\nlibrary(Wcompo)\nlibrary(WR)\nlibrary(rmt)\nlibrary(WA)",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "intro.html#slides",
    "href": "intro.html#slides",
    "title": "Introduction",
    "section": "",
    "text": "Chapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "intro.html#r-code",
    "href": "intro.html#r-code",
    "title": "1  Introduction",
    "section": "R code",
    "text": "R code\n\n\nShow the code\n#################################################################\n# This code generates the numerical results in chapter 1       ##\n#################################################################\n\nlibrary(survival)  # For standard (univariate) survival analysis\nlibrary(Wcompo)    # For weighted total events (CompoML function)\nlibrary(rmt)       # For the hfaction data set (Heart Failure ACTION trial)\nlibrary(tidyverse) # For data wrangling (dplyr, ggplot2, etc.)\n\n# load hfaction data\ndata(hfaction)\nhead(hfaction) \n#&gt; Shows the first rows of the hfaction data frame\n\n# convert status=1 for death, 2=hospitalization\n# (Swapping the original coding of event types in hfaction)\nhfaction &lt;- hfaction |&gt;\n  mutate(\n    status = case_when(\n      status == 1 ~ 2, # status previously \"1\" becomes \"2\" now\n      status == 2 ~ 1, # status previously \"2\" becomes \"1\" now\n      status == 0 ~ 0  # status \"0\" remains \"0\" (censoring)\n    )\n  )\n\nhead(hfaction)\n#&gt; Check that the status values have been reassigned correctly\n\n# count unique patients in each arm\nhfaction |&gt; \n  group_by(trt_ab) |&gt;\n  distinct(patid) |&gt;\n  count(trt_ab)\n#&gt; Summarizes how many unique patients are in each treatment arm (trt_ab)\n\n# TFE: take the first event per patient id\n# This means each patient is represented by their earliest event (or censoring)\nhfaction_TFE &lt;- hfaction |&gt;\n  arrange(patid, time) |&gt;\n  group_by(patid) |&gt;\n  slice_head() |&gt;\n  ungroup()\n\n# -------------------------------------------------------------------------\n# Mortality analysis\n# -------------------------------------------------------------------------\n\n## Get mortality data\nhfaction_D &lt;- hfaction |&gt;\n  filter(status != 2) # remove hospitalization records (now coded as \"2\")\n\n## Cox model for death against trt_ab\nobj_D &lt;- coxph(Surv(time, status) ~ trt_ab, data = hfaction_D)\nsummary(obj_D)\n#&gt; n= 426, number of events= 93 \n#&gt; coef exp(coef) se(coef)      z Pr(&gt;|z|)  \n#&gt; trt_ab -0.3973    0.6721   0.2129 -1.866   0.0621 .\n# Interpretation: a hazard ratio &lt; 1 suggests lower hazard of death in the \n# training arm, though p-value is ~0.06.\n\n# -------------------------------------------------------------------------\n# TFE analysis\n# -------------------------------------------------------------------------\n\n## how many of first events are death (1) or hosp (2)\nhfaction_TFE |&gt;\n  count(status)\n#&gt; Tells how many first events were coded as status=1 or status=2\n\n# Cox model for TFE against trt_ab\n# Here \"status &gt; 0\" means any event (death or hospitalization) vs. censoring\nobj_TFE &lt;- coxph(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE)\nsummary(obj_TFE)\n#&gt; Similar interpretation as above, now for time to first event \n# (either death or hospitalization).\n\n# -------------------------------------------------------------------------\n# Mortality vs TFE\n# -------------------------------------------------------------------------\n\nlibrary(ggsurvfit) # For Kaplan-Meier plots using ggplot2\nlibrary(patchwork) # For combining plots side by side\n\npD &lt;- survfit2(Surv(time, status) ~ trt_ab, data = hfaction_D) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Overall survival\")\n#&gt; pD is the plot of overall survival (death only) for each arm\n\npTFE &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Hospitalization-free survival\")\n#&gt; pTFE is the plot for time to first event (death or hospitalization)\n\n# Combine pD and pTFE plots side by side, sharing legends\npD + pTFE + plot_layout(guides = \"collect\") & \n  theme(\n    legend.position = \"top\", \n    legend.text = element_text(size = 12)\n  )\n\n# ggsave(\"images/intro_hfaction_unis.png\", width = 8, height = 4.5)\n#&gt; Uncomment to save the plot (if needed)\n\n# -------------------------------------------------------------------------\n# Total events (proportional mean)\n# -------------------------------------------------------------------------\n\n## fit proportional means model with death = 2 x hosp\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, hfaction$status, \n                  hfaction$trt_ab, w = c(2, 1))\n#&gt; This model weights death as \"2\" and hospitalization as \"1\". \n#&gt; CompoML fits a marginal proportional means model for these outcomes.\n\n## summary results\nobj_ML\n#&gt; Provides estimates of the weighted event rates in each arm, etc.\n\n## plot model-based mean functions\nplot(obj_ML, 0, ylim= c(0, 5), xlim= c(0, 4), xlab=\"Time (years)\", \n     col = \"red\", lwd = 2)\nplot(obj_ML, 1, add = TRUE, col = \"blue\", lwd=2)\nlegend(0, 5, col = c(\"red\", \"blue\"), c(\"Usual care\",\"Training\"), lwd = 2)\n#&gt; Illustrates the cumulative mean count of \"weighted\" events over time",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "testing.html#slides",
    "href": "testing.html#slides",
    "title": "Hypothesis Testing",
    "section": "",
    "text": "Chapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "testing.html#r-code",
    "href": "testing.html#r-code",
    "title": "2  Hypothesis Testing",
    "section": "R code",
    "text": "R code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in chapter 2         #\n##################################################################\n\n# load the survival package\nlibrary(survival)\n\n# install and load the WR package for\n# 1. dataset hfaction_cpx9;\n# 2. function WRrec() for win ratio test (of recurrent events and death)\n# 3. functions base() and WRSS() for sample size calculation\n# install.packages(\"WR\")\nlibrary(WR)\nlibrary(tidyverse) # for data wrangling (dplyr, ggplot2, etc.)\n\n##### Read in HF-ACTION DATA ########\n# same as rmt::hfaction used in chap 1 \n#  (except for status coding)\ndata(hfaction_cpx9)\nhfaction &lt;- hfaction_cpx9\nhead(hfaction)\n#&gt; Shows the first few rows of hfaction_cpx9 dataset\n\n# count unique patients in each arm\nhfaction |&gt; \n  group_by(trt_ab) |&gt; \n  distinct(patid) |&gt; \n  count(trt_ab)\n#&gt; This gives the number of unique patients (patid) by treatment arm (trt_ab)\n\n#### demo ############\n# WRrec() fits the recurrent event plus death model (Win Ratio approach)\nobj &lt;- WRrec(\n  ID = hfaction$patid,\n  time = hfaction$time,\n  status = hfaction$status,\n  trt = hfaction$trt_ab,\n  strata = hfaction$age60,\n  naive = TRUE\n)\n# summary results\nobj\n#&gt; Displays the main results, including win ratio estimates for each method.\n\n# LWR\nbeta &lt;- obj$log.WR  # log-win ratio for LWR\nse &lt;- obj$se        # standard error for log-win ratio (LWR)\n# test\npval &lt;- 2 * (1 - pnorm(abs(beta / se)))\npval\n#&gt; Two-sided p-value for LWR\n\n# NWR\nbeta.naive &lt;- obj$log.WR.naive  # log-win ratio for naive WR (NWR)\nse.naive &lt;- obj$se.naive        # its standard error\n# test\npval.naive &lt;- 2 * (1 - pnorm(abs(beta.naive / se.naive)))\npval.naive\n#&gt; Two-sided p-value for NWR\n\n# FWR\nbeta.FI &lt;- obj$log.WR.FI  # log-win ratio for Fisher’s information-based WR (FWR)\nse.FI &lt;- obj$se.FI        # standard error for log(FWR)\n# test\npval.FI &lt;- 2 * (1 - pnorm(abs(beta.FI / se.FI)))\npval.FI\n#&gt; Two-sided p-value for FWR\n\n#################################\n# Win ratio analyses: tabulate  #\n#################################\n\ndata &lt;- hfaction \n### create a dataset with only the first hospitalization -&gt; data.H1\n\n# hospitalization data\ntmpH &lt;- data[data$status == 2, ]\n# get the first record of each id\no &lt;- order(tmpH$patid, tmpH$time)\ntmpH &lt;- tmpH[o, ]\ntmpFH &lt;- tmpH[!duplicated(tmpH$patid), ]\n\n# combine it with mortality data\ndata.H1 &lt;- rbind(tmpFH, data[data$status != 2, ])\no &lt;- order(data.H1$patid, data.H1$time)\ndata.H1 &lt;- data.H1[o, ]\n\n# Function to create a summary table for\n# PWR, NWR, FWR, and LWR with their 95% CI and p-values\n# ind:  index (logical) for rows in the main 'data'\n# ind1: index (logical) for rows in 'data.H1'\n# r:    number of decimals for rounding in the output\ngwr.fun = function(ind, ind1, r = 2) {\n  \n  # fit NWR, FWR, and LWR to original data (multiple events)\n  obj &lt;- WRrec(\n    ID = data$patid[ind],\n    time = data$time[ind],\n    status = data$status[ind],\n    trt = data$trt_ab[ind],\n    strata = data$age60[ind],\n    naive = TRUE\n  )\n  \n  # fit sWR (PWR) to dataset with first hospitalization only\n  # This typically addresses \"semi-competing\" event structure\n  obj1 &lt;- WRrec(\n    ID = data.H1$patid[ind1],\n    time = data.H1$time[ind1],\n    status = data.H1$status[ind1],\n    trt = data.H1$trt_ab[ind1],\n    strata = data.H1$age60[ind1],\n    naive = FALSE\n  )\n  \n  # critical value for a 95% confidence interval\n  za &lt;- qnorm(0.975)\n  \n  ## LWR results\n  beta &lt;- obj$log.WR\n  se &lt;- obj$se\n  theta &lt;- obj$theta  # proportion of pairwise comparisons that are wins/losses\n  \n  # Format: percentage of wins, percentage of losses, \n  #         win ratio & 95% CI, p-value\n  r4 &lt;- c(\n    paste0(round(100 * theta[1], 1), \"%\"),  # Win\n    paste0(round(100 * theta[2], 1), \"%\"),  # Loss\n    paste0(\n      round(exp(beta), r), \" (\",\n      round(exp(beta - za * se), r), \", \",\n      round(exp(beta + za * se), r), \")\"\n    ),\n    round(1 - pchisq((beta / se)^2, 1), 3)\n  )\n  \n  ## PWR results\n  beta1 &lt;- obj1$log.WR\n  se1 &lt;- obj1$se\n  theta1 &lt;- obj1$theta\n  \n  r1 &lt;- c(\n    paste0(round(100 * theta1[1], 1), \"%\"),\n    paste0(round(100 * theta1[2], 1), \"%\"),\n    paste0(\n      round(exp(beta1), r), \" (\",\n      round(exp(beta1 - za * se1), r), \", \",\n      round(exp(beta1 + za * se1), r), \")\"\n    ),\n    round(1 - pchisq((beta1 / se1)^2, 1), 3)\n  )\n  \n  ## NWR results\n  beta.naive &lt;- obj$log.WR.naive\n  se.naive &lt;- obj$se.naive\n  theta.naive &lt;- obj$theta.naive\n  \n  r2 &lt;- c(\n    paste0(round(100 * theta.naive[1], 1), \"%\"),\n    paste0(round(100 * theta.naive[2], 1), \"%\"),\n    paste0(\n      round(exp(beta.naive), r), \" (\",\n      round(exp(beta.naive - za * se.naive), r), \", \",\n      round(exp(beta.naive + za * se.naive), r), \")\"\n    ),\n    round(1 - pchisq((beta.naive / se.naive)^2, 1), 3)\n  )\n  \n  ## FWR results\n  beta.FI &lt;- obj$log.WR.FI\n  se.FI &lt;- obj$se.FI\n  theta.FI &lt;- obj$theta.FI\n  \n  r3 &lt;- c(\n    paste0(round(100 * theta.FI[1], 1), \"%\"),\n    paste0(round(100 * theta.FI[2], 1), \"%\"),\n    paste0(\n      round(exp(beta.FI), r), \" (\",\n      round(exp(beta.FI - za * se.FI), r), \", \",\n      round(exp(beta.FI + za * se.FI), r), \")\"\n    ),\n    round(1 - pchisq((beta.FI / se.FI)^2, 1), 3)\n  )\n  \n  # Combine rows into a single table\n  result &lt;- rbind(r1, r2, r3, r4)\n  rownames(result) &lt;- c(\"PWR\", \"NWR\", \"FWR\", \"LWR\")\n  \n  return(result)\n}\n\n# Create table\n## Age &lt;= 60 years\nind &lt;- (data$age60 == 0)\nind1 &lt;- (data.H1$age60 == 0)\nresult.lt60 &lt;- gwr.fun(ind, ind1, r = 2)\n\n## Age &gt; 60 years\nind &lt;- (data$age60 == 1)\nind1 &lt;- (data.H1$age60 == 1)\nresult.ge60 &lt;- gwr.fun(ind, ind1, r = 2)\n\n## overall\nind &lt;- rep(TRUE, nrow(data))\nind1 &lt;- rep(TRUE, nrow(data.H1))\nresult.all &lt;- gwr.fun(ind, ind1, r = 2)\n\n# combine results \nresults &lt;- rbind(result.lt60, result.ge60, result.all)\ncolnames(results) &lt;- c(\"Win\", \"Loss\", \"Win ratio (95% CI)\", \"p-value\")\nnoquote(results)\n#&gt; Final table of all 4 measures (PWR, NWR, FWR, LWR) across strata.\n\n############################################################################\n#               Sample size calculation                                    #     \n############################################################################\n\n# get training arm data\npilot &lt;- hfaction |&gt;\n  filter(trt_ab == 1)\n# number of subjects\npilot |&gt;\n  distinct(patid) |&gt;\n  count()\n#&gt; This indicates how many unique subjects were in the training arm\n\n############## estimate parameters ##############\n# Get the variables from pilot dataset\n# to estimate baseline parameters \n# lambda_D, lambda_H, kappa\n\noutcome_base &lt;- gumbel.est(pilot$patid, pilot$time / 12, pilot$status)\n\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- outcome_base$kappa\n\nlambda_D\nlambda_H\nkappa\n#&gt; Baseline hazards for death/hospitalization and the gumbel 'kappa' parameter\n\n## Kendall's rank correlation\n1 - 1/kappa\n#&gt; [1] 0.360812\n#&gt; This measures correlation between timing of repeated events\n\n### demo ###################\n# set design parameters\ntau_b &lt;- 3   # time from baseline to start of follow-up for base() computation\ntau &lt;- 4     # total follow-up (in years)\nlambda_L &lt;- 0.01  # Additional parameter used in the base() function\n\n# use base() function to compute zeta2 and delta\n## may take up to 30s\nbparam &lt;- base(lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\n#&gt; bparam includes the baseline rates and distribution shape \n#&gt; used for sample size calculations\n\n# compute sample size under HRs 0.8 and 0.9\n# for death and nonfatal event, respectively\nobj &lt;- WRSS(\n  xi = log(c(0.9, 0.8)),\n  bparam = bparam,\n  q = 0.5,\n  alpha = 0.05,\n  power = 0.8\n)\nobj$n\n#&gt; The required sample size for the given HRs at 80% power\n\n## effect size specification\nthetaD &lt;- seq(0.6, 0.95, by = 0.05) # hazard ratio for death\nthetaH &lt;- seq(0.6, 0.95, by = 0.05) # hazard ratio for hospitalization\n\n## create a matrix \"SS08\" for sample size powered at 80% \n## under each combination of thetaD and thetaH\nmD &lt;- length(thetaD)\nmH &lt;- length(thetaH)\nSS08 &lt;- matrix(NA, mD, mH)\nrownames(SS08) &lt;- thetaD\ncolnames(SS08) &lt;- thetaH\n\n## fill in the computed sample size values\nfor (i in 1:mD) {\n  for (j in 1:mH) {\n    ## sample size under hazard ratios thetaD[i] for death \n    ## and thetaH[j] for hospitalization\n    SS08[i, j] &lt;- WRSS(\n      xi = log(c(thetaD[i], thetaH[j])),\n      bparam = bparam,\n      q = 0.5,\n      alpha = 0.05,\n      power = 0.8\n    )$n\n  }\n}\n## print the calculated sample sizes\nprint(SS08)\n#&gt; Shows how sample size changes under different hazard ratios for death/hosp\n\n## repeating the same calculation for power = 90%\nSS09 &lt;- matrix(NA, mD, mH)\nrownames(SS09) &lt;- thetaD\ncolnames(SS09) &lt; -thetaH  # As in original code; sets the colnames to the sequence of thetaH\n\n## fill in the computed sample size values\nfor (i in 1:mD) {\n  for (j in 1:mH) {\n    ## sample size under hazard ratios thetaD[i] for death \n    ## and thetaH[j] for hospitalization\n    SS09[i, j] &lt;- WRSS(\n      xi = log(c(thetaD[i], thetaH[j])),\n      bparam = bparam,\n      q = 0.5,\n      alpha = 0.05,\n      power = 0.9\n    )$n\n  }\n}\n## print the calculated sample sizes\nprint(SS09)\n#&gt; Sample sizes under 90% power requirements\n\noldpar &lt;- par(mfrow = par(\"mfrow\"))\npar(mfrow = c(1, 2))\n\npersp(\n  thetaD, thetaH, SS08 / 1000,\n  theta = 50, phi = 15, expand = 0.8, col = \"gray\",\n  ltheta = 180, lphi = 180, shade = 0.75,\n  ticktype = \"detailed\",\n  xlab = \"\\n HR on Death\", ylab = \"\\n HR on Hospitalization\",\n  zlab = paste0(\"\\n Sample Size (10e3)\"),\n  main = \"Power = 80%\",\n  zlim = c(0, 26)\n)\n#&gt; 3D perspective plot of sample size (in thousands) for power=80% \n#&gt; over various hazard ratios for death/hosp\n\npersp(\n  thetaD, thetaH, SS09 / 1000,\n  theta = 50, phi = 15, expand = 0.8, col = \"gray\",\n  ltheta = 180, lphi = 180, shade = 0.75,\n  ticktype = \"detailed\",\n  xlab = \"\\nHR on Death\", ylab = \"\\nHR on Hospitalization\",\n  zlab = paste0(\"\\n Sample Size (10e3)\"),\n  main = \"Power = 90%\",\n  zlim = c(0, 26)\n)\n#&gt; Similar 3D perspective for power=90%\n\n\n\\[\\newcommand{\\d}{{\\rm d}}\n\\newcommand{\\T}{{\\rm T}}\n\\newcommand{\\dd}{{\\rm d}}\n\\newcommand{\\cc}{{\\rm c}}\n\\newcommand{\\pr}{{\\rm pr}}\n\\newcommand{\\var}{{\\rm var}}\n\\newcommand{\\se}{{\\rm se}}\n\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\n\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\def\\a{{(a)}}\n\\def\\b{{(1-a)}}\n\\def\\t{{(1)}}\n\\def\\c{{(0)}}\n\\def\\d{{\\rm d}}\n\\def\\T{{\\rm T}}\n\\def\\bs{\\boldsymbol}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "estimation.html#slides",
    "href": "estimation.html#slides",
    "title": "3  Nonparametric Estimation",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "estimation.html#r-code",
    "href": "estimation.html#r-code",
    "title": "3  Nonparametric Estimation",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 3       ##\n##################################################################\n\n\n\n# install.packages(\"rmt\")\nlibrary(rmt)\nlibrary(tidyverse)\n\n##### Read in HF-ACTION DATA########\ndata(hfaction)\nhead(hfaction)\n\n# TFE: take the first event per patient id\nhfaction_TFE &lt;- hfaction |&gt; \n  arrange(patid, time) |&gt; \n  group_by(patid) |&gt; \n  slice_head() |&gt; \n  ungroup()\n\n###### Standard RMST analysis #################\nlibrary(survRM2)\n\n# Mortality analysis ------------------------------------------------------\n\n## get mortality data\nhfaction_D &lt;- hfaction |&gt; \n  filter(status != 1) # remove hospitalization records\n\n## RMST analysis for overall survival \nrmst_obj &lt;- rmst2(hfaction_D$time, hfaction_D$status&gt;0, hfaction_D$trt_ab, tau=3.97)\nrmst_obj\n# Between-group contrast \n#                       Est. lower .95 upper .95     p\n# RMST (arm=1)-(arm=0) 0.238     0.013     0.464 0.039\n# RMST (arm=1)/(arm=0) 1.074     1.003     1.150 0.040\n# RMTL (arm=1)/(arm=0) 0.680     0.468     0.988 0.043\nrmst &lt;- rmst_obj$unadjusted.result[1, 1] * 12 # convert to month\nrmst_p &lt;- rmst_obj$unadjusted.result[1, 4]\n\n\n# TFE analysis --------------------------------------------------------\n\n## how many of first events are death (1) or hosp (2)\nhfaction_TFE |&gt; \n  count(status)\n\n##RMST analysis for hospitalization-free survival \nrmest_obj &lt;- rmst2(hfaction_TFE$time, hfaction_TFE$status&gt;0, hfaction_TFE$trt_ab, tau=3.97)\nrmest_obj\n# Between-group contrast \n#                       Est. lower .95 upper .95     p\n# RMST (arm=1)-(arm=0) 0.198    -0.064     0.459 0.139\n# RMST (arm=1)/(arm=0) 1.145     0.957     1.370 0.139\n# RMTL (arm=1)/(arm=0) 0.924     0.832     1.027 0.141\n# extract p-value\nrmest &lt;- rmest_obj$unadjusted.result[1, 1] * 12 # convert to month\nrmest_p &lt;- rmest_obj$unadjusted.result[1, 4]\n\n\n\n\n\n# Mortality vs TFE --------------------------------------------------------\n\nlibrary(ggsurvfit)\nlibrary(patchwork)\n\npD &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_D) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  annotate(\"text\", x = 4, y = 1, hjust = 1, vjust = 1, \n           label = str_c(\"4y-RMST = \", round(rmst, 2), \" months\",\n                            \" (P = \", round(rmst_p, 3), \")\")) +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Overall survival\")\n\npTFE &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE) |&gt;\n  ggsurvfit(linewidth = 1) +\n  annotate(\"text\", x = 4, y = 1, hjust = 1, vjust = 1, \n           label = str_c(\"4y-RMEST = \", round(rmest, 2), \" months\",\n                         \" (P = \", round(rmest_p, 3), \")\")) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Hospitalization-free survival\",\n       caption = \"RMEST: restricted mean event-free survival time\")\n\n\npD + pTFE + plot_layout(guides = \"collect\") & \n  theme(\n    legend.position = \"top\", \n    legend.text = element_text(size = 12)\n  ) \n\n# ggsave(\"images/est_hfaction_unis.png\", width = 8, height = 4.6)\n\n\n########################\n# RMT-IF analysis\n########################\n\n\n# analyze the data using rmtfit()\nobj &lt;- rmtfit(rec(patid, time, status) ~ trt_ab, data = hfaction)\n\n\nsummary(obj, Kmax = 1, tau = 3.97)\n\n#############################################################\n# Graphical analysis of the HF-ACTION trial to\n# evaluate the effect of exercise training.\n###########################################################\n\npar(mfrow=c(1,2))\n# Kmax=4: to aggregate k=4,..., K\nbouquet(obj,Kmax=4,cex.group = 1.0,\n        xlab=\"Restricted mean win/loss time (years)\",\n        ylab=\"Follow-up time (years)\",group.label=F,ylim=c(0,4.2))\ntext(-0.8,4.15,paste(\"Usual care\"))\ntext(0.8,4.15,paste(\"Exercise training\"))\n\nplot(obj,conf=T,lwd=2, xlab=\"Follow-up time (years)\",\n     ylab=\"RMT-IF of training (years)\",main=\"\")\npar(mfrow=c(1,1))\n\n### LaTeX table ###\n\n### format to LATEX table\npval_fmt3=function(x){\n  if(x&lt;0.001){\n    return(\"$&lt;$0.001\")\n  }else{\n    return(round(x,3))\n  }\n}\n\n\nltable=NULL\n# aggregate the results for k=1,..., K\nhosp_sum=summary(obj,Kmax=1,tau=3.97)$tab\n# aggregate the results for k=4,..., K\nall_sum=summary(obj,Kmax=4,tau=3.97)$tab\n\nltable=c(\"&\",\"&\",\"&\",round(12*hosp_sum[1,1],2),\"&\",round(12*hosp_sum[1,2],2),\"&\",pval_fmt3(hosp_sum[1,4]),\"\\\\\")\n\nfor (i in 1:6){\n  tmp=c(\"&\",i,\"&&\",round(12*all_sum[i,1],2),\"&\",round(12*all_sum[i,2],2),\"&\",pval_fmt3(all_sum[i,4]),\"\\\\\")\n  ltable=rbind(ltable,tmp)\n}\n\nltable[5,2]=\"4+\"\nltable[6:7,2]=\"\"\n\nrownames(ltable)=c(\"Hopitalization\",\"\",\"\" ,\"\",\"\",\"Death\",\"Overall\")\n\nnoquote(ltable)\n\n\n\n#######################################################################\n#               WA analysis                                           #\n#######################################################################\n\n\n# install.packages(\"WA\")\nlibrary(WA)\n\n# load the hf-action study data\nhead(hfaction)\n\n# descriptive analysis\n\n## death & hosp rates\n\nhfaction |&gt; \n  group_by(trt_ab,patid) |&gt; \n  summarize(\n    ND = sum(status == 2),\n    NH = sum(status == 1)\n  ) |&gt; \n  summarize(\n    death_rate = mean(ND),\n    avgNH = mean(NH),\n    sdNH = sd(NH)\n  )\n\n\n# weighted while-alive event rate (death vs hosp = 2:1).\nobj &lt;- LRfit(hfaction$patid, hfaction$time, hfaction$status, hfaction$trt_ab, \n             Dweight = 2)\n## print some descriptive information \nobj\n\n## summarize the inference results at tau=4 years\nsummary(obj, tau = 3.97, joint.test = TRUE)\n\nplot(obj)\n\n# unadjusted cumulative mean (Ch 1) ----------------------------------------\n## fit proportional means model with death = 2 x hosp\nlibrary(Wcompo)\n## change status coding\nstatus &lt;- hfaction$status\nstatus[status != 0] &lt;- 3 - status[status != 0]\n\n\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, status, \n                  hfaction$trt_ab, w = c(2, 1))\n## summary results\nt &lt;- obj_ML$t ## time\nmu0 &lt;- obj_ML$y ## baseline mean of t\nmu1 &lt;- mu0 * exp(as.numeric(obj_ML$beta))\n\n## plot survival-adjusted cumulative event \n## vs unadjusted under PM model\nplot(obj, ylab = \"Cumulative loss\", xlab = \"Time (years)\")\nlines(t[t&lt;=3.97], mu0[t&lt;=3.97], lty = 3, col = \"red\", lwd = 2)\nlines(t[t&lt;=3.97], mu1[t&lt;=3.97], lty = 3, col = \"blue\", lwd = 2)\nlegend(\"bottomright\", col = c(\"red\", \"red\", \"blue\", \"blue\"), \n       c(\"Usual care (WA)\", \"Usual care (unadj)\", \n         \"Training (WA)\", \"Training (unadj)\"), \n       lty = c(1, 3, 1, 3), lwd = 2)"
  },
  {
    "objectID": "regression.html#slides",
    "href": "regression.html#slides",
    "title": "4  Semiparametric Regression",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "regression.html#r-code",
    "href": "regression.html#r-code",
    "title": "4  Semiparametric Regression",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 4       ##\n##################################################################\n\n\n# install.packages(\"WR\")\nlibrary(WR)\nlibrary(tidyverse)\nlibrary(knitr) # for formatted table output\n\n\n# load the data\ndata(non_ischemic)\n# head(non_ischemic)\n\n\n\n# Descriptive analysis ----------------------------------------------------\n\n# function to convert 1-0 to Yes-No\none_zero_to_yn &lt;- function(x){\n  if_else(x == 1, \"Yes\", \"No\")\n}\n\n\n# clean up data\ndf &lt;- non_ischemic |&gt; \n  filter(status != 2) |&gt;  # de-duplicate\n  mutate( # clean up the levels of categorical variables\n    trt_ab = fct(if_else(trt_ab == 0, \"Usual care\", \"Training\")),\n    sex = if_else(sex == 1, \"Female\", \"Male\"),\n    race = case_when(\n      Black.vs.White == 1 ~ \"Black\",\n      Other.vs.White == 1 ~ \"Other\",\n      Black.vs.White == 0 & Other.vs.White == 0 ~ \"White\"\n    ),\n    race = fct(race),\n    across(hyperten:smokecurr, one_zero_to_yn)\n  ) \n\n\n## a function to compute median (IQR) for x\n## rounded to the rth decimal place\nmed_iqr &lt;- function(x, r = 1){\n  qt &lt;- quantile(x, na.rm = TRUE)\n  \n  str_c(round(qt[3], r), \" (\", \n        round(qt[2], r), \", \",\n        round(qt[4], r), \")\")\n}\n\n# create summary table for quantitative variables\n# age, size, nodes, prog, estrg\ntab_quant &lt;- df |&gt; \n  group_by(trt_ab) |&gt; \n  summarize(\n    across(c(age, bmi, bipllvef), med_iqr)\n  ) |&gt; \n  pivot_longer( # long format: value = median (IQR); name = variable names\n    !trt_ab,\n    values_to = \"value\",\n    names_to = \"name\"\n  ) |&gt; \n  pivot_wider( # wide format: name = variable names; trt_ab as columns\n    values_from = value,\n    names_from = trt_ab\n  ) |&gt; \n  mutate(\n    name = case_when( # format the variable names\n      name == \"age\" ~ \"Age (years)\",\n      name == \"bmi\" ~ \"BMI\",\n      name == \"bipllvef\" ~ \"LVEF (%)\"\n    )\n  )\n\n\n## a function that computes N (%) for each level of var\n## by group in data frame df (percent rounded to rth point)\nfreq_pct&lt;- function(df, group, var, r = 1){\n  # compute the N for each level of var by group\n  var_counts &lt;- df |&gt; \n    group_by({{ group }}, {{ var }}) |&gt; \n    summarize(\n      n = n(),\n      .groups = \"drop\"\n    ) \n  # compute N (%)\n  var_counts |&gt; \n    left_join( # compute the total number (demoninator) in each group\n      # and joint it back to the numerator\n      var_counts |&gt; group_by({{ group }}) |&gt; summarize(N = sum(n)),\n      by = join_by({{ group }})\n    ) |&gt; \n    mutate( # N (%)\n      value = str_c(n, \" (\", round(100 * n / N, r), \"%)\")\n    ) |&gt; \n    select(- c(n, N)) |&gt; \n    pivot_wider( # put group levels on columns\n      names_from = {{ group }},\n      values_from = value\n    ) |&gt; \n    rename(\n      name = {{ var }} # name = variable names \n    )\n}\n\n# Apply this function to sex, race, hyperten:smokecurr \n  \n# sex\nsex &lt;- df |&gt;\n  freq_pct(trt_ab, sex) |&gt; \n  mutate(\n    name = str_c(\"Sex - \", name)\n  )\n\n# race\nrace &lt;- df |&gt;\n  freq_pct(trt_ab, race) |&gt; \n  mutate(\n    name = str_c(\"Race - \", name)\n  )\n\nhyperten &lt;- df |&gt;\n  freq_pct(trt_ab, hyperten) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Hypertension\"\n  )\n\nhyperten &lt;- df |&gt;\n  freq_pct(trt_ab, hyperten) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Hypertension\"\n  )\n\n\nCOPD &lt;- df |&gt;\n  freq_pct(trt_ab, COPD) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"COPD\"\n)  \n\ndiabetes &lt;- df |&gt;\n  freq_pct(trt_ab, diabetes) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Diabetes\"\n  )  \n\nacei &lt;- df |&gt;\n   freq_pct(trt_ab, acei) |&gt; \n   filter(name == \"Yes\") |&gt; \n   mutate(\n     name = \"ACE Inhibitor\"\n   ) \n   \nbetab &lt;- df |&gt;\n  freq_pct(trt_ab, betab) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Beta Blocker\"\n  )     \n\n\nsmokecurr &lt;- df |&gt;\n  freq_pct(trt_ab, betab) |&gt; \n  filter(name == \"smokecurr\") |&gt; \n  mutate(\n    name = \"Smoker\"\n  )     \n\n\ntabone &lt;- bind_rows(\n  tab_quant[1, ],\n  sex, race,\n  tab_quant[2:3, ],\n  hyperten, COPD, diabetes, acei, betab, smokecurr    \n)\n\n\n## add N to group names  \ncolnames(tabone) &lt;- c(\" \", str_c(colnames(tabone)[2:3], \" (N=\", table(df$trt_ab),\")\"))\n## print out the table\nkable(tabone, align = c(\"lcc\"))\n\n\n\n\nTable 4.1: Patient characteristics in non-ischemic cohort of HF-ACTION\n\n\n\nUsual care (N=231)\nTraining (N=220)\n\n\n\n\nAge (years)\n56 (46, 65.5)\n54 (46, 62.2)\n\n\nSex - Female\n153 (66.2%)\n121 (55%)\n\n\nSex - Male\n78 (33.8%)\n99 (45%)\n\n\nRace - White\n117 (50.6%)\n111 (50.5%)\n\n\nRace - Black\n103 (44.6%)\n101 (45.9%)\n\n\nRace - Other\n11 (4.8%)\n8 (3.6%)\n\n\nBMI\n31.3 (26.3, 37.2)\n31 (25.8, 36.5)\n\n\nLVEF (%)\n25.1 (20.9, 31.3)\n25.1 (20.9, 31.2)\n\n\nHypertension\n129 (55.8%)\n129 (58.6%)\n\n\nCOPD\n21 (9.1%)\n15 (6.8%)\n\n\nDiabetes\n71 (30.7%)\n58 (26.4%)\n\n\nACE Inhibitor\n174 (75.3%)\n167 (75.9%)\n\n\nBeta Blocker\n223 (96.5%)\n211 (95.9%)\n\n\n\n\n\n\n\n\nShow the code\n# PW regression analysis --------------------------------------------------\n\n# re-label the covariates with informative names.\n\ncolnames(non_ischemic)[4:16]=c(\n  \"Training vs Usual\",\"Age (year)\",\"Male vs Female\",\"Black vs White\", \n  \"Other vs White\", \"BMI\",\"LVEF\",\"Hypertension\",\"COPD\",\"Diabetes\",\n  \"ACE Inhibitor\",\"Beta Blocker\", \"Smoker\"\n)\n\n\np &lt;- ncol(non_ischemic)-3\n\n# extract ID, time, status and covariates matrix Z from the data.\n# note that: ID, time and status should be column vector\nID &lt;- non_ischemic[,\"ID\"]\ntime &lt;- non_ischemic[,\"time\"] / 30.5 # days to months\nstatus &lt;- non_ischemic[,\"status\"]\nZ &lt;- as.matrix(non_ischemic[,4:(3+p)])\n\n# pass the parameters into the function\nobj &lt;- pwreg(ID, time, status, Z)\nobj\n\n# extract estimates of (beta_4, beta_5)\nbeta &lt;- matrix(obj$beta[4:5])\n# extract estimated covariance matrix for (beta_4, beta_5)\nSigma &lt;- obj$Var[4:5, 4:5]\n# compute chisq statistic in quadratic form\nchistats &lt;- t(beta) %*% solve(Sigma) %*% beta  \n\n# compare the Wald statistic with the reference\n# distribution of chisq(2) to obtain the p-value\n1 - pchisq(chistats, df = 2)\n#&gt;           [,1]\n#&gt; [1,] 0.1016988\n\n\n# compute score processes\nscore_obj &lt;- score.proc(obj)\n# plot scores for all 13 covariates\npar(mfrow = c(4, 4))\nfor(i in c(1:13)){\n  plot(score_obj, k = i, xlab = \"Time (months)\")\n  # add reference lines\n  abline(a = 2, b = 0, lty = 3)\n  abline(a = 0, b = 0, lty = 3)\n  abline(a = - 2, b = 0, lty = 3)\n}\n\n\n### Exercise: Stratify by sex ###\nsex &lt;- Z[, 3]\nZs &lt;- Z[, -3]\nobj_str&lt;-pwreg(ID, time, status, Zs, strata = sex)\nobj_str"
  },
  {
    "objectID": "discussions.html#slides",
    "href": "discussions.html#slides",
    "title": "5  Discussions",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Akacha, M., Binkowitz, B., Bretz, F., Fritsch, A., Hougaard, P.,\nJahn-Eimermacher, A., & al., et. (2018). Request for CHMP\nqualification opinion: Clinically interpretable treatment effect\nmeasures based on recurrent event endpoints that allow for efficient\nstatistical analyses. http://www.ema.europa.eu/documents/other/qualification-opinion-treatment-effect-measures-when-using-recurrent-event-endpoints-applicants_en.pdf.\n\n\nAkacha, M., Bretz, F., Ohlssen, D., Rosenkranz, G., & Schmidli, H.\n(2017). Estimands and Their Role in Clinical Trials. Statistics in\nBiopharmaceutical Research, 9(3), 268–271. https://doi.org/10.1080/19466315.2017.1302358\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win\nratio analysis of a composite outcome based on prioritized components.\nBiostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBennett, S. (1983). Analysis of survival data by the proportional odds\nmodel. Statistics in Medicine, 2(2), 273–277. https://doi.org/10.1002/sim.4780020223\n\n\nBrunner, E., Vandemeulebroecke, M., & Mütze, T. (2021). Win odds: An\nadaptation of the win ratio to include ties. Statistics in\nMedicine, 40(14), 3367–3384. https://doi.org/10.1002/sim.8967\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized\noutcomes in the two-sample problem. Statistics in\nMedicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nCHMP. (2020). Qualification opinion of clinically interpretable\ntreatment effect measures based on recurrent event endpoints that allow\nfor efficient statistical analyses. https://www.ema.europa.eu/en/documents/other/qualification-opinion-clinically-interpretable-treatment-effect-measures-based-recurrent-event_en.pdf.\n\n\nCui, Y., & Huang, B. (2023). WINS: The r WINS package. https://CRAN.R-project.org/package=WINS\n\n\nDeltuvaite-Thomas, V., Verbeeck, J., Burzykowski, T., Buyse, M.,\nTournigand, C., Molenberghs, G., & Thas, O. (2022). Generalized\npairwise comparisons for censored data: An overview. Biometrical\nJournal, 65(2). https://doi.org/10.1002/bimj.202100354\n\n\nDong, G., Hoaglin, D. C., Huang, B., Cui, Y., Wang, D., Cheng, Y., &\nGamalo-Siebers, M. (2023). The stratified win statistics (win ratio, win\nodds, and net benefit). Pharmaceutical Statistics,\n22(4), 748–756. https://doi.org/10.1002/pst.2293\n\n\nDong, G., Hoaglin, D. C., Qiu, J., Matsouaka, R. A., Chang, Y.-W., Wang,\nJ., & Vandemeulebroecke, M. (2020). The Win Ratio: On Interpretation\nand Handling of Ties. Statistics in Biopharmaceutical Research,\n12(1), 99–106. https://doi.org/10.1080/19466315.2019.1575279\n\n\nDong, G., Huang, B., Chang, Y.-W., Seifu, Y., Song, J., & Hoaglin,\nD. C. (2020a). The win ratio: Impact of censoring and\nfollow-up time and use with nonproportional hazards.\nPharmaceutical Statistics, 19(3), 168–177. https://doi.org/10.1002/pst.1977\n\n\nDong, G., Huang, B., Verbeeck, J., Cui, Y., Song, J., Gamalo-Siebers,\nM., Wang, D., Hoaglin, D. C., Seifu, Y., Mütze, T., & Kolassa, J.\n(2022). Win statistics (win ratio, win odds, and net benefit) can\ncomplement one another to show the strength of the treatment effect on\ntime-to-event outcomes. Pharmaceutical\nStatistics, 22(1), 20–33. https://doi.org/10.1002/pst.2251\n\n\nDong, G., Huang, B., Wang, D., Verbeeck, J., Wang, J., & Hoaglin, D.\nC. (2021). Adjusting win statistics for dependent censoring.\nPharmaceutical Statistics, 20(3), 440–450. https://doi.org/10.1002/pst.2086\n\n\nDong, G., Li, D., Ballerstedt, S., & Vandemeulebroecke, M. (2016). A\ngeneralized analytic solution to the win ratio to analyze a composite\nendpoint considering the clinical importance order among components.\nPharmaceutical Statistics, 15(5), 430–437. https://doi.org/10.1002/pst.1763\n\n\nDong, G., Mao, L., Huang, B., Gamalo-Siebers, M., Wang, J., Yu, G.,\n& Hoaglin, D. C. (2020b). The inverse-probability-of-censoring\nweighting (IPCW) adjusted win ratio statistic: an unbiased estimator in\nthe presence of independent censoring. Journal of Biopharmaceutical\nStatistics, 30(5), 882–899. https://doi.org/10.1080/10543406.2020.1757692\n\n\nDong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2017). The\nstratified win ratio. Journal of Biopharmaceutical Statistics,\n28(4), 778–796. https://doi.org/10.1080/10543406.2017.1397007\n\n\nEUnetHTA. (2015). Guidance for industry: Multiple endpoints in\nclinical trials. https://www.eunethta.eu/wp-content/uploads/2018/01/Endpoints-used-for-Relative-Effectiveness-Assessment-Composite-endpoints_Amended-JA1-Guideline_Final-Nov-2015_0.pdf\n\n\nFay, M. P., Brittain, E. H., Shih, J. H., Follmann, D. A., &\nGabriel, E. E. (2018). Causal estimands and confidence intervals\nassociated with Wilcoxon-Mann-Whitney tests in\nrandomized experiments. Statistics in Medicine,\n37(20), 2923–2937. https://doi.org/10.1002/sim.7799\n\n\nFDA. (2022). Guidance for industry: Multiple endpoints in clinical\ntrials. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/multiple-endpoints-clinical-trials-guidance-industry\n\n\nFDA. (2023). Guidance document: Adjusting for covariates in\nrandomized clinical trials for drugs and biological products. US\nFood and Drug Adminstration. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/adjusting-covariates-randomized-clinical-trials-drugs-and-biological-products\n\n\nFine, J. P., & Gray, R. J. (1999). A Proportional Hazards Model for\nthe Subdistribution of a Competing Risk. Journal of the American\nStatistical Association, 94(446), 496–509. https://doi.org/10.1080/01621459.1999.10474144\n\n\nFinkelstein, D. M., & Schoenfeld, D. A. (1999). Combining mortality\nand longitudinal measures in clinical trials. Statistics in\nMedicine, 18(11), 1341–1354. https://doi.org/10.1002/(sici)1097-0258(19990615)18:11&lt;1341::aid-sim129&gt;3.0.co;2-7\n\n\nFollmann, D., Fay, M. P., Hamasaki, T., & Evans, S. (2019). Analysis\nof ordered composite endpoints. Statistics in Medicine,\n39(5), 602–616. https://doi.org/10.1002/sim.8431\n\n\nFreemantle, N., Calvert, M., Wood, J., Eastaugh, J., & Griffin, C.\n(2003). Composite Outcomes in Randomized Trials. JAMA,\n289(19), 2554. https://doi.org/10.1001/jama.289.19.2554\n\n\nFritsch, A., Schlömer, P., Mendolia, F., Mütze, T., &\nJahn-Eimermacher, A. (2023). Efficiency Comparison of Analysis Methods\nfor Recurrent Event and Time-to-First Event Endpoints in the Presence of\nTerminal EventsApplication to Clinical Trials in Chronic\nHeart Failure. Statistics in Biopharmaceutical Research,\n15(2), 268–279. https://doi.org/10.1080/19466315.2021.1945488\n\n\nGasparyan, S. B., Folkvaljon, F., Bengtsson, O., Buenconsejo, J., &\nKoch, G. G. (2020). Adjusted win ratio with stratification: Calculation\nmethods and interpretation. Statistical Methods in Medical\nResearch, 30(2), 580–611. https://doi.org/10.1177/0962280220942558\n\n\nGasparyan, S. B., Kowalewski, E. K., Folkvaljon, F., Bengtsson, O.,\nBuenconsejo, J., Adler, J., & Koch, G. G. (2021). Power and sample\nsize calculation for the win odds test: application to an ordinal\nendpoint in COVID-19 trials. Journal of Biopharmaceutical\nStatistics, 31(6), 765–787. https://doi.org/10.1080/10543406.2021.1968893\n\n\nGehan, E. A. (1965). A generalized Wilcoxon test for comparing\narbitrarily singly-censored samples. Biometrika,\n52(1-2), 203–224. https://doi.org/10.1093/biomet/52.1-2.203\n\n\nGhosh, D., & Lin, D. Y. (2000). Nonparametric Analysis of Recurrent\nEvents and Death. Biometrics, 56(2), 554–562. https://doi.org/10.1111/j.0006-341x.2000.00554.x\n\n\nGray, R. J. (1988). A class of K-sample tests for comparing the\ncumulative incidence of a competing risk. The Annals of\nStatistics, 16(3). https://doi.org/10.1214/aos/1176350951\n\n\nICH. (1998). Statistical principles for clinical trials.\nLondon: European Medicines Evaluation Agency.\n\n\nICH. (2020). ICH E9 (R1) addendum on estimands and sensitivity\nanalysis in clinical trials to the guideline on statistical principles\nfor clinical trials, step 5. London: European Medicines Evaluation\nAgency.\n\n\nIonan, A. C., Paterniti, M., Mehrotra, D. V., Scott, J., Ratitch, B.,\nCollins, S., Gomatam, S., Nie, L., Rufibach, K., & Bretz, F. (2022).\nClinical and Statistical Perspectives on the ICH E9(R1) Estimand\nFramework Implementation. Statistics in Biopharmaceutical\nResearch, 15(3), 554–559. https://doi.org/10.1080/19466315.2022.2081601\n\n\nLi, H., Chen, W.-C., Lu, N., Tang, R., & Zhao, Y. (2024). The\nelusiveness of the win ratio parameter in the presence of missing data.\nTherapeutic Innovation & Regulatory Science, 1–2.\n\n\nLin, D. Y., Wei, L. J., & Ying, Z. (1993). Checking the Cox model\nwith cumulative sums of martingale-based residuals. Biometrika,\n80(3), 557–572. https://doi.org/10.1093/biomet/80.3.557\n\n\nLu, Y., & Tian, L. (2021). Statistical Considerations for Sequential\nAnalysis of the Restricted Mean Survival Time for Randomized Clinical\nTrials. Statistics in Biopharmaceutical Research,\n13(2), 210–218. https://doi.org/10.1080/19466315.2020.1816491\n\n\nLuo, X., Huang, B., & Quan, H. (2019). Design and monitoring of\nsurvival trials based on restricted mean survival times. Clinical\nTrials, 16(6), 616–625. https://doi.org/10.1177/1740774519871447\n\n\nLuo, X., Qiu, J., Bai, S., & Tian, H. (2017). Weighted win loss\napproach for analyzing prioritized outcomes. Statistics in\nMedicine, 36(15), 2452–2465. https://doi.org/10.1002/sim.7284\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative\nApproach to Confidence Interval Estimation for the Win Ratio Statistic.\nBiometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2018). On causal estimation using U-statistics. Biometrika,\n105(1), 215–220. https://doi.org/10.1093/biomet/asx071\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio.\nBiometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L. (2023a). Nonparametric Inference of General While-Alive\nEstimands for Recurrent Events. Biometrics, 79(3),\n1749–1760. https://doi.org/10.1111/biom.13709\n\n\nMao, L. (2023b). On restricted mean time in favor of treatment.\nBiometrics, 79(1), 61–72. https://doi.org/10.1111/biom.13570\n\n\nMao, L. (2023c). Power and Sample Size Calculations for the Restricted\nMean Time Analysis of Prioritized Composite Endpoints. Statistics in\nBiopharmaceutical Research, 15(3), 540–548. https://doi.org/10.1080/19466315.2022.2110936\n\n\nMao, L. (2023d). Study Design for Restricted Mean Time Analysis of\nRecurrent Events and Death. Biometrics, 79(4),\n3701–3714. https://doi.org/10.1111/biom.13923\n\n\nMao, L. (2024). Defining estimand for the win ratio: separate the true\neffect from censoring. Clinical Trials, In press.\n\n\nMao, L., & Kim, K. (2021). Statistical Models for Composite\nEndpoints of Death and Nonfatal Events: A Review. Statistics in\nBiopharmaceutical Research, 13(3), 260–269. https://doi.org/10.1080/19466315.2021.1927824\n\n\nMao, L., Kim, K., & Li, Y. (2022). On recurrent-event win ratio.\nStatistical Methods in Medical Research, 31(6),\n1120–1134. https://doi.org/10.1177/09622802221084134\n\n\nMao, L., Kim, K., & Miao, X. (2022). Sample size formula for general\nwin ratio analysis. Biometrics, 78(3), 1257–1268. https://doi.org/10.1111/biom.13501\n\n\nMao, L., & Lin, D. Y. (2016). Semiparametric regression for the\nweighted composite endpoint of recurrent and terminal events.\nBiostatistics, 17(2), 390–403. https://doi.org/10.1093/biostatistics/kxv050\n\n\nMao, L., & Wang, T. (2021). A class of proportional\nwin-fractions regression models for composite outcomes.\nBiometrics, 77(4), 1265–1275. https://doi.org/10.1111/biom.13382\n\n\nMao, L., & Wang, T. (2024). Dissecting the restricted mean time in\nfavor of treatment. Journal of Biopharmaceutical Statistics,\n34(1), 111–126. https://doi.org/10.1080/10543406.2023.2210658\n\n\nMoertel, C. G., Fleming, T. R., Macdonald, J. S., Haller, D. G., Laurie,\nJ. A., Goodman, P. J., Ungerleider, J. S., Emerson, W. A., Tormey, D.\nC., Glick, J. H., Veeder, M. H., & Mailliard, J. A. (1990).\nLevamisole and Fluorouracil for Adjuvant Therapy of Resected Colon\nCarcinoma. New England Journal of Medicine, 322(6),\n352–358. https://doi.org/10.1056/nejm199002083220602\n\n\nMurphy, S. A., Rossini, A. J., & Vaart, A. W. van der. (1997).\nMaximum Likelihood Estimation in the Proportional Odds Model.\nJournal of the American Statistical Association,\n92(439), 968–976. https://doi.org/10.1080/01621459.1997.10474051\n\n\nO’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L.\nS., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W.,\nBlumenthal, J. A., Rendall, D. S., Miller, N. H., Fleg, J. L., Schulman,\nK. A., McKelvie, R. S., Zannad, F., Piña, I. L., & HF-ACTION\nInvestigators, for the. (2009). Efficacy and Safety of Exercise Training\nin Patients With Chronic Heart Failure. JAMA, 301(14),\n1439. https://doi.org/10.1001/jama.2009.454\n\n\nOakes, D. (1989). Bivariate Survival Models Induced by Frailties.\nJournal of the American Statistical Association,\n84(406), 487–493. https://doi.org/10.1080/01621459.1989.10478795\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with\nmultiple types of event. Biometrika, 103(3), 742–745.\nhttps://doi.org/10.1093/biomet/asw026\n\n\nPéron, J., Buyse, M., Ozenne, B., Roche, L., & Roy, P. (2016). An\nextension of generalized pairwise comparisons for prioritized outcomes\nin the presence of censoring. Statistical Methods in Medical\nResearch, 27(4), 1230–1239. https://doi.org/10.1177/0962280216658320\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The\nwin ratio: a new approach to the analysis of composite endpoints in\nclinical trials based on clinical priorities. European Heart\nJournal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nQu, Y., & Lipkovich, I. (2021). Implementation of ICH E9 (R1): A Few\nPoints Learned During the COVID-19 Pandemic. Therapeutic Innovation\n& Regulatory Science, 55(5), 984–988. https://doi.org/10.1007/s43441-021-00297-6\n\n\nRatitch, B., Bell, J., Mallinckrodt, C., Bartlett, J. W., Goel, N.,\nMolenberghs, G., O’Kelly, M., Singh, P., & Lipkovich, I. (2020).\nChoosing Estimands in Clinical Trials: Putting the ICH E9(R1) Into\nPractice. Therapeutic Innovation & Regulatory Science,\n54(2), 324–341. https://doi.org/10.1007/s43441-019-00061-x\n\n\nRedfors, B., Gregson, J., Crowley, A., McAndrew, T., Ben-Yehuda, O.,\nStone, G. W., & Pocock, S. J. (2020). The win ratio approach for\ncomposite endpoints: practical guidance based on previous experience.\nEuropean Heart Journal, 41(46), 4391–4399. https://doi.org/10.1093/eurheartj/ehaa665\n\n\nRoyston, P., & Parmar, M. K. B. (2011). The use of restricted mean\nsurvival time to estimate the treatment effect in randomized clinical\ntrials when the proportional hazards assumption is in doubt.\nStatistics in Medicine, 30(19), 2409–2421. https://doi.org/10.1002/sim.4274\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023a). Estimands for\nRecurrent Event Endpoints in the Presence of a Terminal Event.\nStatistics in Biopharmaceutical Research, 15(2),\n238–248. https://doi.org/10.1080/19466315.2021.1895883\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023b). Rejoinder to\nCommentaries on “Estimands for Recurrent Event Endpoints in\nthe Presence of a Terminal Event”. Statistics in\nBiopharmaceutical Research, 15(2), 255–256. https://doi.org/10.1080/19466315.2023.2166098\n\n\nSeifu, Y., Mt-Isa, S., Duke, K., Gamalo-Siebers, M., Wang, W., Dong, G.,\n& Kolassa, J. (2022). Design of paediatric trials with benefit-risk\nendpoints using a composite score of adverse events of interest (AEI)\nand win-statistics. Journal of Biopharmaceutical Statistics,\n33(6), 696–707. https://doi.org/10.1080/10543406.2022.2153202\n\n\nSong, J., Verbeeck, J., Huang, B., Hoaglin, D. C., Gamalo-Siebers, M.,\nSeifu, Y., Wang, D., Cooner, F., & Dong, G. (2022). The win odds:\nstatistical inference and regression. Journal of Biopharmaceutical\nStatistics, 33(2), 140–150. https://doi.org/10.1080/10543406.2022.2089156\n\n\nTian, L., Jin, H., Uno, H., Lu, Y., Huang, B., Anderson, K. M., &\nWei, L. (2020). On the empirical choice of the time window for\nrestricted mean survival time. Biometrics, 76(4),\n1157–1166. https://doi.org/10.1111/biom.13237\n\n\nTroendle, J. F., Leifer, E. S., Yang, S., Jeffries, N., Kim, D.-Y., Joo,\nJ., & O’Connor, C. M. (2024). Use of win time for ordered composite\nendpoints in clinical trials. Statistics in Medicine,\n43(10), 1920–1932. https://doi.org/10.1002/sim.10045\n\n\nTsiatis, A. A., Davidian, M., Zhang, M., & Lu, X. (2008). Covariate\nadjustment for two-sample treatment comparisons in\nrandomized clinical trials: A principled yet flexible approach.\nStatistics in Medicine, 27(23), 4658–4677. https://doi.org/10.1002/sim.3113\n\n\nUno, H., & Horiguchi, M. (2023). Ratio and difference of average\nhazard with survival weight: New measures to quantify survival benefit\nof new therapy. Statistics in Medicine, 42(7),\n936–952. https://doi.org/10.1002/sim.9651\n\n\nVerbeeck, J., De Backer, M., Verwerft, J., Salvaggio, S., Valgimigli,\nM., Vranckx, P., Buyse, M., & Brunner, E. (2023). Generalized\nPairwise Comparisons to Assess Treatment Effects. Journal of the\nAmerican College of Cardiology, 82(13), 1360–1372. https://doi.org/10.1016/j.jacc.2023.06.047\n\n\nWang, B., Susukida, R., Mojtabai, R., Amin-Esmaeili, M., &\nRosenblum, M. (2021). Model-Robust Inference for Clinical Trials that\nImprove Precision by Stratified Randomization and Covariate Adjustment.\nJournal of the American Statistical Association,\n118(542), 1152–1163. https://doi.org/10.1080/01621459.2021.1981338\n\n\nWang, B., Zhou, D., Zhang, J., Kim, Y., Chen, L.-W., Dunnmon, P., Bai,\nS., Liu, Q., & Ishida, E. (2023). Statistical power considerations\nin the use of win ratio in cardiovascular outcome trials.\nContemporary Clinical Trials, 124, 107040. https://doi.org/10.1016/j.cct.2022.107040\n\n\nWang, T., Li, Y., & Qu, Y. (2024). Restricted time win ratio: from\nestimands to estimation. Statistics in Biopharmaceutical\nResearch, 1–18. https://doi.org/10.1080/19466315.2024.2332675\n\n\nWang, T., & Mao, L. (2022). Stratified proportional\nwin-fractions regression analysis. Statistics in\nMedicine, 41(26), 5305–5318. https://doi.org/10.1002/sim.9570\n\n\nWang, T., Zilinskas, R., Li, Y., & Qu, Y. (2023). Missing Data\nImputation for a Multivariate Outcome of Mixed Variable Types.\nStatistics in Biopharmaceutical Research, 15(4),\n826–837. https://doi.org/10.1080/19466315.2023.2169753\n\n\nWei, J., Mütze, T., Jahn-Eimermacher, A., & Roger, J. (2023).\nProperties of Two While-Alive Estimands for Recurrent Events and Their\nPotential Estimators. Statistics in Biopharmaceutical Research,\n15(2), 257–267. https://doi.org/10.1080/19466315.2021.1994457\n\n\nWu, P., Han, Y., Chen, T., & Tu, X. M. (2013). Causal inference for\nMann-Whitney-Wilcoxon rank sum and other nonparametric statistics.\nStatistics in Medicine, 33(8), 1261–1271. https://doi.org/10.1002/sim.6026\n\n\nYang, S., & Troendle, J. (2020). Event-specific win ratios and\ntesting with terminal and non-terminal events. Clinical Trials,\n18(2), 180–187. https://doi.org/10.1177/1740774520972408\n\n\nYang, S., Troendle, J., Pak, D., & Leifer, E. (2022).\nEvent-specific win ratios for inference with terminal and\nnon-terminal events. Statistics in Medicine,\n41(7), 1225–1241. https://doi.org/10.1002/sim.9266\n\n\nYe, T., Shao, J., Yi, Y., & Zhao, Q. (2023). Toward Better Practice\nof Covariate Adjustment in Analyzing Randomized Clinical Trials.\nJournal of the American Statistical Association,\n118(544), 2370–2382. https://doi.org/10.1080/01621459.2022.2049278\n\n\nYu, R. X., & Ganju, J. (2022). Sample size formula for a win ratio\nendpoint. Statistics in Medicine, 41(6), 950–963. https://doi.org/10.1002/sim.9297\n\n\nZhou, T. J., LaValley, M. P., Nelson, K. P., Cabral, H. J., &\nMassaro, J. M. (2022). Calculating power for the Finkelstein and\nSchoenfeld test statistic for a composite endpoint with two components.\nStatistics in Medicine, 41(17), 3321–3335. https://doi.org/10.1002/sim.9419\n\n\nZinman, B., Wanner, C., Lachin, J. M., Fitchett, D., Bluhmki, E.,\nHantel, S., Mattheus, M., Devins, T., Johansen, O. E., Woerle, H. J.,\nBroedl, U. C., & Inzucchi, S. E. (2015). Empagliflozin,\nCardiovascular Outcomes, and Mortality in Type 2 Diabetes. New\nEngland Journal of Medicine, 373(22), 2117–2128. https://doi.org/10.1056/nejmoa1504720"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#chapter-summary",
    "href": "intro.html#chapter-summary",
    "title": "1  Introduction",
    "section": "1.1 Chapter Summary",
    "text": "1.1 Chapter Summary\n\n1.1.1 Motivating Examples\nIn trials where patients may experience both fatal and nonfatal events, time-to-first-event analyses can obscure clinically meaningful treatment effects. For instance, in a colon cancer trial of 619 patients, relapse-free survival was used as the primary endpoint. Although the treatment significantly delayed relapse (log-rank \\(p &lt; 0.001\\)), 89% of deaths occurred after relapse and were ignored in the analysis.\nSimilarly, in the HF-ACTION trial of heart failure patients, a composite of death and hospitalization failed to show a statistically significant benefit (log-rank \\(p = 0.10\\)), even though 88% of patients died and 69% had recurrent hospitalizations. By equating hospitalization with death and counting only the first event, the analysis diluted the observed mortality effect.\nThese examples highlight the limitations of standard composite endpoints and motivate approaches that account for the clinical hierarchy and full event history.\n\n\n1.1.2 Composite Endpoints and Guidelines\nComposite endpoints increase statistical power by aggregating different event types, reducing the need for multiple testing and improving trial efficiency. However, their validity hinges on appropriate construction and interpretation.\nRegulatory guidelines provide direction:\n\nICH E9 recommends using a single primary variable or a composite when individual outcomes cannot capture the treatment effect.\nFDA allows time-to-first or total-event analysis but emphasizes component-wise interpretation.\nEuropean HTA bodies advise combining outcomes of similar severity and always including mortality when relevant, especially if it censors other outcomes.\n\nThese guidelines support the use of composite endpoints while cautioning against misinterpretation.\n\n\n1.1.3 Traditional Composite Methods\nLet \\(\\mathcal{H}^*(t)\\) denote the cumulative history of death and \\(K\\) nonfatal events up to time \\(t\\).\n\n1.1.3.1 Time to First Event\nThe standard approach defines: \\[\nN^*_{\\text{TFE}}(t) = I\\left\\{ N_D^*(t) + \\sum_{k=1}^K N_k^*(t) \\geq 1 \\right\\},\n\\] where \\(N_D^*(t)\\) and \\(N_k^*(t)\\) are counting processes for death and nonfatal event \\(k\\), respectively. This method reduces all outcome complexity to a single event time, analyzed via Kaplan–Meier, log-rank, or Cox models.\n\n\n1.1.3.2 Weighted Total Events\nTo incorporate more information, the total number of events can be weighted: \\[\nN^*_{\\text{R}}(t) = w_D N_D^*(t) + \\sum_{k=1}^K w_k N_k^*(t),\n\\] with \\(w_D, w_k\\) representing clinical importance. Estimation is performed under a proportional means model: \\[\nE\\{ N^*_{\\text{R}}(t) \\mid Z \\} = \\exp(\\beta^\\mathrm{T} Z) \\mu_0(t).\n\\]\nThe Wcompo R package provides tools for this approach via the CompoML() function.\n\n\n\n1.1.4 HF-ACTION Revisited\nIn the HF-ACTION trial, separate analyses illustrate the limitations of standard methods:\n\nCox model for death showed a 32.8% risk reduction (HR = 0.672, \\(p = 0.062\\)).\nCox model for TFE (death or first hospitalization) showed only a 16.2% reduction (HR = 0.838, \\(p = 0.111\\)).\nWeighted total events (death weighted twice) estimated a 14.3% reduction in event burden, but the \\(p\\)-value was still nonsignificant.\n\nThese results demonstrate how frequent nonfatal events can mask treatment benefits on mortality, particularly in analyses that do not prioritize outcome severity or account for survival time.\n\n\n1.1.5 Win Ratio and Hierarchical Approaches\nThe win ratio (WR) offers a solution by comparing patient pairs across treatment arms. Each pair is evaluated hierarchically:\n\nLonger survival indicates a win.\nIf both survive, fewer or later nonfatal events confer a win.\nIf tied, functional outcomes may be compared.\n\nThe win ratio is defined as: \\[\n\\widehat{\\text{WR}} = \\frac{\\text{\\# of treatment wins}}{\\text{\\# of control wins}}.\n\\]\nAlternative metrics include:\n\nNet benefit (PIF): wins minus losses.\nWin odds (WO): accounts for ties: \\[\n\\text{WO} = \\frac{\\text{wins} + \\frac{1}{2} \\text{ties}}{\\text{losses} + \\frac{1}{2} \\text{ties}}.\n\\]\n\nThese measures align with clinical priorities and are increasingly used in practice.\n\n\n1.1.6 Estimand Challenges\nA critical limitation of the win ratio is its dependency on censoring. Because patients may be censored at different times, the win/loss status of a pair can change over time. The observed win ratio thus reflects an average over the censoring distribution, not a fixed population quantity.\nThis raises concerns for interpretation and estimation:\n\nTesting remains valid under the null hypothesis, especially if the treatment consistently outperforms control.\nEstimation, however, is biased unless a fixed follow-up time is defined or a model constrains the win ratio to be constant over time.\n\nThe ICH E9 (R1) addendum emphasizes that a clearly defined estimand is essential for interpreting treatment effects. For the win ratio, this requires careful attention to follow-up duration and censoring.\n\n\n1.1.7 Toward Model-Based Estimands\nLimitations of traditional and empirical approaches motivate model-based alternatives: - The restricted mean time in favor (RMT-IF) quantifies the net amount of time one group remains in a more favorable state. - The proportional win-fractions (PW) model expresses the win ratio as a function of covariates, enabling estimation of treatment effects under a semiparametric framework.\nBoth methods respect clinical hierarchies and avoid dependence on arbitrary censoring patterns. They form the foundation of the methods introduced in subsequent chapters.\n\n\n\n1.1.8 Example R code\n\n########################################\n# 1. Proportional means model using Wcompo\n########################################\nlibrary(Wcompo)\nobj &lt;- CompoML(id, time, status, Z, w = c(2, 1))\nsummary(obj)\nplot(obj)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#motivating-examples",
    "href": "intro.html#motivating-examples",
    "title": "1  Introduction",
    "section": "1.1 Motivating Examples",
    "text": "1.1 Motivating Examples\nIn trials where patients may experience both fatal and nonfatal events, time-to-first-event analyses can obscure clinically meaningful treatment effects. For instance, in a colon cancer trial of 619 patients, relapse-free survival was used as the primary endpoint. Although the treatment significantly delayed relapse (log-rank \\(p &lt; 0.001\\)), 89% of deaths occurred after relapse and were ignored in the analysis.\n\n\n\n\n\nSimilarly, in the HF-ACTION trial of heart failure patients, a composite of death and hospitalization failed to show a statistically significant benefit (log-rank \\(p = 0.10\\)), even though 88% of patients died and 69% had recurrent hospitalizations. By equating hospitalization with death and counting only the first event, the analysis diluted the observed mortality effect.\n\n\n\n\n\nThese examples highlight the limitations of standard composite endpoints and motivate approaches that account for the clinical hierarchy and full event history.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#composite-endpoints-and-guidelines",
    "href": "intro.html#composite-endpoints-and-guidelines",
    "title": "1  Introduction",
    "section": "1.2 Composite Endpoints and Guidelines",
    "text": "1.2 Composite Endpoints and Guidelines\nComposite endpoints increase statistical power by aggregating different event types, reducing the need for multiple testing and improving trial efficiency. However, their validity hinges on appropriate construction and interpretation.\nRegulatory guidelines provide direction:\n\nICH E9 recommends using a single primary variable or a composite when individual outcomes cannot capture the treatment effect.\nFDA allows time-to-first or total-event analysis but emphasizes component-wise interpretation.\nEuropean HTA bodies advise combining outcomes of similar severity and always including mortality when relevant, especially if it censors other outcomes.\n\nThese guidelines support the use of composite endpoints while cautioning against misinterpretation.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#traditional-composite-methods",
    "href": "intro.html#traditional-composite-methods",
    "title": "1  Introduction",
    "section": "1.3 Traditional Composite Methods",
    "text": "1.3 Traditional Composite Methods\nLet \\(\\mathcal{H}^*(t)\\) denote the cumulative history of death and \\(K\\) nonfatal events up to time \\(t\\).\n\n1.3.1 Time to First Event\nThe standard approach defines: \\[\nN^*_{\\text{TFE}}(t) = I\\left\\{ N_D^*(t) + \\sum_{k=1}^K N_k^*(t) \\geq 1 \\right\\},\n\\] where \\(N_D^*(t)\\) and \\(N_k^*(t)\\) are counting processes for death and nonfatal event \\(k\\), respectively. This method reduces all outcome complexity to a single event time, analyzed via Kaplan–Meier, log-rank, or Cox models.\n\n\n1.3.2 Weighted Total Events\nTo incorporate more information, the total number of events can be weighted: \\[\nN^*_{\\text{R}}(t) = w_D N_D^*(t) + \\sum_{k=1}^K w_k N_k^*(t),\n\\] with \\(w_D, w_k\\) representing clinical importance. Estimation is performed under a proportional means model: \\[\nE\\{ N^*_{\\text{R}}(t) \\mid Z \\} = \\exp(\\beta^\\mathrm{T} Z) \\mu_0(t).\n\\]\nThe Wcompo R package provides tools for this approach via the CompoML() function.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#hf-action-revisited",
    "href": "intro.html#hf-action-revisited",
    "title": "1  Introduction",
    "section": "1.4 HF-ACTION Revisited",
    "text": "1.4 HF-ACTION Revisited\nIn the HF-ACTION trial, separate analyses illustrate the limitations of standard methods:\n\nCox model for death showed a 32.8% risk reduction (HR = 0.672, p = 0.062).\nCox model for TFE (death or first hospitalization) showed only a 16.2% reduction (HR = 0.838, p = 0.111).\nWeighted total events (death weighted twice) estimated a 14.3% reduction in event burden, but the p-value was still nonsignificant.\n\nThese results demonstrate how frequent nonfatal events can mask treatment benefits on mortality, particularly in analyses that do not prioritize outcome severity or account for survival time.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#win-ratio-and-hierarchical-approaches",
    "href": "intro.html#win-ratio-and-hierarchical-approaches",
    "title": "1  Introduction",
    "section": "1.5 Win Ratio and Hierarchical Approaches",
    "text": "1.5 Win Ratio and Hierarchical Approaches\nThe win ratio (WR) offers a solution by comparing patient pairs across treatment arms. Each pair is evaluated hierarchically:\n\nLonger survival indicates a win.\nIf both survive, fewer or later nonfatal events confer a win.\nIf tied, functional outcomes may be compared.\n\nThe win ratio is defined as: \\[\n\\widehat{\\text{WR}} = \\frac{\\text{\\# of treatment wins}}{\\text{\\# of control wins}}.\n\\]\nAlternative metrics include:\n\nNet benefit (PIF): wins minus losses.\nWin odds (WO): accounts for ties: \\[\n\\text{WO} = \\frac{\\text{wins} + 2^{-1} \\text{ties}}{\\text{losses} + 2^{-1} \\text{ties}}.\n\\]\n\nThese measures align with clinical priorities and are increasingly used in practice.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#estimand-challenges",
    "href": "intro.html#estimand-challenges",
    "title": "1  Introduction",
    "section": "1.6 Estimand Challenges",
    "text": "1.6 Estimand Challenges\nA critical limitation of the win ratio is its dependency on censoring. Because patients may be censored at different times, the win/loss status of a pair can change over time. The observed win ratio thus reflects an average over the censoring distribution, not a fixed population quantity.\n\n\n\n\n\nThis raises concerns for interpretation and estimation:\n\nTesting remains valid under the null hypothesis, especially if the treatment consistently outperforms control.\nEstimation, however, is biased unless a fixed follow-up time is defined or a model constrains the win ratio to be constant over time.\n\nThe ICH E9 (R1) addendum emphasizes that a clearly defined estimand is essential for interpreting treatment effects. For the win ratio, this requires careful attention to follow-up duration and censoring.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#toward-model-based-estimands",
    "href": "intro.html#toward-model-based-estimands",
    "title": "1  Introduction",
    "section": "1.7 Toward Model-Based Estimands",
    "text": "1.7 Toward Model-Based Estimands\nLimitations of traditional and empirical approaches motivate model-based alternatives:\n\nThe restricted mean time in favor (RMT-IF) quantifies the net amount of time one group remains in a more favorable state.\nThe proportional win-fractions (PW) model expresses the win ratio as a function of covariates, enabling estimation of treatment effects under a semiparametric framework.\n\nBoth methods respect clinical hierarchies and avoid dependence on arbitrary censoring patterns. They form the foundation of the methods introduced in subsequent chapters.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#example-r-code",
    "href": "intro.html#example-r-code",
    "title": "1  Introduction",
    "section": "1.8 Example R code",
    "text": "1.8 Example R code\nThe following example assumes a data frame df in long format, with columns:\n\nid: subject identifier\n\ntime: event or censoring time\n\nstatus: event type (0 = censoring, 1 = death, 2 = nonfatal)\n\ntrt: treatment group (0 = control, 1 = treatment)\n\n\n########################################\n# 1. Prepare data for survival analyses\n########################################\nlibrary(dplyr)\n# For time-to-death analysis: remove nonfatal events\ndf_death &lt;- df |&gt; \n  filter(status != 2)\n# For time-to-first-event (TFE): take earliest record per subject\ndf_tfe &lt;- df |&gt;\n  arrange(id, time) |&gt;\n  group_by(id) |&gt;\n  slice_head() |&gt;\n  ungroup()\n\n########################################\n# 2. Cox models for death and TFE\n########################################\nlibrary(survival)\n# Time to death\ncox_death &lt;- coxph(Surv(time, status == 1) ~ trt, data = df_death)\n# Time to first event (death or nonfatal)\ncox_tfe &lt;- coxph(Surv(time, status &gt; 0) ~ trt, data = df_tfe)\n\n########################################\n# 3. Weighted total events analysis\n########################################\nlibrary(Wcompo)\n# Weighting: death:nonfatal = 2:1\nfit_wte &lt;- CompoML(id, time, status, Z = trt, data = df, w = c(2, 1))",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chap1.html#outline",
    "href": "chap1.html#outline",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Outline",
    "text": "Outline\n\nExamples and regulatory guidelines\nTraditional methods\n\nTime to first event\nWeighted total events (Wcompo package)\n\nWin ratio and hierarchical endpoints\n\nThe estimand issue\n\n\n\\[\\newcommand{\\d}{{\\rm d}}\\] \\[\\newcommand{\\T}{{\\rm T}}\\] \\[\\newcommand{\\dd}{{\\rm d}}\\] \\[\\newcommand{\\cc}{{\\rm c}}\\] \\[\\newcommand{\\pr}{{\\rm pr}}\\] \\[\\newcommand{\\var}{{\\rm var}}\\] \\[\\newcommand{\\se}{{\\rm se}}\\] \\[\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\\] \\[\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\\] \\[\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\] \\[\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\] \\[ \\def\\a{{(a)}} \\def\\b{{(1-a)}} \\def\\t{{(1)}} \\def\\c{{(0)}} \\def\\d{{\\rm d}} \\def\\T{{\\rm T}}\n\\]"
  },
  {
    "objectID": "chap1.html#motivating-example-colon-cancer",
    "href": "chap1.html#motivating-example-colon-cancer",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Motivating Example: Colon Cancer",
    "text": "Motivating Example: Colon Cancer\n\n\nLandmark colon cancer trial\n\nPopulation: 619 patients with stage C disease (Moertel et al., 1990)\nArms: Levamisole + fluorouracil (\\(n=304\\)) vs control (\\(n=315\\))\nEndpoint: relapse-free survival (log-rank test p&lt;0.001)\n\nDeath = Relapse\n258 deaths (89%) after relapse ignored"
  },
  {
    "objectID": "chap1.html#motivating-example-hf-action",
    "href": "chap1.html#motivating-example-hf-action",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Motivating Example: HF-ACTION",
    "text": "Motivating Example: HF-ACTION\n\n\nA cardiovascular trial (HF-ACTION)\n\nSubpopulation: 426 heart failure patients (O’Connor et al., 2009)\nArms: Exercise training + usual care (\\(n=205\\)) vs usual care (\\(n=221\\))\nEndpoint: hospitalization-free survival (log-rank test p=0.100)\n\nDeath = Hospitalization\n82 (88%) deaths + 707 (69%) recurrent hospitalizations ignored"
  },
  {
    "objectID": "chap1.html#composite-endpoints",
    "href": "chap1.html#composite-endpoints",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Composite Endpoints",
    "text": "Composite Endpoints\n\n\nTraditional composite endpoint (TCE)\n\nTime to first event\n\nRelapse/Progression-free survival\nFirst major adverse cardiac event (MACE): death, heart failure, myocardio-infarction, stroke (event-free survival)\n\nLimitations\n\nLack of clinical priority\nStatistical inefficiency (waste of data)\n\n\n\n\n\n\nHierarchical composite endpoint (HCE)\n\nExample: Death &gt; nonfatal MACE &gt; six-minute walk test (6MWT)/NYHA class"
  },
  {
    "objectID": "chap1.html#why-composite",
    "href": "chap1.html#why-composite",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Why Composite",
    "text": "Why Composite\n\n\nAdvantages\n\nMore events \\(\\to\\) higher power \\(\\to\\) smaller sample size/lower costs\nNo need for multiplicity adjustment\nA unified measure of treatment effect\n\n\n\n\n\n\n\nICH-E9 “Statistical Principles for Clinical Trials” (ICH, 1998)\n\n\n\n“There should generally be only one primary variable”\n“If a single primary variable cannot be selected …, another useful strategy is to integrate or combine the multiple measurements into a single or composite variable …”\n“[composite endpoint] addresses the multiplicity problem without adjustment to the type I error”"
  },
  {
    "objectID": "chap1.html#regulatory-guidelines-fda",
    "href": "chap1.html#regulatory-guidelines-fda",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Regulatory Guidelines: FDA",
    "text": "Regulatory Guidelines: FDA\n\n\nMain points\n\nTypically first event but can do total events\nComponent-wise analysis important for interpretation\n\n\n\n\n\n\n\nFDA Guidance for Industry: “Multiple Endpoints in Clinical Trials” (FDA, 2022)\n\n\n\n“Composite endpoints are often assessed as the time to first occurrence of any one of the components, …, it also may be possible to analyze total endpoint events”\n“The treatment effect on the composite rate can be interpreted as characterizing the overall clinical effect when the individual events all have reasonably similar clinical importance”\n“…analyses of the components of the composite endpoint are important and can influence interpretation of the overall study results”"
  },
  {
    "objectID": "chap1.html#regulatory-guidelines-europe",
    "href": "chap1.html#regulatory-guidelines-europe",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Regulatory Guidelines: Europe",
    "text": "Regulatory Guidelines: Europe\n\n\nMain points\n\nCombine events of similar importance\nInclude mortality as a component\n\n\n\n\n\n\n\nEuropean Network for Health Technology Assessment “Endpoints used for Relative Effectiveness Assessment – Composite Endpoints” (EUnetHTA, 2015)\n\n\n\n“All components of a composite endpoint should be separately defined as secondary endpoints and reported with the results of the primary analysis”\n“Components of similar clinical importance and sensitivity to intervention should preferably be combined”\n“If adequate, mortality should however be included if it is likely to have a censoring effect on the observation of other components”"
  },
  {
    "objectID": "chap1.html#a-tricky-example",
    "href": "chap1.html#a-tricky-example",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A Tricky Example",
    "text": "A Tricky Example\n\n\nThe EMPA-REG Trial (NCT01131676)\n\nPopulation: 7,020 patients with type 2 diabetes (Zinman et al., 2015)\nTreatment arms: Empagliflozin vs control\nEndpoint: Time to first CV death, nonfatal MI, nonfatal stroke"
  },
  {
    "objectID": "chap1.html#data-and-notation",
    "href": "chap1.html#data-and-notation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Data and Notation",
    "text": "Data and Notation\n\n\nFull data \\(\\mathcal H^*(\\infty)\\)\n\n\\(D\\): survival time; \\(N^*_D(t)=I(D\\leq t)\\)\n\\(N^*_1(t), \\ldots, N^*_K(t)\\): counting processes for \\(K\\) nonfatal event types\nCumulative data: \\(\\mathcal H^*(t)=\\{N^*_D(u), N^*_1(u), \\ldots, N^*_K(u):0\\leq u\\leq t\\}\\)\n\n\n\n\n\nObserved (censored) data \\(\\{\\mathcal H^*(X), X\\}\\)\n\n\\(\\mathcal H^*(X)\\): outcomes up to time \\(X\\)\n\\(X=D\\wedge C\\): length of follow-up (\\(a\\wedge b = \\min(a, b)\\))\n\\(C\\): independent censoring time\nGoal: estimate/test features of \\(\\mathcal H^*(\\infty)\\) using \\(\\{\\mathcal H^*(X), X\\}\\)"
  },
  {
    "objectID": "chap1.html#first-event",
    "href": "chap1.html#first-event",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "First Event",
    "text": "First Event\n\n\nUnivariate endpoint\n\n\\(N^*_{\\rm TFE}(t) = I\\{N^*_D(t)+\\sum_{k=1}^KN^*_k(t)\\geq 1\\}\\)\n\n\\(I(\\cdot)\\): 0-1 indicator\n\n\\(\\tilde T\\): time to first event\n\nKaplan–Meier curve, log-rank test, Cox model\n\n\n\n\n\n\nComponent-wise weighting\n\nUpweight death over nonfatal events\n\nE.g., Death = 2 \\(\\times\\) hospitalization"
  },
  {
    "objectID": "chap1.html#total-events",
    "href": "chap1.html#total-events",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Total Events",
    "text": "Total Events\n\n\nWeighted composite event process\n\n\\(N^*_{\\rm R}(t)=w_DN^*_D(t)+\\sum_{k=1}^Kw_kN^*_k(t)\\)\n\n\\(w_D, w_1, \\ldots, w_K\\): weights to death and nonfatal events \n\nProportional means model (Mao & Lin, 2016) \\[\nE\\{N^*_{\\rm R}(t)\\mid Z\\} = \\exp(\\beta^\\T Z)\\mu_0(t)\n\\]\n\n\\(\\exp(\\beta)\\): mean ratio of weighted total events comparing treatment \\((Z=1)\\) vs control \\((Z=0)\\)\n\nR-package: Wcompo"
  },
  {
    "objectID": "chap1.html#software-wcompocompoml",
    "href": "chap1.html#software-wcompocompoml",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: Wcompo::CompoML()",
    "text": "Software: Wcompo::CompoML()\n\n\nBasic syntax\n\nid: unique patient identifier; time: event times; status: event types (1: death; 2,...,K nonfatal event types; Z: covariate matrix)\nw: \\(K\\)-vector of weights to event types 1,...K; default is unweighted\n\n\n\n\nlibrary(Wcompo)\nobj &lt;- CompoML(id, time, status, Z, w = c(2, 1))\n\n\n\n\n\nOutput: a list of class CompoML\n\nobj$beta: \\(\\hat\\beta\\); obj$var: \\(\\hat\\var(\\hat\\beta)\\)\nplot(obj, z): plot mean function \\(\\exp(\\hat\\beta^{\\rm T} z)\\hat\\mu_0(t)\\)"
  },
  {
    "objectID": "chap1.html#hf-action-an-example",
    "href": "chap1.html#hf-action-an-example",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: An Example",
    "text": "HF-ACTION: An Example\n\n\nHigh-risk subgroup (n=426)\n\nBaseline cardiopulmonary exercise (CPX) test \\(\\leq\\) 9 min\n\n\n\n\n\n\n\n\nTable 1: Summary statistics for a high-risk subgroup (n=426) in HF-ACTION trial.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUsual care (N = 221)\nExercise training (N = 205)\n\n\n\n\nAge\n≤ 60 years\n122 (55.2%)\n128 (62.4%)\n\n\n\n&gt; 60 years\n99 (44.8%)\n77 (37.6%)\n\n\nFollow-up\n(months)\n28.6 (18.4, 39.3)\n27.6 (19, 40.2)\n\n\nDeath\n\n57 (25.8%)\n36 (17.6%)\n\n\nHospitalizations\n0\n51 (23.1%)\n60 (29.3%)\n\n\n\n1-3\n114 (51.6%)\n102 (49.8%)\n\n\n\n4-10\n49 (22.2%)\n39 (19%)\n\n\n\n&gt;10\n7 (3.2%)\n4 (2%)"
  },
  {
    "objectID": "chap1.html#hf-action-preparation",
    "href": "chap1.html#hf-action-preparation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Preparation",
    "text": "HF-ACTION: Preparation\n\n\nLoad packages and data\n\n\nlibrary(survival) # for standard survival analysis\nlibrary(Wcompo) # for weighted total events\nlibrary(rmt) # for hfaction data\nlibrary(tidyverse) # for data wrangling\n\n# Load data\ndata(hfaction)\nhead(hfaction) # trt_ab=1: training; 0: usual care\n#&gt;        patid       time status trt_ab age60\n#&gt; 1 HFACT00001 0.60506502      1      0     1\n#&gt; 2 HFACT00001 1.04859685      0      0     1\n#&gt; 3 HFACT00002 0.06297057      1      0     1\n#&gt; 4 HFACT00002 0.35865845      1      0     1\n#&gt; 5 HFACT00002 0.39698836      1      0     1\n#&gt; 6 HFACT00002 3.83299110      0      0     1"
  },
  {
    "objectID": "chap1.html#hf-action-data",
    "href": "chap1.html#hf-action-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Data",
    "text": "HF-ACTION: Data\n\n\nData processing\n\n\n# For weighted total analysis by compoML()\n# Convert status=1 for death, 2=hospitalization\nhfaction &lt;- hfaction |&gt; \n  mutate(\n    status = case_when(\n      status == 1 ~ 2,\n      status == 2 ~ 1,\n      status == 0 ~ 0)\n  )\n\n# TFE: take the first event per patient id\nhfaction_TFE &lt;- hfaction |&gt; \n  arrange(patid, time) |&gt; # sort by patid and time\n  group_by(patid) |&gt; \n  slice_head() |&gt; # take first row\n  ungroup()"
  },
  {
    "objectID": "chap1.html#hf-action-mortality",
    "href": "chap1.html#hf-action-mortality",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Mortality",
    "text": "HF-ACTION: Mortality\n\n\nCox model for death\n\nHR: \\(\\exp(-0.3973) = 67.2\\%\\) (\\(32.8\\%\\) reduction in risk)\n\\(P\\)-value: 0.0621 (borderline significant)\n\n\n\n## Get mortality data\nhfaction_D &lt;- hfaction |&gt; \n  filter(status != 2) # remove hospitalization records\n\n## Cox model for death against trt_ab\nobj_D &lt;- coxph(Surv(time, status) ~ trt_ab, data = hfaction_D)\nsummary(obj_D)\n#&gt; n= 426, number of events= 93 \n#&gt;           coef exp(coef) se(coef)      z      p\n#&gt; trt_ab -0.3973    0.6721   0.2129 -1.866 0.0621"
  },
  {
    "objectID": "chap1.html#hf-action-tfe",
    "href": "chap1.html#hf-action-tfe",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: TFE",
    "text": "HF-ACTION: TFE\n\n\nCox model for hospitalization-free survival\n\nHR: \\(\\exp(-0.1770) = 83.8\\%\\) (\\(16.2\\%\\) reduction in risk)\n\\(P\\)-value: 0.111 (less significant than death)\n\n\n\n# Cox model for TFE against trt_ab\nobj_TFE &lt;- coxph(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE)\nsummary(obj_TFE)\n#&gt;   n= 426, number of events= 326 \n#&gt;           coef exp(coef) se(coef)      z Pr(&gt;|z|)\n#&gt; trt_ab -0.1770    0.8378   0.1112 -1.592    0.111"
  },
  {
    "objectID": "chap1.html#hf-action-death-vs-tfe",
    "href": "chap1.html#hf-action-death-vs-tfe",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Death vs TFE",
    "text": "HF-ACTION: Death vs TFE\n\n\nHospitalizations dilute effect on death …\n\nAn EMPA-REG-like situation"
  },
  {
    "objectID": "chap1.html#hf-action-weighted-total",
    "href": "chap1.html#hf-action-weighted-total",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Weighted Total",
    "text": "HF-ACTION: Weighted Total\n\n\nProportional means model (death = \\(2\\times\\) hosp)\n\nMR: \\(\\exp(-0.15398) = 85.7\\%\\) (\\(14.3\\%\\) reduction in total number of composite events)\n\\(P\\)-value: 0.170 (less significant than TFE)\nLimitation: Survival \\(\\uparrow\\) \\(\\to\\) cumulative total \\(\\uparrow\\) \\(\\to\\) attenuated effect\n\n\n# Total events (proportional mean) -------------------------------\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, hfaction$status, \n                  hfaction$trt_ab, w = c(2, 1))\nobj_ML\n#&gt;         Event 1 (Death) Event 2\n#&gt; Weight               2       1\n#&gt;         Estimate      se z.value p.value\n#&gt; trt_ab -0.15398  0.11215 -1.3729  0.1698"
  },
  {
    "objectID": "chap1.html#hf-action-cumulative-means",
    "href": "chap1.html#hf-action-cumulative-means",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Cumulative Means",
    "text": "HF-ACTION: Cumulative Means\n\n\nModel-based mean functions\n\n\nplot(obj_ML, 0, ylim= c(0, 5), xlab=\"Time (years)\", col= \"red\", lwd = 2)\nplot(obj_ML, 1, add = TRUE, col = \"blue\", lwd = 2)\nlegend(0, 5, col=c(\"red\",\"blue\"), c(\"Usual care\", \"Training\"), lwd = 2)"
  },
  {
    "objectID": "chap1.html#lessons-learned",
    "href": "chap1.html#lessons-learned",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Lessons Learned",
    "text": "Lessons Learned\n\n\nAdding nonfatal events \\(\\neq\\) higher power\n\nComponent may be less discriminating (Freemantle et al., 2003)\nLength of exposure (death as competing risk) (Schmidli et al., 2023)\n\n\n\n\n\nSolutions\n\nHierarchically prioritize death\n\nEvaluate nonfatal components only on survivors\n\nQuantitative weighting \\(\\to\\) adjust for survival time\n\nLoss rate = cumulative total / length of exposure (Ch 3)"
  },
  {
    "objectID": "chap1.html#win-ratio-basics",
    "href": "chap1.html#win-ratio-basics",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win Ratio: Basics",
    "text": "Win Ratio: Basics\n\n\nA common approach to HCE\n\nProposed and popularized by Pocock et al. (2012)\nTreatment vs control: generalized pairwise comparisons\nWin-loss: sequential comparison on components\n\nLonger survival &gt; fewer/later nonfatal MACE &gt; better 6MWT/NYHA score\n\nEffect size: WR \\(=\\) wins / losses\n\n\n\n\n\nAlternative metrics\n\nProportion in favor (net benefit): PIF \\(=\\) wins \\(-\\) losses (Buyse, 2010)\nWin odds: WO \\(=\\) (wins \\(+\\) \\(2^{-1}\\)ties) / (losses \\(+\\) \\(2^{-1}\\)ties) (Brunner et al., 2021; Dong et al., 2020)"
  },
  {
    "objectID": "chap1.html#win-ratio-gaining-popularity",
    "href": "chap1.html#win-ratio-gaining-popularity",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win Ratio: Gaining Popularity",
    "text": "Win Ratio: Gaining Popularity\n\n\nMore trials are using it…"
  },
  {
    "objectID": "chap1.html#an-important-caveat",
    "href": "chap1.html#an-important-caveat",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "An Important Caveat",
    "text": "An Important Caveat\n\n\nWR’s estimand depends on censoring …\n\nLuo et al. (2015), Bebu & Lachin (2016), Oakes (2016), Mao (2019), Dong et al. (2020a), Li et al. (2024), etc.\n\n\n\n\n\nWhat is an estimand?\n\nPopulation-level quantity to be estimated\n\nPopulation-mean difference, (true) risk ratio, etc.\n\nSpecifies how treatment effect is measured\nICH E9 (R1) addendum: estimand construction one of the “central questions for drug development and licensing” (ICH, 2020)"
  },
  {
    "objectID": "chap1.html#win-loss-changes-with-time",
    "href": "chap1.html#win-loss-changes-with-time",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win-Loss Changes with Time",
    "text": "Win-Loss Changes with Time\n\n\nIllustration\n\nWin-loss status, and deciding component, changes with time \nLonger follow-up …\n\nParameters: win/loss proportions \\(\\uparrow\\) (WR uncertain); tie proportion \\(\\downarrow\\)\nComponent contributions: prioritized \\(\\uparrow\\); deprioritized \\(\\downarrow\\)"
  },
  {
    "objectID": "chap1.html#trial-dependent-estimand",
    "href": "chap1.html#trial-dependent-estimand",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Trial-Dependent Estimand",
    "text": "Trial-Dependent Estimand\n\n\nActual estimand\n\nAverage WR mixing shorter-term with longer-term comparisons\nWeight set (haphazardly) by censoring distribution\n\nStaggered entry, random withdrawal \\(\\to\\) non-scientific\n\n\n\n\n\n\nTesting vs estimation\n\nTesting (qualitative): okay\n\nValid under \\(H_0\\), powerful if treatment consistently outperforms control over time\n\nEstimation (quantitative): not okay\n\nPre-define restriction time \\(\\to\\) use censoring weight for unbiased estimation (Ch 3)\nSpecify a time-constant WR model (Ch 4)"
  },
  {
    "objectID": "chap1.html#notes",
    "href": "chap1.html#notes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Notes",
    "text": "Notes\n\nMore on\n\nRegulatory guidelines for composite endpoints (Mao & Kim, 2021)\nICH E9 (R1) implementation (Akacha et al., 2017; Ionan et al., 2022; Qu & Lipkovich, 2021; Ratitch et al., 2020)\nPractical guidance (Pocock et al., 2024; Redfors et al., 2020)\nDefining estimand for win ratio (Mao, 2024)\nGeneralized pairwise comparisons (Deltuvaite-Thomas et al., 2022; Dong et al., 2022; Péron et al., 2016; Verbeeck et al., 2023)\n\nCumulative total events\n\nBased on cumulative incidence/frequency under competing risks (Fine & Gray, 1999; Ghosh & Lin, 2000; Gray, 1988)"
  },
  {
    "objectID": "chap1.html#summary",
    "href": "chap1.html#summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Summary",
    "text": "Summary\n\nComposite endpoints\n\nDeath + hospitalization/progression/relapse\nRegulatory recommendation\n\nTraditional\n\nTime to first: death = nonfatal (survival::coxph())\nWeighted total: death = \\(w_D\\times\\) nonfatal (Wcompo::compoML())\n\nHierarchical\n\nWin ratio, net benifit, win odds: death &gt; nonfatal\nEstimand issue - ICH E9 (R1)"
  },
  {
    "objectID": "chap1.html#references",
    "href": "chap1.html#references",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "References",
    "text": "References\n\n\n\n\nAkacha, M., Bretz, F., Ohlssen, D., Rosenkranz, G., & Schmidli, H. (2017). Estimands and Their Role in Clinical Trials. Statistics in Biopharmaceutical Research, 9(3), 268–271. https://doi.org/10.1080/19466315.2017.1302358\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win ratio analysis of a composite outcome based on prioritized components. Biostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBrunner, E., Vandemeulebroecke, M., & Mütze, T. (2021). Win odds: An adaptation of the win ratio to include ties. Statistics in Medicine, 40(14), 3367–3384. https://doi.org/10.1002/sim.8967\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized outcomes in the two-sample problem. Statistics in Medicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nDeltuvaite-Thomas, V., Verbeeck, J., Burzykowski, T., Buyse, M., Tournigand, C., Molenberghs, G., & Thas, O. (2022). Generalized pairwise comparisons for censored data: An overview. Biometrical Journal, 65(2). https://doi.org/10.1002/bimj.202100354\n\n\nDong, G., Hoaglin, D. C., Qiu, J., Matsouaka, R. A., Chang, Y.-W., Wang, J., & Vandemeulebroecke, M. (2020). The Win Ratio: On Interpretation and Handling of Ties. Statistics in Biopharmaceutical Research, 12(1), 99–106. https://doi.org/10.1080/19466315.2019.1575279\n\n\nDong, G., Huang, B., Chang, Y.-W., Seifu, Y., Song, J., & Hoaglin, D. C. (2020a). The win ratio: Impact of censoring and follow-up time and use with nonproportional hazards. Pharmaceutical Statistics, 19(3), 168–177. https://doi.org/10.1002/pst.1977\n\n\nDong, G., Huang, B., Verbeeck, J., Cui, Y., Song, J., Gamalo-Siebers, M., Wang, D., Hoaglin, D. C., Seifu, Y., Mütze, T., & Kolassa, J. (2022). Win statistics (win ratio, win odds, and net benefit) can complement one another to show the strength of the treatment effect on time-to-event outcomes. Pharmaceutical Statistics, 22(1), 20–33. https://doi.org/10.1002/pst.2251\n\n\nEUnetHTA. (2015). Guidance for industry: Multiple endpoints in clinical trials. https://www.eunethta.eu/wp-content/uploads/2018/01/Endpoints-used-for-Relative-Effectiveness-Assessment-Composite-endpoints_Amended-JA1-Guideline_Final-Nov-2015_0.pdf\n\n\nFDA. (2022). Guidance for industry: Multiple endpoints in clinical trials. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/multiple-endpoints-clinical-trials-guidance-industry\n\n\nFine, J. P., & Gray, R. J. (1999). A Proportional Hazards Model for the Subdistribution of a Competing Risk. Journal of the American Statistical Association, 94(446), 496–509. https://doi.org/10.1080/01621459.1999.10474144\n\n\nFreemantle, N., Calvert, M., Wood, J., Eastaugh, J., & Griffin, C. (2003). Composite Outcomes in Randomized Trials. JAMA, 289(19), 2554. https://doi.org/10.1001/jama.289.19.2554\n\n\nGhosh, D., & Lin, D. Y. (2000). Nonparametric Analysis of Recurrent Events and Death. Biometrics, 56(2), 554–562. https://doi.org/10.1111/j.0006-341x.2000.00554.x\n\n\nGray, R. J. (1988). A class of \\(K\\)-sample tests for comparing the cumulative incidence of a competing risk. The Annals of Statistics, 16(3). https://doi.org/10.1214/aos/1176350951\n\n\nICH. (1998). Statistical principles for clinical trials. London: European Medicines Evaluation Agency.\n\n\nICH. (2020). ICH E9 (R1) addendum on estimands and sensitivity analysis in clinical trials to the guideline on statistical principles for clinical trials, step 5. London: European Medicines Evaluation Agency.\n\n\nIonan, A. C., Paterniti, M., Mehrotra, D. V., Scott, J., Ratitch, B., Collins, S., Gomatam, S., Nie, L., Rufibach, K., & Bretz, F. (2022). Clinical and Statistical Perspectives on the ICH E9(R1) Estimand Framework Implementation. Statistics in Biopharmaceutical Research, 15(3), 554–559. https://doi.org/10.1080/19466315.2022.2081601\n\n\nLi, H., Chen, W.-C., Lu, N., Tang, R., & Zhao, Y. (2024). The elusiveness of the win ratio parameter in the presence of missing data. Therapeutic Innovation & Regulatory Science, 1–2.\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative Approach to Confidence Interval Estimation for the Win Ratio Statistic. Biometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio. Biometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L. (2024). Defining estimand for the win ratio: Separate the true effect from censoring. Clinical Trials, 21(5), 584–594.\n\n\nMao, L., & Kim, K. (2021). Statistical Models for Composite Endpoints of Death and Nonfatal Events: A Review. Statistics in Biopharmaceutical Research, 13(3), 260–269. https://doi.org/10.1080/19466315.2021.1927824\n\n\nMao, L., & Lin, D. Y. (2016). Semiparametric regression for the weighted composite endpoint of recurrent and terminal events. Biostatistics, 17(2), 390–403. https://doi.org/10.1093/biostatistics/kxv050\n\n\nMoertel, C. G., Fleming, T. R., Macdonald, J. S., Haller, D. G., Laurie, J. A., Goodman, P. J., Ungerleider, J. S., Emerson, W. A., Tormey, D. C., Glick, J. H., Veeder, M. H., & Mailliard, J. A. (1990). Levamisole and Fluorouracil for Adjuvant Therapy of Resected Colon Carcinoma. New England Journal of Medicine, 322(6), 352–358. https://doi.org/10.1056/nejm199002083220602\n\n\nO’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. A., Rendall, D. S., Miller, N. H., Fleg, J. L., Schulman, K. A., McKelvie, R. S., Zannad, F., Piña, I. L., & HF-ACTION Investigators, for the. (2009). Efficacy and Safety of Exercise Training in Patients With Chronic Heart Failure. JAMA, 301(14), 1439. https://doi.org/10.1001/jama.2009.454\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with multiple types of event. Biometrika, 103(3), 742–745. https://doi.org/10.1093/biomet/asw026\n\n\nPéron, J., Buyse, M., Ozenne, B., Roche, L., & Roy, P. (2016). An extension of generalized pairwise comparisons for prioritized outcomes in the presence of censoring. Statistical Methods in Medical Research, 27(4), 1230–1239. https://doi.org/10.1177/0962280216658320\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The win ratio: a new approach to the analysis of composite endpoints in clinical trials based on clinical priorities. European Heart Journal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nPocock, S. J., Gregson, J., Collier, T. J., Ferreira, J. P., & Stone, G. W. (2024). The win ratio in cardiology trials: Lessons learnt, new developments, and wise future use. European Heart Journal, 45(44), 4684–4699.\n\n\nQu, Y., & Lipkovich, I. (2021). Implementation of ICH E9 (R1): A Few Points Learned During the COVID-19 Pandemic. Therapeutic Innovation & Regulatory Science, 55(5), 984–988. https://doi.org/10.1007/s43441-021-00297-6\n\n\nRatitch, B., Bell, J., Mallinckrodt, C., Bartlett, J. W., Goel, N., Molenberghs, G., O’Kelly, M., Singh, P., & Lipkovich, I. (2020). Choosing Estimands in Clinical Trials: Putting the ICH E9(R1) Into Practice. Therapeutic Innovation & Regulatory Science, 54(2), 324–341. https://doi.org/10.1007/s43441-019-00061-x\n\n\nRedfors, B., Gregson, J., Crowley, A., McAndrew, T., Ben-Yehuda, O., Stone, G. W., & Pocock, S. J. (2020). The win ratio approach for composite endpoints: practical guidance based on previous experience. European Heart Journal, 41(46), 4391–4399. https://doi.org/10.1093/eurheartj/ehaa665\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023). Rejoinder to Commentaries on “Estimands for Recurrent Event Endpoints in the Presence of a Terminal Event”. Statistics in Biopharmaceutical Research, 15(2), 255–256. https://doi.org/10.1080/19466315.2023.2166098\n\n\nVerbeeck, J., De Backer, M., Verwerft, J., Salvaggio, S., Valgimigli, M., Vranckx, P., Buyse, M., & Brunner, E. (2023). Generalized Pairwise Comparisons to Assess Treatment Effects. Journal of the American College of Cardiology, 82(13), 1360–1372. https://doi.org/10.1016/j.jacc.2023.06.047\n\n\nZinman, B., Wanner, C., Lachin, J. M., Fitchett, D., Bluhmki, E., Hantel, S., Mattheus, M., Devins, T., Johansen, O. E., Woerle, H. J., Broedl, U. C., & Inzucchi, S. E. (2015). Empagliflozin, Cardiovascular Outcomes, and Mortality in Type 2 Diabetes. New England Journal of Medicine, 373(22), 2117–2128. https://doi.org/10.1056/nejmoa1504720"
  },
  {
    "objectID": "intro.html#conclusion",
    "href": "intro.html#conclusion",
    "title": "1  Introduction",
    "section": "1.9 Conclusion",
    "text": "1.9 Conclusion\nStandard methods for analyzing composite endpoints—such as time to first event or weighted event counts—often oversimplify patient trajectories and obscure clinically important effects. Hierarchical approaches like the win ratio offer a more principled alternative but require careful attention to the estimand, especially in the presence of censoring. Modern methods such as RMT-IF and the proportional win-fractions model provide robust and interpretable tools for analyzing composite outcomes in a way that respects both clinical priority and statistical rigor.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "testing.html",
    "href": "testing.html",
    "title": "2  Hypothesis Testing",
    "section": "",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "chap2.html#outline",
    "href": "chap2.html#outline",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Outline",
    "text": "Outline\n\nWin ratio basics and properties\nGeneralize to recurrent events\n\nHF-ACTION example (WR package)\n\nSample size calculations\n\nHF-ACTION example (WR package) \\[\\newcommand{\\d}{{\\rm d}}\\] \\[\\newcommand{\\T}{{\\rm T}}\\] \\[\\newcommand{\\dd}{{\\rm d}}\\] \\[\\newcommand{\\cc}{{\\rm c}}\\] \\[\\newcommand{\\pr}{{\\rm pr}}\\] \\[\\newcommand{\\var}{{\\rm var}}\\] \\[\\newcommand{\\se}{{\\rm se}}\\] \\[\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\\] \\[\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\\] \\[\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\] \\[\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\] \\[ \\def\\a{{(a)}} \\def\\b{{(1-a)}} \\def\\t{{(1)}} \\def\\c{{(0)}} \\def\\d{{\\rm d}} \\def\\T{{\\rm T}} \\def\\bs{\\boldsymbol}\n\\]"
  },
  {
    "objectID": "chap2.html#standard-two-sample",
    "href": "chap2.html#standard-two-sample",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Standard Two-Sample",
    "text": "Standard Two-Sample\n\n\nTwo-sample comparison (Pocock et al., 2012)\n\nData: \\(D_i^{(a)}, T_i^{(a)}, C_i^{(a)}\\): survival, hospitalization, censoring times on \\(i\\)th subject in group \\(a\\) \\((i=1,\\ldots, N_a; a= 1, 0)\\)\nPairwise comparisons: \\(i\\)th in group \\(a\\) vs \\(j\\)th in group \\(1-a\\)\n\nHierarchical composite: Death &gt; hospitalization in \\(\\left[0, C_i^{(a)}\\wedge C_j^{(1-a)}\\right]\\) \\[\\begin{align}\n\\hat w^{(a, 1-a)}_{ij}&= \\underbrace{I(D_j^{(1-a)}&lt; D_i^{(a)}\\wedge C_i^{(a)}\\wedge C_j^{(1-a)})}_{\\mbox{win on survival}}\\\\\n& + \\underbrace{I(\\min(D_i^{(a)}, D_j^{(1-a)}) &gt; C_i^{(a)}\\wedge C_j^{(1-a)}, T_j^{(1-a)}&lt; T_i^{(a)}\\wedge C_i^{(1)}\\wedge C_j^{(0)})}_{\\mbox{tie on survival, win on hospitalization}}\n\\end{align}\\]"
  },
  {
    "objectID": "chap2.html#pococks-rule",
    "href": "chap2.html#pococks-rule",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Pocock’s Rule",
    "text": "Pocock’s Rule\n\n\nWin, lose, or tie?"
  },
  {
    "objectID": "chap2.html#calculation-of-win-ratio",
    "href": "chap2.html#calculation-of-win-ratio",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Calculation of Win Ratio",
    "text": "Calculation of Win Ratio\n\n\nTwo-sample statistics\n\nWin (loss) fraction for group \\(a\\) (\\(1-a\\)) \\[\n\\hat w^{(a, 1-a)}=(N_0N_1)^{-1}\\sum_{i=1}^{N_a}\\sum_{j=1}^{N_{1-a}}\\hat w^{(a, 1-a)}_{ij}\\]\nWin ratio statistic \\[\nWR = \\hat w^{(1, 0)} / \\hat w^{(0, 1)}\n\\]\nOther measures\n\nNet benefit (proportion in favor): \\(\\hat w^{(1, 0)} - \\hat w^{(0, 1)}\\) (Buyse, 2010)\nWin odds: \\((\\hat w^{(1, 0)} - \\hat w^{(0, 1)} + 1)/ (\\hat w^{(0, 1)} - \\hat w^{(1, 0)} + 1)\\) (Dong et al., 2020)"
  },
  {
    "objectID": "chap2.html#the-binary-case",
    "href": "chap2.html#the-binary-case",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "The Binary Case",
    "text": "The Binary Case\n\n\nConsider binary \\(Y^{(a)}= 1, 0\\)\n\n\\(\\hat w^{(a, 1-a)}_{ij} = I(Y_i^{(a)}&gt; Y_j^{(1-a)})=Y_i^{(a)}(1-Y_j^{(1-a)})\\)\nWin (loss) fraction \\[\n\\hat w^{(a, 1-a)} = (N_1N_0)^{-1}\\sum_{i=1}^{N_a}\\sum_{j=1}^{N_{1-a}}Y_i^{(a)}(1-Y_j^{(1-a)})\n= \\hat p^{(a)}(1-\\hat p^{(1-a)})\\]\n\n\\(\\hat p^{(a)}= N_a^{-1}\\sum_{i=1}^{N_a} Y_i^{(a)}\\) (success probability)\n\nEquivalencies \\[\\begin{align}\n{\\rm Win\\,\\, ratio}&= \\frac{\\hat w^{(1, 0)}}{\\hat w^{(0, 1)}} = \\frac{\\hat p^{(1)}(1-\\hat p^{(0)})}{\\hat p^{(0)}(1-\\hat p^{(1)})} = {\\rm Odds \\,\\, ratio}\\\\\n{\\rm Net \\,\\, benefit}&=\\hat w^{(1, 0)} - \\hat w^{(0, 1)} = \\hat p^{(1)}- \\hat p^{(0)}= {\\rm Risk \\,\\, difference}\n\\end{align}\\]"
  },
  {
    "objectID": "chap2.html#hypothesis-testing",
    "href": "chap2.html#hypothesis-testing",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Hypothesis Testing",
    "text": "Hypothesis Testing\n\n\nTest statistic\n\nLog-transformed and normalized \\[\nS_n = \\frac{n^{1/2}\\log(\\hat w_{1,0}/\\hat w_{0,1})}{\\hat{\\rm SE}} \\stackrel{H_0}{\\sim} N (0, 1)\n\\]\n\n\\(\\hat{\\rm SE}\\): standard error of numerator by \\(U\\)-statistic method (Bebu & Lachin, 2016; Dong et al., 2016; Luo et al., 2015); \\(n = N_1 + N_0\\)\n\nNull hypothesis \\[\nH_0: H^\\t(s, t) = H^\\c(s, t)\\mbox{ for all } t\\leq s\n\\]\n\n\\(H^\\a(s, t)=\\pr(D^\\a &gt; s, T^\\a &gt; t)\\)"
  },
  {
    "objectID": "chap2.html#alternative-hypothesis",
    "href": "chap2.html#alternative-hypothesis",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Alternative Hypothesis",
    "text": "Alternative Hypothesis\n\n\nWhat is estimand of WR?\n\nCensoring-weighted average of time-dependent WRs (Oakes, 2016) \\[\n\\frac{\\hat w_{1,0}}{\\hat w_{0,1}}\\to\n\\frac{\\int_0^\\infty\\pr(\\mbox{Treatment wins by } t)\\dd G(t)}\n{\\int_0^\\infty\\pr(\\mbox{Control wins by } t)\\dd G(t)} =\\text{Non-centrality parameter}\n\\]\n\n\\(G(t)\\): Distribution function of \\(C^\\t\\wedge C^\\c\\) \n\nTreatment wins consistently against control over time (Mao, 2019) \\[\nH_A: \\pr(\\mbox{Treatment wins by } t)\\geq \\pr(\\mbox{Control wins by } t)\n\\mbox{ for all } t\n\\]\nSufficient condition: joint stochastic order of death and nonfatal event \\[\nH_A: H^\\t(s, t) \\geq  H^\\c(s, t)\\mbox{ for all } t\\leq s\n\\]"
  },
  {
    "objectID": "chap2.html#variations",
    "href": "chap2.html#variations",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Variations",
    "text": "Variations\n\n\nWeighting\n\nUnweighted pairwise comparisons \\(\\to\\) Gehan (1965) test\nWeight win/loss by time of follow-up \\(\\to\\) log-rank (more efficient) (Luo et al., 2017)\n\n\n\n\n\nStratification\n\nStratified WR: within-stratum comparisons (Dong et al., 2017, 2023; Gasparyan et al., 2020)\n\nSum of stratum-specific wins / sum of stratum-specific losses\n\nAdjust for confounding; increase efficiency"
  },
  {
    "objectID": "chap2.html#general-data",
    "href": "chap2.html#general-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "General Data",
    "text": "General Data\n\n\nFull outcomes\n\nA subject in group \\(a\\) \\((a=1, 0)\\) \\[\\mathcal H^{*{(a)}}(t)=\\left\\{N^{*{(a)}}_D(u), N^{*{(a)}}_1(u), \\ldots, N^{*{(a)}}_K(u):0\\leq u\\leq t\\right\\}\\]\n\\(N^{*{(a)}}_D(u), N^{*{(a)}}_1(u), \\ldots, N^{*{(a)}}_K(u)\\): counting processes for death and \\(K\\) different types of nonfatal events\n\n\n\n\n\nObserved data\n\n\\(\\mathcal H^{*{(a)}}(X^{(a)})\\): life history up to \\(X^{(a)}= D^{(a)}\\wedge C^{(a)}\\)"
  },
  {
    "objectID": "chap2.html#general-rule-of-comparison",
    "href": "chap2.html#general-rule-of-comparison",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "General Rule of Comparison",
    "text": "General Rule of Comparison\n\n\nWin function\n\nTime frame of comparison: \\([0, t]\\) \\[\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t) =I\\left\\{\\mathcal H^{*{(a)}}(t) \\mbox{ is more favorable than } \\mathcal H^{*{(1-a)}}(t)\\right\\}\\]\nBasic requirements\n\n(W1) \\(\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)\\) is a function only of \\(\\mathcal H^{*{(a)}}(t)\\) and \\(\\mathcal H^{*{(1-a)}}(t)\\)\n(W2) \\(\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)+\\mathcal W(\\mathcal H^{*{(1-a)}}, \\mathcal H^{*{(a)}})(t) \\in \\{0, 1\\}\\)\n(W3) \\(\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)=\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(D^{(a)}\\wedge D^{(1-a)}\\wedge t)\\)\n\nInterpretations\n\n(W1) Consistency of time frame\n(W2) Either win, loss, or tie\n(W3) No change of win-loss status after death (satisfied if death is prioritized)"
  },
  {
    "objectID": "chap2.html#generalized-win-ratio",
    "href": "chap2.html#generalized-win-ratio",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Generalized Win Ratio",
    "text": "Generalized Win Ratio\n\n\nUnder general win function \\(\\mathcal W(\\cdot,\\cdot)\\)\n\nWin ratio statistic \\[\\begin{equation}\\label{eq:wr:gen_WR}\n\\hat{\\mathcal E}_n(\\mathcal W)=\\frac{(N_1N_0)^{-1}\\sum_{i=1}^{N_1}\\sum_{j=1}^{N_0}\\mathcal W(\\mathcal H^{*{(1)}}_{i}, \\mathcal H^{*{(0)}}_{j})(X^{{(1)}}_{i}\\wedge X^{{(0)}}_{j})}\n{(N_1N_0)^{-1}\\sum_{i=1}^{N_1}\\sum_{j=1}^{N_0}\\mathcal W(\\mathcal H^{*{(0)}}_{j}, \\mathcal H^{*{(1)}}_{i})(X^{{(1)}}_{i}\\wedge X^{{(0)}}_{j})}\n\\end{equation}\\]\nStill each pair is compared over \\(\\left[0, X^{{(1)}}_{i}\\wedge X^{{(0)}}_{j}\\right]\\), but by a general rule \\(\\mathcal W\\)\nStratified win ratio: ratio between weighted sum of within-stratum win/loss fractions"
  },
  {
    "objectID": "chap2.html#examples",
    "href": "chap2.html#examples",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Examples",
    "text": "Examples\n\n\nPocock’s WR\n\n\\(T^{(a)}_1\\): time of first event in \\(N^{*{(a)}}(t)=\\sum_{k=1}^K N^{*{(a)}}_k(t)\\) \\[\\begin{align}\\label{eq:wr:PWR}\n\\mathcal W_{\\rm P}(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)&=I\\{D^{(1-a)}&lt;D^{(a)}\\wedge t\\}\\notag\\\\\n&\\hspace{2mm}+I\\{D^{(a)}\\wedge D^{(1-a)}&gt;t, T_{1}^{(1-a)}&lt;T_{1}^{(a)}\\wedge t\\}\n\\end{align}\\]\n\\(\\hat{\\mathcal E}_n(\\mathcal W_{\\rm P})\\)\n\n\n\n\n\nTFE WR\n\n\\(\\tilde T^{(a)}=\\min(D^{(a)}, T_1^{(a)})\\) \\[\n\\mathcal W_{\\rm TFE}(\\mathcal H^{*{(a)}},\\mathcal H^{*{(1-a)}})(t)=I(\\tilde T^{(1-a)}&lt;\\tilde T^{(a)}\\wedge t)\n\\]\n\\(\\hat{\\mathcal E}_n(\\mathcal W_{\\rm TFE})\\): allowable but not desirable"
  },
  {
    "objectID": "chap2.html#options-for-recurrent-events",
    "href": "chap2.html#options-for-recurrent-events",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Options for Recurrent Events",
    "text": "Options for Recurrent Events\n\n\nThree variations (Mao et al., 2022)\n\nNaive: Death &gt; number of events (Finkelstein & Schoenfeld, 1999)\nFirst-event: Death &gt; number of events &gt; time to first event\nLast-event: Death &gt; number of events &gt; time to last event\n\n\n\n\n\nProperties\n\nFirst/Last-event fewer ties than standard WR\nFirst/Last-event \\(\\to\\) Pocock’s WR with nonrecurrent event\n\n\n\n\n\n\nExercise\n\n\nWrite out the win function \\(\\mathcal W\\) for the three versions of recurrent-event WR."
  },
  {
    "objectID": "chap2.html#comparison-with-pococks",
    "href": "chap2.html#comparison-with-pococks",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Comparison with Pocock’s",
    "text": "Comparison with Pocock’s\n\n\nLast-event WR (LWR)\n\nvs Pocock’s WR (PWR)"
  },
  {
    "objectID": "chap2.html#alternative-hypothesis-for-lwr",
    "href": "chap2.html#alternative-hypothesis-for-lwr",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Alternative Hypothesis for LWR",
    "text": "Alternative Hypothesis for LWR\n\n\nLWR\n\nTests joint stochastic order of all events \\[\n  H_A: H^\\t(s, t_1, t_2, \\ldots) \\geq  H^\\c(s, t_1, t_2, \\ldots)\\mbox{ for all }\n  t_1\\leq t_2\\leq\\cdots\\leq s\n  \\]\n\n\\(H^\\t(s, t_1, t_2, \\ldots)=\\pr(D^\\a &gt; s, T_1^\\a &gt; t_1, T_2^\\a &gt; t_2, \\ldots)\\)\n\\(T_k^\\a\\): \\(k\\)th recurrent event in \\(N^{*{(a)}}(t)\\) \\((k=1, 2, \\ldots)\\)\n\nTreatment stochastically delays all events\nAll variations of WR implemented in WR package\n\nSimulations show LWR more powerful than rest (Mao et al., 2022)"
  },
  {
    "objectID": "chap2.html#software-wrwrrec",
    "href": "chap2.html#software-wrwrrec",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WR::WRrec()",
    "text": "Software: WR::WRrec()\n\n\nBasic syntax\n\nLong format ID: unique patient identifier; time: event times; status: event types (1: death; 2: recurrent events; 0: censoring); trt: binary treatment; strata: strata variable\nnaive = TRUE: calculates naive/FWR as well as LWR\n\n\n\n\nlibrary(WR)\nobj &lt;- WRrec(ID, time, status, trt, strata = NULL, naive = FALSE)\n\n\n\nOutput: a list of class WRrec\n\nobj$log.WR: log-LWR; obj$se: \\(\\hat\\se(\\mbox{log-LWR})\\)\nprint(obj) to print summary results"
  },
  {
    "objectID": "chap2.html#hf-action-data",
    "href": "chap2.html#hf-action-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Data",
    "text": "HF-ACTION: Data\n\n\nHigh-risk subset \\((n=426)\\)\n\nage60: indicator of age \\(\\geq\\) 60 yrs\n\n\n\nlibrary(WR)\n##### Read in HF-ACTION DATA########\n# same as rmt::hfaction used in chap 1 \n#  (except for status coding)\ndata(hfaction_cpx9)\nhfaction &lt;- hfaction_cpx9\nhead(hfaction)\n#&gt;        patid       time status trt_ab age60\n#&gt; 1 HFACT00001  7.2459016      2      0     1\n#&gt; 2 HFACT00001 12.5573770      0      0     1\n#&gt; 3 HFACT00002  0.7540984      2      0     1\n#&gt; 4 HFACT00002  4.2950820      2      0     1\n#&gt; 5 HFACT00002  4.7540984      2      0     1\n#&gt; 6 HFACT00002 45.9016393      0      0     1"
  },
  {
    "objectID": "chap2.html#hf-action-summary",
    "href": "chap2.html#hf-action-summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Summary",
    "text": "HF-ACTION: Summary\n\n\nDescriptive\n\n\n\n\n\nTable 1: Summary statistics for a high-risk subgroup (n=426) in HF-ACTION trial.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUsual care (N = 221)\nExercise training (N = 205)\n\n\n\n\nAge\n≤ 60 years\n122 (55.2%)\n128 (62.4%)\n\n\n\n&gt; 60 years\n99 (44.8%)\n77 (37.6%)\n\n\nFollow-up\n(months)\n28.6 (18.4, 39.3)\n27.6 (19, 40.2)\n\n\nDeath\n\n57 (25.8%)\n36 (17.6%)\n\n\nHospitalizations\n0\n51 (23.1%)\n60 (29.3%)\n\n\n\n1-3\n114 (51.6%)\n102 (49.8%)\n\n\n\n4-10\n49 (22.2%)\n39 (19%)\n\n\n\n&gt;10\n7 (3.2%)\n4 (2%)"
  },
  {
    "objectID": "chap2.html#hf-action-wr-analyses",
    "href": "chap2.html#hf-action-wr-analyses",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: WR Analyses",
    "text": "HF-ACTION: WR Analyses\n\n\nNaive (NWR), first-event (FWR), LWR\n\nStratified by age \\(&lt;\\) or \\(\\geq 60\\)\n\n\nobj &lt;- WRrec(ID = hfaction$patid, time = hfaction$time, \n             status = hfaction$status, trt = hfaction$trt_ab,\n             strata = hfaction$age60, naive = TRUE)\n\n\nobj\n#&gt;             N Rec. Event Death Med. Follow-up\n#&gt; Control   221        571    57       28.62295\n#&gt; Treatment 205        451    36       27.57377\n#&gt; \n#&gt; WR analyses:\n#&gt;     Win prob Loss prob WR (95% CI)*      p-value\n#&gt; LWR 50.4%    38.2%     1.32 (1.05, 1.66) 0.0189 \n#&gt; FWR 50.4%    38.3%     1.32 (1.04, 1.66) 0.0202 \n#&gt; NWR 47%      35%       1.34 (1.05, 1.72) 0.0193 \n#&gt; -----\n#&gt; *Note: The scale of WR depends on censoring distribution."
  },
  {
    "objectID": "chap2.html#hf-action-overall",
    "href": "chap2.html#hf-action-overall",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Overall",
    "text": "HF-ACTION: Overall\n\n\nRecurrent-event WRs more powerful than PWR\n\nNWR/FWR/LWR similar as \\(N\\) hosp is highly variable (0 - 26)"
  },
  {
    "objectID": "chap2.html#special-case-pwr",
    "href": "chap2.html#special-case-pwr",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Special Case: PWR",
    "text": "Special Case: PWR\n\n\nSimplified outcome model\n\nGumbel-Hougaard copula (Oakes, 1989) \\[\n\\pr(D^\\a&gt;s, T_1^\\a&gt;t) = \\exp\\left(-\\left[\\{\\exp(a\\xi_D)\\lambda_Ds\\}^\\kappa + \\{\\exp(a\\xi_H)\\lambda_Ht\\}^\\kappa \\right]^{1/\\kappa}\\right)\n\\]\n\n\\(\\lambda_D, \\lambda_H\\): baseline hazard rates for death/nonfatal event\n\\(\\exp(\\xi_D), \\exp(\\xi_H)\\): treatment HR on death/nonfatal event (effect sizes)\n\\(\\kappa\\geq 1\\): association parameter (Kendall’s rank correlation \\(1-\\kappa^{-1}\\))\n\n\n\n\n\n\nStudy design\n\nUniform patient accrual over \\([0, \\tau_b]\\); follow all until \\(\\tau&gt;\\tau_b\\)\nRandom loss-to-follow-up (LTFU) rate \\(\\lambda_L\\)"
  },
  {
    "objectID": "chap2.html#sample-size-formula",
    "href": "chap2.html#sample-size-formula",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Sample Size Formula",
    "text": "Sample Size Formula\n\n\nTotal sample size needed \\[\nn = \\frac{\\zeta_0^2(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)(z_{1-\\alpha/2} + z_\\gamma)^2}\n{q(1-q)\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)^\\T\\xi}\n\\]\n\n\\(\\alpha =0.05\\): type I error; \\(\\gamma = 0.8, 0.9\\): desired power (\\(z_\\gamma=\\Phi^{-1}(\\gamma)\\))\n\\(\\xi=(\\xi_D,\\xi_H)^\\T\\): component-wise log-HRs (effect sizes)\n\\(q=N_1/n\\): proportion assigned to treatment\nNuisance parameters\n\n\\(\\zeta_0(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)\\): individual-level noise parameter (cf. SD) in WR\n\\(\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)\\): differential vector for log-WR \\(\\to\\) log-HRs\nCalculable by WR::base(lambda_D,lambda_H,kappa,tau_c,tau,lambda_L)"
  },
  {
    "objectID": "chap2.html#parameter-specification",
    "href": "chap2.html#parameter-specification",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Parameter Specification",
    "text": "Parameter Specification\n\n\nBaseline outcome parameters \\((\\lambda_D,\\lambda_H,\\kappa)\\)\n\nEstimable from pilot/historical data\n\nWR::gumbel.est(id, time, status)\n\n\n\n\n\n\n\n\nExercise: Under Gumbel-Hougaard copula\n\n\n\n\\(D^\\c\\sim\\mbox{exponential}(\\lambda_D)\\)\n\\(\\tilde T^\\c = D^\\c\\wedge T_1^\\c\\sim\\mbox{exponential}\\left(\\lambda_{CE}\\right)\\), where \\(\\lambda_{CE} = (\\lambda_D^\\kappa +\n\\lambda_H^\\kappa)^{1/\\kappa}\\)\nCause-specific hazard for \\(T_1^\\c\\): \\(\\lambda_H^\\#=\\lambda_H^\\kappa\\lambda_{CE}^{1-\\kappa}\\)\nThree parameters \\(\\to\\) three estimable quantities\n\n\n\n\nDesign parameters \\((\\tau_c,\\tau,\\lambda_L)\\)\n\nSelf-specify"
  },
  {
    "objectID": "chap2.html#software-wrwrss",
    "href": "chap2.html#software-wrwrss",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WR::WRSS()",
    "text": "Software: WR::WRSS()\n\n\nBasic steps\n\nxi: log-HRs \\(\\xi=(\\xi_D, \\xi_H)^T\\) (e.g., \\(\\log (0.8, 0.9)^\\T\\))\n\n\n# Step 1: estimate (lambda_D, lambda_H, kappa) from pilot data\noutcome_base &lt;- gumbel.est(id, time, status)\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- obj_base$kappa\n\n\n# Step 2: calculate zeta2 and delta from\n# (lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\nbparam &lt;- base(lambda_D,lambda_H,kappa,tau_c,tau,lambda_L)\n## a list of zeta2 and delta \n\n\n# Step 3: calculate sample size using bparam\nobj &lt;- WRSS(xi, bparam, q = 0.5, alpha = 0.05, side = 2, power = 0.8)\nobj$n"
  },
  {
    "objectID": "chap2.html#a-new-training-trial",
    "href": "chap2.html#a-new-training-trial",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A New Training Trial",
    "text": "A New Training Trial\n\n\nBackground\n\nWR demonstrated beneficial effect of training on (death &gt; hosp) in HF patients with CPX \\(\\leq 9\\) min\n\n\n\n\n\nDesign of new trial\n\nPurpose: test a new training program with existing one as standard care\nDesign: \\(\\tau_b = 3\\) yrs patient accrual, follow until \\(\\tau = 4\\) yrs\n\nAssume minimal LTFU \\(\\lambda_L = 0.01\\) per person-year\n\nBaseline event rates/correlation: estimable from \\(n=205\\) patients in HF-ACTION training arm"
  },
  {
    "objectID": "chap2.html#hf-action-historical-data",
    "href": "chap2.html#hf-action-historical-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Historical Data",
    "text": "HF-ACTION: Historical Data\n\n\nExtract data from hfaction\n\n\n# get training arm data\npilot &lt;- hfaction |&gt; \n  filter(trt_ab == 1)\nhead(pilot)\n#&gt;     patid      time status trt_ab age60\n#&gt; HFACT00007  3.47541      2      1     1\n#&gt; HFACT00007 21.60656      2      1     1\n#&gt; HFACT00007 29.04918      2      1     1\n#&gt; HFACT00007 32.16393      2      1     1\n#&gt; HFACT00007 34.88525      1      1     1\n#&gt; HFACT00035 48.88525      0      1     1\n# number of subjects\npilot |&gt; distinct(patid) |&gt; \n  count()\n#&gt;   n\n#&gt; 205"
  },
  {
    "objectID": "chap2.html#hf-action-baseline-outcome",
    "href": "chap2.html#hf-action-baseline-outcome",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Baseline Outcome",
    "text": "HF-ACTION: Baseline Outcome\n\n\nParameter estimates\n\n\\(\\lambda_D=0.07\\) year\\(^{-1}\\), \\(\\lambda_H=0.56\\) year\\(^{-1}\\), Kendall’s corr \\(=36.1\\%\\)\n\n\n\n# Step 1: estimate (lambda_D, lambda_H, kappa) from HF-ACTION data\noutcome_base &lt;- gumbel.est(pilot$patid, pilot$time / 12, pilot$status)\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- outcome_base$kappa\nlambda_D\n#&gt; [1] 0.07307293\nlambda_H\n#&gt; 1] 0.5596186\nkappa\n#&gt; [1] 1.564485\n## Kendall's rank correlation\n1 - 1/kappa\n#&gt; [1] 0.360812"
  },
  {
    "objectID": "chap2.html#sample-size-example",
    "href": "chap2.html#sample-size-example",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Sample Size: Example",
    "text": "Sample Size: Example\n\n\nOne scenario\n\nHRs on death & hospitalization: 0.9, 0.8\nSample size needed for power 80%: \\(n=1241\\)\n\n\n\n# set design parameters\ntau_b &lt;- 3\ntau &lt;- 4\nlambda_L &lt;- 0.001\n# Step 2: use base() function to compute zeta2 and delta\nset.seed(1234) # Monte-Carlo integration in base()\nbparam &lt;- base(lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\n# Step 3: compute sample size under HRs 0.8 and 0.9\nobj &lt;- WRSS(xi = log(c(0.9, 0.8)), bparam = bparam, q =  0.5, alpha = 0.05,\n          power = 0.8)\nobj$n\n#&gt; [1] 1240.958"
  },
  {
    "objectID": "chap2.html#a-range-of-effect-sizes",
    "href": "chap2.html#a-range-of-effect-sizes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A Range of Effect Sizes",
    "text": "A Range of Effect Sizes\n\n\nDifferent HRs: \\(\\exp(\\xi)\\in [0.6, 0.95]^{\\otimes 2}\\)"
  },
  {
    "objectID": "chap2.html#notes",
    "href": "chap2.html#notes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Notes",
    "text": "Notes\n\nEvent-specific win ratio\n\nWin/loss on which component (Yang et al., 2022; Yang & Troendle, 2020)\n\nMore on sample size\n\nCalculatation based on win/loss proproportions (Yu & Ganju, 2022)\nSimplified/approximate approaches in various scenarios (Gasparyan et al., 2021; Seifu et al., 2022, etc.; Wang et al., 2023; Zhou et al., 2022)"
  },
  {
    "objectID": "chap2.html#summary",
    "href": "chap2.html#summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Summary",
    "text": "Summary\n\nWin ratio test\n\nStandard: death &gt; one nonfatal event\nRecurrent events: death &gt; frequency &gt; time to last/first event\n\nWR::WRrec(ID, time, status, trt, strata)\n\n\nSample size calculations\n\nGumbel-Hougaard copula for death & nonfatal event \\[\\pr(D^\\a&gt;s, T_1^\\a&gt;t) = \\exp\\left(-\\left[\\{\\exp(a\\xi_D)\\lambda_Ds\\}^\\kappa + \\{\\exp(a\\xi_H)\\lambda_Ht\\}^\\kappa \\right]^{1/\\kappa}\\right)\n\\]\n\nStep 1: estimate \\((\\lambda_D,\\lambda_H,\\kappa)\\) WR::gumbel.est(id, time, status)\nStep 2: calculate \\(\\zeta^2_0(\\lambda_D,\\lambda_H,\\kappa,\\tau_b,\\tau,\\lambda_L)\\) and \\(\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_b,\\tau,\\lambda_L)\\) WR::base()\nStep 3: \\(n=\\frac{\\zeta_0^2(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)(z_{1-\\alpha/2} + z_\\gamma)^2}{q(1-q)\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)^\\T\\xi}\\) WR::WRSS()"
  },
  {
    "objectID": "chap2.html#references",
    "href": "chap2.html#references",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "References",
    "text": "References\n\n\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win ratio analysis of a composite outcome based on prioritized components. Biostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized outcomes in the two-sample problem. Statistics in Medicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nDong, G., Hoaglin, D. C., Huang, B., Cui, Y., Wang, D., Cheng, Y., & Gamalo-Siebers, M. (2023). The stratified win statistics (win ratio, win odds, and net benefit). Pharmaceutical Statistics, 22(4), 748–756. https://doi.org/10.1002/pst.2293\n\n\nDong, G., Hoaglin, D. C., Qiu, J., Matsouaka, R. A., Chang, Y.-W., Wang, J., & Vandemeulebroecke, M. (2020). The Win Ratio: On Interpretation and Handling of Ties. Statistics in Biopharmaceutical Research, 12(1), 99–106. https://doi.org/10.1080/19466315.2019.1575279\n\n\nDong, G., Li, D., Ballerstedt, S., & Vandemeulebroecke, M. (2016). A generalized analytic solution to the win ratio to analyze a composite endpoint considering the clinical importance order among components. Pharmaceutical Statistics, 15(5), 430–437. https://doi.org/10.1002/pst.1763\n\n\nDong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2017). The stratified win ratio. Journal of Biopharmaceutical Statistics, 28(4), 778–796. https://doi.org/10.1080/10543406.2017.1397007\n\n\nFinkelstein, D. M., & Schoenfeld, D. A. (1999). Combining mortality and longitudinal measures in clinical trials. Statistics in Medicine, 18(11), 1341–1354. https://doi.org/10.1002/(sici)1097-0258(19990615)18:11&lt;1341::aid-sim129&gt;3.0.co;2-7\n\n\nGasparyan, S. B., Folkvaljon, F., Bengtsson, O., Buenconsejo, J., & Koch, G. G. (2020). Adjusted win ratio with stratification: Calculation methods and interpretation. Statistical Methods in Medical Research, 30(2), 580–611. https://doi.org/10.1177/0962280220942558\n\n\nGasparyan, S. B., Kowalewski, E. K., Folkvaljon, F., Bengtsson, O., Buenconsejo, J., Adler, J., & Koch, G. G. (2021). Power and sample size calculation for the win odds test: application to an ordinal endpoint in COVID-19 trials. Journal of Biopharmaceutical Statistics, 31(6), 765–787. https://doi.org/10.1080/10543406.2021.1968893\n\n\nGehan, E. A. (1965). A generalized Wilcoxon test for comparing arbitrarily singly-censored samples. Biometrika, 52(1-2), 203–224. https://doi.org/10.1093/biomet/52.1-2.203\n\n\nLuo, X., Qiu, J., Bai, S., & Tian, H. (2017). Weighted win loss approach for analyzing prioritized outcomes. Statistics in Medicine, 36(15), 2452–2465. https://doi.org/10.1002/sim.7284\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative Approach to Confidence Interval Estimation for the Win Ratio Statistic. Biometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio. Biometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L., Kim, K., & Li, Y. (2022). On recurrent-event win ratio. Statistical Methods in Medical Research, 31(6), 1120–1134. https://doi.org/10.1177/09622802221084134\n\n\nOakes, D. (1989). Bivariate Survival Models Induced by Frailties. Journal of the American Statistical Association, 84(406), 487–493. https://doi.org/10.1080/01621459.1989.10478795\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with multiple types of event. Biometrika, 103(3), 742–745. https://doi.org/10.1093/biomet/asw026\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The win ratio: a new approach to the analysis of composite endpoints in clinical trials based on clinical priorities. European Heart Journal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nSeifu, Y., Mt-Isa, S., Duke, K., Gamalo-Siebers, M., Wang, W., Dong, G., & Kolassa, J. (2022). Design of paediatric trials with benefit-risk endpoints using a composite score of adverse events of interest (AEI) and win-statistics. Journal of Biopharmaceutical Statistics, 33(6), 696–707. https://doi.org/10.1080/10543406.2022.2153202\n\n\nWang, B., Zhou, D., Zhang, J., Kim, Y., Chen, L.-W., Dunnmon, P., Bai, S., Liu, Q., & Ishida, E. (2023). Statistical power considerations in the use of win ratio in cardiovascular outcome trials. Contemporary Clinical Trials, 124, 107040. https://doi.org/10.1016/j.cct.2022.107040\n\n\nYang, S., & Troendle, J. (2020). Event-specific win ratios and testing with terminal and non-terminal events. Clinical Trials, 18(2), 180–187. https://doi.org/10.1177/1740774520972408\n\n\nYang, S., Troendle, J., Pak, D., & Leifer, E. (2022). Event-specific win ratios for inference with terminal and non-terminal events. Statistics in Medicine, 41(7), 1225–1241. https://doi.org/10.1002/sim.9266\n\n\nYu, R. X., & Ganju, J. (2022). Sample size formula for a win ratio endpoint. Statistics in Medicine, 41(6), 950–963. https://doi.org/10.1002/sim.9297\n\n\nZhou, T. J., LaValley, M. P., Nelson, K. P., Cabral, H. J., & Massaro, J. M. (2022). Calculating power for the Finkelstein and Schoenfeld test statistic for a composite endpoint with two components. Statistics in Medicine, 41(17), 3321–3335. https://doi.org/10.1002/sim.9419"
  },
  {
    "objectID": "chap2.html#estimand",
    "href": "chap2.html#estimand",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Estimand",
    "text": "Estimand\n\n\nWhat is estimand of WR?\n\nCensoring-weighted average of time-dependent WRs (Oakes, 2016) \\[\n\\frac{\\hat w_{1,0}}{\\hat w_{0,1}}\\to\n\\frac{\\int_0^\\infty\\pr(\\mbox{Treatment wins by } t)\\dd G(t)}\n{\\int_0^\\infty\\pr(\\mbox{Control wins by } t)\\dd G(t)}\n\\]\n\n\\(G(t)\\): Distribution function of \\(C^\\t\\wedge C^\\c\\)"
  },
  {
    "objectID": "testing.html#win-ratio-definitions-and-properties",
    "href": "testing.html#win-ratio-definitions-and-properties",
    "title": "2  Hypothesis Testing",
    "section": "2.1 Win Ratio: Definitions and Properties",
    "text": "2.1 Win Ratio: Definitions and Properties\nThe win ratio (WR) is a pairwise, nonparametric method for comparing composite outcomes in a prioritized manner. Each subject in the treatment arm is compared to each subject in the control arm over a shared follow-up window. A win is declared if the treated subject experiences a better outcome—typically defined as longer survival or, if tied on survival, fewer or later nonfatal events.\nFormally, let \\(D_i^{(a)}, T_i^{(a)}, C_i^{(a)}\\) denote survival, hospitalization, censoring times on \\(i\\)th subject in group \\(a\\) \\((i=1,\\ldots, N_a; a= 1, 0)\\). Then the win fraction for group \\(a\\) versus \\(1-a\\) is \\[\n\\hat w^{(a, 1-a)} = \\frac{1}{N_1N_0} \\sum_{i=1}^{N_a} \\sum_{j=1}^{N_{1-a}} \\hat w^{(a, 1-a)}_{ij},\n\\] where \\[\\begin{align}\n            \\hat w^{(a, 1-a)}_{ij}&= \\underbrace{I(D_j^{(1-a)}&lt; D_i^{(a)}\\wedge C_i^{(a)}\\wedge C_j^{(1-a)})}_{\\mbox{win on survival}}\\\\\n            & + \\underbrace{I(\\min(D_i^{(a)}, D_j^{(1-a)}) &gt; C_i^{(a)}\\wedge C_j^{(1-a)}, T_j^{(1-a)}&lt; T_i^{(a)}\\wedge C_i^{(1)}\\wedge C_j^{(0)})}_{\\mbox{tie on survival, win on hospitalization}}\n    \\end{align}\\]\nThe win ratio statistic is defined as \\[\n\\text{WR} = \\frac{\\hat w^{(1, 0)}}{\\hat w^{(0, 1)}}.\n\\]\nAlternative summaries include the net benefit (proportion in favor) and the win odds, which account for ties and interpret the WR on a log-odds scale. In the special case of binary outcomes, the WR reduces to the odds ratio, and the net benefit corresponds to the risk difference.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#hypothesis-testing-and-interpretation",
    "href": "testing.html#hypothesis-testing-and-interpretation",
    "title": "2  Hypothesis Testing",
    "section": "2.2 Hypothesis Testing and Interpretation",
    "text": "2.2 Hypothesis Testing and Interpretation\nStatistical inference for the WR is based on the asymptotic normality of the log win ratio: \\[\nS_n = \\frac{\\sqrt{n} \\log(\\hat w_{1,0} / \\hat w_{0,1})}{\\hat{\\rm SE}} \\sim N(0, 1),\n\\] under the null hypothesis that treatment and control are equally effective. The standard error \\(\\hat{\\rm SE}\\) is calculated via \\(U\\)-statistics, and the null corresponds to equal bivariate survival functions \\(H^{(1)}(s, t) = H^{(0)}(s, t)\\) for all \\(t \\le s\\).\nThe alternative hypothesis assumes that the probability of a treatment win exceeds that of a control win at all times. A sufficient condition is that the joint distribution of death and nonfatal events under treatment is stochastically larger than under control.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#extensions-and-variants",
    "href": "testing.html#extensions-and-variants",
    "title": "2  Hypothesis Testing",
    "section": "2.3 Extensions and Variants",
    "text": "2.3 Extensions and Variants\nSeveral extensions of the WR improve its flexibility and robustness. Weighted comparisons allow later follow-up times to contribute more to the test statistic, leading to log-rank-type weights. Stratified WR methods compare subjects within strata to adjust for confounding and increase efficiency.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#generalization-to-recurrent-events",
    "href": "testing.html#generalization-to-recurrent-events",
    "title": "2  Hypothesis Testing",
    "section": "2.4 Generalization to Recurrent Events",
    "text": "2.4 Generalization to Recurrent Events\nWhen subjects experience multiple nonfatal events, a generalized WR can be defined using a win function \\(\\mathcal{W}(\\cdot, \\cdot)(t)\\) that compares event histories up to time \\(t\\). The generalized win ratio statistic becomes \\[\n\\hat{\\mathcal E}_n(\\mathcal W) = \\frac{\\sum \\mathcal W(\\mathcal H^{*(1)}_i, \\mathcal H^{*(0)}_j)}\n     {\\sum \\mathcal W(\\mathcal H^{*(0)}_j, \\mathcal H^{*(1)}_i)},\n\\] where comparisons are made up to the minimum of each pair’s observed follow-up time.\nThree versions of recurrent-event win functions are commonly used:\n\nNaive WR: prioritize death, then total number of events\nFirst-event WR: further prioritize time to first event\nLast-event WR: further prioritize time to last event\n\nAll versions enforce a win/loss/tie rule based on observable history, and guarantee that win status is unchanged after death. Among them, the last-event WR (LWR) has shown superior power in simulation studies due to fewer ties and better separation between subjects.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#hf-action-example",
    "href": "testing.html#hf-action-example",
    "title": "2  Hypothesis Testing",
    "section": "2.5 HF-ACTION Example",
    "text": "2.5 HF-ACTION Example\nIn the HF-ACTION trial, recurrent-event WR methods were applied to a high-risk subgroup of 426 patients. Compared to usual care, exercise training reduced both mortality and hospitalizations. The last-event WR was estimated as 1.32 (95% CI: 1.05–1.66, p = 0.019), with similar results from first-event and naive WRs.\n\n\n\n\n\nThese results illustrate that recurrent-event WRs detect benefits more effectively than traditional time-to-first-event WRs, especially when the number and timing of nonfatal events vary widely across subjects.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#sample-size-calculation",
    "href": "testing.html#sample-size-calculation",
    "title": "2  Hypothesis Testing",
    "section": "2.6 Sample Size Calculation",
    "text": "2.6 Sample Size Calculation\nSample size calculation for WR is based on a joint model for death and nonfatal events. Under a Gumbel–Hougaard copula model, the joint survival function is \\[\n        \\pr(D^\\a&gt;s, T_1^\\a&gt;t) = \\exp\\left(-\\left[\\{\\exp(a\\xi_D)\\lambda_Ds\\}^\\kappa + \\{\\exp(a\\xi_H)\\lambda_Ht\\}^\\kappa \\right]^{1/\\kappa}\\right)\n\\] where \\(\\lambda_D^a\\) and \\(\\lambda_H^a\\) are arm-specific baseline hazard rates and \\(\\kappa\\) controls the dependence between outcomes.\nThe required sample size is \\[\nn = \\frac{\\zeta_0^2(z_{1-\\alpha/2} + z_\\gamma)^2}{q(1-q)\\delta^\\top \\xi},\n\\] where:\n\n\\(\\zeta_0^2\\) is the variance of the test statistic under the null,\n\\(\\delta\\) is the sensitivity of the log-WR to changes in log-HRs \\(\\xi\\),\n\\(q\\) is the treatment allocation proportion.\n\nDesign parameters include the accrual duration \\(\\tau_b\\), total follow-up time \\(\\tau\\), and a random loss-to-follow-up rate \\(\\lambda_L\\).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#hf-action-planning-a-new-trial",
    "href": "testing.html#hf-action-planning-a-new-trial",
    "title": "2  Hypothesis Testing",
    "section": "2.7 HF-ACTION: Planning a New Trial",
    "text": "2.7 HF-ACTION: Planning a New Trial\nUsing HF-ACTION training arm data as historical reference, the estimated baseline rates were:\n\n\\(\\lambda_D = 0.073\\) deaths/year\n\\(\\lambda_H = 0.56\\) hospitalizations/year\nKendall’s correlation = 36.1%\n\nAssuming HRs of 0.9 (death) and 0.8 (hospitalization), and minimal loss to follow-up, the sample size required for 80% power is approximately \\(n = 1241\\).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#example-r-code",
    "href": "testing.html#example-r-code",
    "title": "2  Hypothesis Testing",
    "section": "2.8 Example R code",
    "text": "2.8 Example R code\nThe following example uses a data frame df in long format with columns:\n\nid: subject identifier\n\ntime: event or censoring time\n\nstatus: event type (0 = censoring, 1 = death, 2 = nonfatal)\n\ntrt: treatment group (0 = control, 1 = treatment)\n\nstrata: optional stratification variable\n\n\n########################################\n# 1. WR test for recurrent events\n########################################\nlibrary(WR)\n\nobj &lt;- WRrec(ID = df$id, time = df$time, status = df$status, \n             trt = df$trt, strata = df$strata, naive = TRUE)\n\n# Extract log win ratio and standard error\nobj$log.WR\nobj$se\nprint(obj)\n\n\n########################################\n# 2. Sample size calculation\n########################################\n# Step 1: Estimate baseline outcome parameters\nbase_est &lt;- gumbel.est(id = df$id, time = df$time, status = df$status)\n\n# Step 2: Design-specific noise and signal\nbparam &lt;- base(lambda_D = base_est$lambda_D,\n               lambda_H = base_est$lambda_H,\n               kappa = base_est$kappa,\n               tau_c = 3, tau = 4, lambda_L = 0.001)\n\n# Step 3: Required sample size for given effect sizes\nWRSS(xi = log(c(0.9, 0.8)), bparam = bparam, q = 0.5, power = 0.8)$n",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#conclusion",
    "href": "testing.html#conclusion",
    "title": "2  Hypothesis Testing",
    "section": "2.9 Conclusion",
    "text": "2.9 Conclusion\nThe win ratio test provides a clinically meaningful and statistically valid method for analyzing prioritized composite outcomes. By extending to recurrent events and general win functions, the WR accommodates complex patient trajectories while preserving interpretability. Among several extensions, the last-event WR offers strong separation and improved power in trials with repeated nonfatal events.\nSample size formulas grounded in copula models enable principled trial design. The WR package supports both estimation and power analysis, facilitating the broader adoption of win-based strategies in modern clinical research.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  }
]