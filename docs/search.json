[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "",
    "text": "Course Info\nThis is a companion site for the same-titled workshop at the 2024 Society for Clinical Trials (SCT) Annual Meeting given on May 19, 2024 at Boston Marriott Copley Place (map) in Boston, MA."
  },
  {
    "objectID": "index.html#time-and-place",
    "href": "index.html#time-and-place",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Time and Place",
    "text": "Time and Place\n\nSun, May 19 | 8:00 AM - 12:00 PM\nRoom: Suffolk (3rd Floor)"
  },
  {
    "objectID": "index.html#instructor-profile",
    "href": "index.html#instructor-profile",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Instructor Profile",
    "text": "Instructor Profile\nLu Mao, PhD\n\nAssociate Professor of Biostatistics at UW-Madison\nMethodologic research\n\nR01HL149875: Novel Statistical Methods for Complex Time-to-Event Data in Cardiovascular Clinical Trials (12/01/2019 – 07/31/2028)\nDMS2015526: Randomized Trials with Non-Compliance (07/01/2020 – 06/30/2024)\n\nCollaborative research\n\nCardiovascular disease, cancer, radiology, behavioral health interventions\n\nTeaching\n\nSurvival Analysis: Theory and Methods (UW; 2020 - 2024)\n\nEditorial service\n\nStatistical Editor, JACC Journals\nAssociate Editor, Statistics for Biopharmaceutical Research"
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Learning Outcomes",
    "text": "Learning Outcomes\n\nUnderstand the statistical and scientific challenges with composite endpoints as well as regulatory guidelines/requirements\nLearn the basics of statistical methodology, e.g., testing, power analysis, nonparametric estimation, and semiparametric regression to address these challenges\nGet hands-on experience with real data using publicly available R-packages"
  },
  {
    "objectID": "index.html#syllabus",
    "href": "index.html#syllabus",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Syllabus",
    "text": "Syllabus\n\n1. Introduction (30 min)\n\n1.1 Examples & guidelines\n1.2 Traditional methods and limitations\n1.3 Win ratio methods and limitations\n\n2. Hypothesis Testing (40 min)\n\n2.1 Win ratio by Pocock et al. (2012)\n2.2 Statistical properties\n2.3 Handling recurrent events (R-package WR)\n2.4 Sample size calculation (R-package WR)\n\n3. Nonparametric Estimation (60 min)\n\n3.1 Restricted win ratio\n3.2 Average win time analysis (R-package rmt)\n\n3.1.1 Restricted mean time in favor of treatment\n3.1.2 Estimation, inference, and graphics\n3.1.3 Real Examples\n\n3.3 While-alive loss rate (R-package WA)\n\n3.2.1 Definition, interpretation, and estimation\n3.2.3 Real Examples\n\n\n4. Semiparametric Regression (30 min)\n\n4.1 Proportional win-fractions model (R-package WR)\n\n4.1.1 Model assumptions\n4.1.2 Estimation, inference, and model diagnostics\n4.1.3 Real Examples\n\n4.2 Generalized proportional odds model (tentative)\n\n4.2.1 Model specification and possible estimation\n\n\n5. Discussions (20 min)\n\n5.1. Open problems\n\n5.1.1 Covariate adjustment\n5.1.2 Interim monitoring\n5.1.3 Intercurrent events\n\n5.2. Course summary"
  },
  {
    "objectID": "index.html#r-packages",
    "href": "index.html#r-packages",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "R-Packages",
    "text": "R-Packages\nTo proceed, install/load the following packages:\n\n# install packages --------------------------------\ninstall.packages(\"Wcompo\")\ninstall.packages(\"WR\")\ninstall.packages(\"rmt\")\ninstall.packages(\"WA\")\n# load packages -----------------------------------\nlibrary(tidyverse)\nlibrary(survival)\nlibrary(Wcompo)\nlibrary(WR)\nlibrary(rmt)\nlibrary(WA)"
  },
  {
    "objectID": "intro.html#slides",
    "href": "intro.html#slides",
    "title": "1  Introduction",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "intro.html#r-code",
    "href": "intro.html#r-code",
    "title": "1  Introduction",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 1       ##\n##################################################################\n\n# load the survival package\nlibrary(survival)\n# install.packages(\"Wcompo\")\nlibrary(Wcompo) # for weighted total events\nlibrary(rmt) # for hfaction data\nlibrary(tidyverse) # for data wrangling\n\n# load hfaction data\ndata(hfaction)\nhead(hfaction)\n\n# convert status=1 for death, 2=hospitalization\nhfaction &lt;- hfaction |&gt; \n  mutate(\n    status = case_when(\n      status == 1 ~ 2,\n      status == 2 ~ 1,\n      status == 0 ~ 0\n    )\n  )\n\nhead(hfaction)\n\n# count unique patients in each arm\nhfaction |&gt; \n  group_by(trt_ab) |&gt; \n  distinct(patid) |&gt; \n  count(trt_ab)\n\n# TFE: take the first event per patient id\nhfaction_TFE &lt;- hfaction |&gt; \n  arrange(patid, time) |&gt; \n  group_by(patid) |&gt; \n  slice_head() |&gt; \n  ungroup()\n\n# Mortality analysis ------------------------------------------------------\n\n## get mortality data\nhfaction_D &lt;- hfaction |&gt; \n  filter(status != 2) # remove hospitalization records\n\n## Cox model for death against trt_ab\nobj_D &lt;- coxph(Surv(time, status) ~ trt_ab, data = hfaction_D)\nsummary(obj_D)\n#&gt; n= 426, number of events= 93 \n#&gt; coef exp(coef) se(coef)      z Pr(&gt;|z|)  \n#&gt; trt_ab -0.3973    0.6721   0.2129 -1.866   0.0621 .\n\n# TFE analysis --------------------------------------------------------\n\n## how many of first events are death (1) or hosp (2)\nhfaction_TFE |&gt; \n  count(status)\n\n# Cox model for TFE against trt_ab\nobj_TFE &lt;- coxph(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE)\nsummary(obj_TFE)\n\n\n# Mortality vs TFE --------------------------------------------------------\n\nlibrary(ggsurvfit)\nlibrary(patchwork)\n\npD &lt;- survfit2(Surv(time, status) ~ trt_ab, data = hfaction_D) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Overall survival\")\n\npTFE &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Hospitalization-free survival\")\n\n\npD + pTFE + plot_layout(guides = \"collect\") & \n  theme(\n    legend.position = \"top\", \n    legend.text = element_text(size = 12)\n    )\n\nggsave(\"images/intro_hfaction_unis.png\", width = 8, height = 4.5)\n\n# Total events (proportional mean) ----------------------------------------\n## fit proportional means model with death = 2 x hosp\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, hfaction$status, \n                  hfaction$trt_ab, w = c(2, 1))\n## summary results\nobj_ML\n\n## plot model-based mean functions\nplot(obj_ML, 0, ylim= c(0, 5), xlim= c(0, 4), xlab=\"Time (years)\", \n     col = \"red\", lwd = 2)\nplot(obj_ML, 1, add = TRUE, col = \"blue\", lwd=2)\nlegend(0, 5, col = c(\"red\", \"blue\"), c(\"Usual care\",\"Training\"), lwd = 2)"
  },
  {
    "objectID": "testing.html#slides",
    "href": "testing.html#slides",
    "title": "2  Hypothesis Testing",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "testing.html#r-code",
    "href": "testing.html#r-code",
    "title": "2  Hypothesis Testing",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 2       ##\n##################################################################\n\n\n# load the survival package\nlibrary(survival)\n\n# install and load the WR package for\n# 1. dataset hfaction_cpx9;\n# 2. function WRrec() for win ratio test (of recurrent events and death)\n# 3. functions base() and WRSS() for sample size calculation\n# install.packages(\"WR\")\nlibrary(WR)\nlibrary(tidyverse) # for data wrangling\n\n\n##### Read in HF-ACTION DATA########\n# same as rmt::hfaction used in chap 1 \n#  (except for status coding)\ndata(hfaction_cpx9)\nhfaction &lt;- hfaction_cpx9\nhead(hfaction)\n\n\n# count unique patients in each arm\nhfaction |&gt; \n  group_by(trt_ab) |&gt; \n  distinct(patid) |&gt; \n  count(trt_ab)\n  \n#### demo ############\nobj &lt;- WRrec(ID = hfaction$patid, time = hfaction$time, \n             status = hfaction$status, trt = hfaction$trt_ab,\n             strata = hfaction$age60, naive = TRUE)\n# summary results\nobj\n\n# LWR\nbeta &lt;- obj$log.WR\nse &lt;- obj$se\n# test\npval &lt;- 2*(1-pnorm(abs(beta/se)))\npval\n\n# NWR\nbeta.naive&lt;-obj$log.WR.naive\nse.naive&lt;-obj$se.naive\n# test\npval.naive&lt;-2*(1-pnorm(abs(beta.naive/se.naive)))\npval.naive\n\n\n# FWR\nbeta.FI&lt;-obj$log.WR.FI\nse.FI&lt;-obj$se.FI\n# test\npval.FI&lt;-2*(1-pnorm(abs(beta.FI/se.FI)))\npval.FI\n\n\n#################################\n# Win ratio analyses: tabulate  #\n#################################\n\ndata &lt;- hfaction \n### create a dataset with only the first hospitalization data.H1\n\n# hospitalization data\ntmpH &lt;- data[data$status==2,]\n# get the first record of each id\no &lt;- order(tmpH$patid,tmpH$time)\ntmpH &lt;- tmpH[o,]\ntmpFH &lt;- tmpH[!duplicated(tmpH$patid),]\n\n# combine it with mortality data\ndata.H1 &lt;- rbind(tmpFH,data[data$status!=2,])\no &lt;- order(data.H1$patid,data.H1$time)\ndata.H1 &lt;- data.H1[o,]\n\n\n# Function to create table for estimates of \n# PWR, NWR, FWR, and LWR, 95% CI nad p-values\n# ind: index for data\n# ind1: index for data.H1\n# r: number of decimal point\ngwr.fun=function(ind,ind1,r=2){\n\n# fit NWR, FWR, and LWR\nobj &lt;- WRrec(ID=data$patid[ind],time=data$time[ind],status=data$status[ind],\n          trt=data$trt_ab[ind],strata=data$age60[ind],naive=T)\n# fit sWR\nobj1 &lt;- WRrec(ID=data.H1$patid[ind1],time=data.H1$time[ind1],status=data.H1$status[ind1],\n          trt=data.H1$trt_ab[ind1],strata=data.H1$age60[ind1],naive=F)\n\n# critical value of p=0.05\nza &lt;- qnorm(0.975)\n\n## LWR\nbeta &lt;- obj$log.WR\nse &lt;- obj$se\ntheta &lt;- obj$theta\n\nr4 &lt;- c(paste0(round(100*theta[1],1),\"%\"),\n     paste0(round(100*theta[2],1),\"%\"),\n     paste0(round(exp(beta),r),\" (\",round(exp(beta-za*se),r),\", \",round(exp(beta+za*se),r),\")\"),\n     round(1-pchisq((beta/se)^2,1),3)\n)\n\n\n## PWR\nbeta1=obj1$log.WR\nse1=obj1$se\ntheta1=obj1$theta\n\nr1=c(paste0(round(100*theta1[1],1),\"%\"),\n     paste0(round(100*theta1[2],1),\"%\"),\n     paste0(round(exp(beta1),r),\" (\",round(exp(beta1-za*se1),r),\", \",round(exp(beta1+za*se1),r),\")\"),\n     round(1-pchisq((beta1/se1)^2,1),3)\n)\n\n## NWR\nbeta.naive=obj$log.WR.naive\nse.naive=obj$se.naive\ntheta.naive=obj$theta.naive\n\n\nr2=c(paste0(round(100*theta.naive[1],1),\"%\"),\n     paste0(round(100*theta.naive[2],1),\"%\"),\n     paste0(round(exp(beta.naive),r),\" (\",round(exp(beta.naive-za*se.naive),r),\", \",\n            round(exp(beta.naive+za*se.naive),r),\")\"),\n     round(1-pchisq((beta.naive/se.naive)^2,1),3)\n)\n\n\n\n\n## FWR\nbeta.FI=obj$log.WR.FI\nse.FI=obj$se.FI\ntheta.FI=obj$theta.FI\n\n\nr3=c(paste0(round(100*theta.FI[1],1),\"%\"),\n     paste0(round(100*theta.FI[2],1),\"%\"),\n     paste0(round(exp(beta.FI),r),\" (\",round(exp(beta.FI-za*se.FI),r),\", \",\n            round(exp(beta.FI+za*se.FI),r),\")\"),\n     round(1-pchisq((beta.FI/se.FI)^2,1),3)\n)\n\nresult=rbind(r1,r2,r3,r4)\nrownames(result)=c(\"PWR\",\"NWR\",\"FWR\",\"LWR\")\n\nreturn(result)\n}\n\n\n# Create table\n## Age &lt;= 60 years\nind=(data$age60==0)\nind1=(data.H1$age60==0)\nresult.lt60=gwr.fun(ind,ind1,r=2)\n\n## Age &gt; 60 years\nind=(data$age60==1)\nind1=(data.H1$age60==1)\nresult.ge60=gwr.fun(ind,ind1,r=2)\n\n## overall\nind=rep(T,nrow(data))\nind1=rep(T,nrow(data.H1))\nresult.all=gwr.fun(ind,ind1,r=2)\n\n# combine results \nresults=rbind(result.lt60,result.ge60,result.all)\ncolnames(results)=c(\"Win\", \"Loss\", \"Win ratio (95% CI)\", \"p-value\")\nnoquote(results)\n\n\n\n############################################################################\n#               Sample size calculation                                    #     \n############################################################################\n\n# get training arm data\npilot &lt;- hfaction |&gt; \n  filter(trt_ab == 1)\n# number of subjects\npilot |&gt; distinct(patid) |&gt; \n  count()\n\n############## estimate parameters ##############\n# Get the variables from pilot dataset\n# to estimate baseline parameters \n# lambda_D, lambda_H, kappa\n\noutcome_base &lt;- gumbel.est(pilot$patid, pilot$time / 12, pilot$status)\n\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- outcome_base$kappa\n\nlambda_D\nlambda_H\nkappa\n\n## Kendall's rank correlation\n1 - 1/kappa\n#&gt; [1] 0.360812\n\n### demo ###################\n# set design parameters\ntau_b &lt;- 3\ntau &lt;- 4\nlambda_L &lt;- 0.01\n# use base() function to compute zeta2 and delta\n## may take up to 30s\nbparam &lt;- base(lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\n# compute sample size under HRs 0.8 and 0.9\n# for death and nonfatal event, respectively\nobj &lt;- WRSS(xi = log(c(0.9,0.8)), bparam = bparam, q =  0.5, alpha = 0.05,\n          power = 0.8)\n\nobj$n\n\n\n## effect size specification\nthetaD &lt;- seq(0.6, 0.95,by = 0.05) ## hazard ratio for death\nthetaH &lt;- seq(0.6, 0.95,by = 0.05) ## hazard ratio for hospitalization\n\n## create a matrix \"SS08\" for sample size powered at 80% \n## under each combination of thetaD and thetaH\nmD &lt;- length(thetaD)\nmH &lt;- length(thetaH)\nSS08 &lt;- matrix(NA, mD, mH)\nrownames(SS08) &lt;- thetaD\ncolnames(SS08) &lt;- thetaH\n## fill in the computed sample size values\nfor (i in 1:mD){\n  for (j in 1:mH){\n    ## sample size under hazard ratios thetaD[i] for death and thetaH[j] for hospitalization\n    SS08[i,j]&lt;-WRSS(xi=log(c(thetaD[i],thetaH[j])),bparam=bparam,q=0.5,alpha=0.05,\n                    power=0.8)$n\n  }\n}\n## print the calculated sample sizes\nprint(SS08)\n# 0.6     0.65      0.7     0.75       0.8     0.85      0.9      0.95\n# 0.6  198.1636 261.3528 351.2579 484.2468  691.0512 1034.785 1661.812  2976.570\n# 0.65 209.5088 278.6457 378.4143 528.6465  767.7521 1177.940 1961.252  3727.580\n# 0.7  220.9045 296.2334 406.4659 575.4320  850.7474 1338.718 2316.976  4708.455\n# 0.75 232.3703 314.1480 435.4823 624.8038  940.7326 1519.930 2742.885  6016.294\n# 0.8  243.9237 332.4188 465.5327 676.9740 1038.4859 1724.935 3257.279  7803.776\n# 0.85 255.5795 351.0732 496.6864 732.1690 1144.8828 1957.769 3884.618 10321.618\n# 0.9  267.3513 370.1374 529.0141 790.6317 1260.9129 2223.322 4658.150 14003.925\n# 0.95 279.2513 389.6366 562.5886 852.6243 1387.6996 2527.561 5623.948 19653.870\n\n## repeating the same calculation for power = 90%\nSS09 &lt;- matrix(NA, mD, mH)\nrownames(SS09) &lt;- thetaD\ncolnames(SS09) &lt; -thetaH\n## fill in the computed sample size values\nfor (i in 1:mD){\n  for (j in 1:mH){\n    ## sample size under hazard ratios thetaD[i] for death and thetaH[j] for hospitalization\n    SS09[i,j]&lt;-WRSS(xi=log(c(thetaD[i],thetaH[j])),bparam=bparam,q=0.5,alpha=0.05,\n                    power=0.9)$n\n  }\n}\n## print the calculated sample sizes\nprint(SS09)\n# [,1]     [,2]     [,3]      [,4]      [,5]     [,6]     [,7]      [,8]\n# 0.6  265.2849 349.8773 470.2346  648.2691  925.1215 1385.283 2224.695  3984.783\n# 0.65 280.4729 373.0275 506.5893  707.7076 1027.8022 1576.928 2625.560  4990.172\n# 0.7  295.7284 396.5725 544.1425  770.3402 1138.9094 1792.164 3101.773  6303.285\n# 0.75 311.0780 420.5551 582.9873  836.4350 1259.3740 2034.755 3671.945  8054.111\n# 0.8  326.5446 445.0145 623.2161  906.2762 1390.2379 2309.198 4360.573 10447.042\n# 0.85 342.1484 469.9874 664.9221  980.1666 1532.6732 2620.897 5200.401 13817.718\n# 0.9  357.9075 495.5089 708.1999 1058.4316 1688.0046 2976.398 6235.942 18747.282\n# 0.95 373.8383 521.6128 753.1465 1141.4221 1857.7360 3383.687 7528.871 26310.956\n\noldpar &lt;- par(mfrow = par(\"mfrow\"))\npar(mfrow=c(1,2))\npersp(thetaD, thetaH, SS08/1000, theta = 50, phi = 15, expand = 0.8, col = \"gray\",\n      ltheta = 180, lphi=180, shade = 0.75,\n      ticktype = \"detailed\",\n      xlab = \"\\n HR on Death\", ylab = \"\\n HR on Hospitalization\",\n      zlab=paste0(\"\\n Sample Size (10e3)\"),\n      main=\"Power = 80%\",\n      zlim=c(0, 26)\n)\npersp(thetaD, thetaH, SS09/1000, theta = 50, phi = 15, expand = 0.8, col = \"gray\",\n      ltheta = 180, lphi=180, shade = 0.75,\n      ticktype = \"detailed\",\n      xlab = \"\\nHR on Death\", ylab = \"\\nHR on Hospitalization\",\n      zlab=paste0(\"\\n Sample Size (10e3)\"),\n      main=\"Power = 90%\",\n      zlim=c(0, 26)\n)"
  },
  {
    "objectID": "estimation.html#slides",
    "href": "estimation.html#slides",
    "title": "3  Nonparametric Estimation",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "estimation.html#r-code",
    "href": "estimation.html#r-code",
    "title": "3  Nonparametric Estimation",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 3       ##\n##################################################################\n\n\n\n# install.packages(\"rmt\")\nlibrary(rmt)\nlibrary(tidyverse)\n\n##### Read in HF-ACTION DATA########\ndata(hfaction)\nhead(hfaction)\n\n# TFE: take the first event per patient id\nhfaction_TFE &lt;- hfaction |&gt; \n  arrange(patid, time) |&gt; \n  group_by(patid) |&gt; \n  slice_head() |&gt; \n  ungroup()\n\n###### Standard RMST analysis #################\nlibrary(survRM2)\n\n# Mortality analysis ------------------------------------------------------\n\n## get mortality data\nhfaction_D &lt;- hfaction |&gt; \n  filter(status != 1) # remove hospitalization records\n\n## RMST analysis for overall survival \nrmst_obj &lt;- rmst2(hfaction_D$time, hfaction_D$status&gt;0, hfaction_D$trt_ab, tau=3.97)\nrmst_obj\n# Between-group contrast \n#                       Est. lower .95 upper .95     p\n# RMST (arm=1)-(arm=0) 0.238     0.013     0.464 0.039\n# RMST (arm=1)/(arm=0) 1.074     1.003     1.150 0.040\n# RMTL (arm=1)/(arm=0) 0.680     0.468     0.988 0.043\nrmst &lt;- rmst_obj$unadjusted.result[1, 1] * 12 # convert to month\nrmst_p &lt;- rmst_obj$unadjusted.result[1, 4]\n\n\n# TFE analysis --------------------------------------------------------\n\n## how many of first events are death (1) or hosp (2)\nhfaction_TFE |&gt; \n  count(status)\n\n##RMST analysis for hospitalization-free survival \nrmest_obj &lt;- rmst2(hfaction_TFE$time, hfaction_TFE$status&gt;0, hfaction_TFE$trt_ab, tau=3.97)\nrmest_obj\n# Between-group contrast \n#                       Est. lower .95 upper .95     p\n# RMST (arm=1)-(arm=0) 0.198    -0.064     0.459 0.139\n# RMST (arm=1)/(arm=0) 1.145     0.957     1.370 0.139\n# RMTL (arm=1)/(arm=0) 0.924     0.832     1.027 0.141\n# extract p-value\nrmest &lt;- rmest_obj$unadjusted.result[1, 1] * 12 # convert to month\nrmest_p &lt;- rmest_obj$unadjusted.result[1, 4]\n\n\n\n\n\n# Mortality vs TFE --------------------------------------------------------\n\nlibrary(ggsurvfit)\nlibrary(patchwork)\n\npD &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_D) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  annotate(\"text\", x = 4, y = 1, hjust = 1, vjust = 1, \n           label = str_c(\"4y-RMST = \", round(rmst, 2), \" months\",\n                            \" (P = \", round(rmst_p, 3), \")\")) +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Overall survival\")\n\npTFE &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE) |&gt;\n  ggsurvfit(linewidth = 1) +\n  annotate(\"text\", x = 4, y = 1, hjust = 1, vjust = 1, \n           label = str_c(\"4y-RMEST = \", round(rmest, 2), \" months\",\n                         \" (P = \", round(rmest_p, 3), \")\")) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Hospitalization-free survival\",\n       caption = \"RMEST: restricted mean event-free survival time\")\n\n\npD + pTFE + plot_layout(guides = \"collect\") & \n  theme(\n    legend.position = \"top\", \n    legend.text = element_text(size = 12)\n  ) \n\n# ggsave(\"images/est_hfaction_unis.png\", width = 8, height = 4.6)\n\n\n########################\n# RMT-IF analysis\n########################\n\n\n# analyze the data using rmtfit()\nobj &lt;- rmtfit(rec(patid, time, status) ~ trt_ab, data = hfaction)\n# Alternatively\n# obj=rmtfit(id,time,status,trt,type=\"recurrent\")\n\nsummary(obj, Kmax = 1, tau = 3.97)\n\n#############################################################\n# Graphical analysis of the HF-ACTION trial to\n# evaluate the effect of exercise training.\n###########################################################\n\npar(mfrow=c(1,2))\n# Kmax=4: to aggregate k=4,..., K\nbouquet(obj,Kmax=4,cex.group = 1.0,\n        xlab=\"Restricted mean win/loss time (years)\",\n        ylab=\"Follow-up time (years)\",group.label=F,ylim=c(0,4.2))\ntext(-0.8,4.15,paste(\"Usual care\"))\ntext(0.8,4.15,paste(\"Exercise training\"))\n\nplot(obj,conf=T,lwd=2, xlab=\"Follow-up time (years)\",\n     ylab=\"RMT-IF of training (years)\",main=\"\")\npar(mfrow=c(1,1))\n\n### LaTeX table ###\n\n### format to LATEX table\npval_fmt3=function(x){\n  if(x&lt;0.001){\n    return(\"$&lt;$0.001\")\n  }else{\n    return(round(x,3))\n  }\n}\n\n\nltable=NULL\n# aggregate the results for k=1,..., K\nhosp_sum=summary(obj,Kmax=1,tau=3.97)$tab\n# aggregate the results for k=4,..., K\nall_sum=summary(obj,Kmax=4,tau=3.97)$tab\n\nltable=c(\"&\",\"&\",\"&\",round(12*hosp_sum[1,1],2),\"&\",round(12*hosp_sum[1,2],2),\"&\",pval_fmt3(hosp_sum[1,4]),\"\\\\\")\n\nfor (i in 1:6){\n  tmp=c(\"&\",i,\"&&\",round(12*all_sum[i,1],2),\"&\",round(12*all_sum[i,2],2),\"&\",pval_fmt3(all_sum[i,4]),\"\\\\\")\n  ltable=rbind(ltable,tmp)\n}\n\nltable[5,2]=\"4+\"\nltable[6:7,2]=\"\"\n\nrownames(ltable)=c(\"Hopitalization\",\"\",\"\" ,\"\",\"\",\"Death\",\"Overall\")\n\nnoquote(ltable)\n\n\n\n#######################################################################\n#               WA analysis                                           #\n#######################################################################\n\n\n# install.packages(\"WA\")\nlibrary(WA)\n\n# load the hf-action study data\nhead(hfaction)\n\n# descriptive analysis\n\n## death & hosp rates\n\nhfaction |&gt; \n  group_by(trt_ab,patid) |&gt; \n  summarize(\n    ND = sum(status == 2),\n    NH = sum(status == 1)\n  ) |&gt; \n  summarize(\n    death_rate = mean(ND),\n    avgNH = mean(NH),\n    sdNH = sd(NH)\n  )\n\n\n# weighted while-alive event rate (death vs hosp = 2:1).\nobj &lt;- LRfit(hfaction$patid, hfaction$time, hfaction$status, hfaction$trt_ab, \n             Dweight = 2)\n## print some descriptive information \nobj\n\n## summarize the inference results at tau=4 years\nsummary(obj, tau = 3.97, joint.test = TRUE)\n\nplot(obj)\n\n# unadjusted cumulative mean (Ch 1) ----------------------------------------\n## fit proportional means model with death = 2 x hosp\nlibrary(Wcompo)\n## change status coding\nstatus &lt;- hfaction$status\nstatus[status != 0] &lt;- 3 - status[status != 0]\n\n\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, status, \n                  hfaction$trt_ab, w = c(2, 1))\n## summary results\nt &lt;- obj_ML$t ## time\nmu0 &lt;- obj_ML$y ## baseline mean of t\nmu1 &lt;- mu0 * exp(as.numeric(obj_ML$beta))\n\n## plot survival-adjusted cumulative event \n## vs unadjusted under PM model\nplot(obj, ylab = \"Cumulative loss\", xlab = \"Time (years)\")\nlines(t[t&lt;=3.97], mu0[t&lt;=3.97], lty = 3, col = \"red\", lwd = 2)\nlines(t[t&lt;=3.97], mu1[t&lt;=3.97], lty = 3, col = \"blue\", lwd = 2)\nlegend(\"bottomright\", col = c(\"red\", \"red\", \"blue\", \"blue\"), \n       c(\"Usual care (WA)\", \"Usual care (unadj)\", \n         \"Training (WA)\", \"Training (unadj)\"), \n       lty = c(1, 3, 1, 3), lwd = 2)"
  },
  {
    "objectID": "regression.html#slides",
    "href": "regression.html#slides",
    "title": "4  Semiparametric Regression",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "regression.html#r-code",
    "href": "regression.html#r-code",
    "title": "4  Semiparametric Regression",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 4       ##\n##################################################################\n\n\n# install.packages(\"WR\")\nlibrary(WR)\nlibrary(tidyverse)\nlibrary(knitr) # for formatted table output\n\n\n# load the data\ndata(non_ischemic)\n# head(non_ischemic)\n\n\n\n# Descriptive analysis ----------------------------------------------------\n\n# function to convert 1-0 to Yes-No\none_zero_to_yn &lt;- function(x){\n  if_else(x == 1, \"Yes\", \"No\")\n}\n\n\n# clean up data\ndf &lt;- non_ischemic |&gt; \n  filter(status != 2) |&gt;  # de-duplicate\n  mutate( # clean up the levels of categorical variables\n    trt_ab = fct(if_else(trt_ab == 0, \"Usual care\", \"Training\")),\n    sex = if_else(sex == 1, \"Female\", \"Male\"),\n    race = case_when(\n      Black.vs.White == 1 ~ \"Black\",\n      Other.vs.White == 1 ~ \"Other\",\n      Black.vs.White == 0 & Other.vs.White == 0 ~ \"White\"\n    ),\n    race = fct(race),\n    across(hyperten:smokecurr, one_zero_to_yn)\n  ) \n\n\n## a function to compute median (IQR) for x\n## rounded to the rth decimal place\nmed_iqr &lt;- function(x, r = 1){\n  qt &lt;- quantile(x, na.rm = TRUE)\n  \n  str_c(round(qt[3], r), \" (\", \n        round(qt[2], r), \", \",\n        round(qt[4], r), \")\")\n}\n\n# create summary table for quantitative variables\n# age, size, nodes, prog, estrg\ntab_quant &lt;- df |&gt; \n  group_by(trt_ab) |&gt; \n  summarize(\n    across(c(age, bmi, bipllvef), med_iqr)\n  ) |&gt; \n  pivot_longer( # long format: value = median (IQR); name = variable names\n    !trt_ab,\n    values_to = \"value\",\n    names_to = \"name\"\n  ) |&gt; \n  pivot_wider( # wide format: name = variable names; trt_ab as columns\n    values_from = value,\n    names_from = trt_ab\n  ) |&gt; \n  mutate(\n    name = case_when( # format the variable names\n      name == \"age\" ~ \"Age (years)\",\n      name == \"bmi\" ~ \"BMI\",\n      name == \"bipllvef\" ~ \"LVEF (%)\"\n    )\n  )\n\n\n## a function that computes N (%) for each level of var\n## by group in data frame df (percent rounded to rth point)\nfreq_pct&lt;- function(df, group, var, r = 1){\n  # compute the N for each level of var by group\n  var_counts &lt;- df |&gt; \n    group_by({{ group }}, {{ var }}) |&gt; \n    summarize(\n      n = n(),\n      .groups = \"drop\"\n    ) \n  # compute N (%)\n  var_counts |&gt; \n    left_join( # compute the total number (demoninator) in each group\n      # and joint it back to the numerator\n      var_counts |&gt; group_by({{ group }}) |&gt; summarize(N = sum(n)),\n      by = join_by({{ group }})\n    ) |&gt; \n    mutate( # N (%)\n      value = str_c(n, \" (\", round(100 * n / N, r), \"%)\")\n    ) |&gt; \n    select(- c(n, N)) |&gt; \n    pivot_wider( # put group levels on columns\n      names_from = {{ group }},\n      values_from = value\n    ) |&gt; \n    rename(\n      name = {{ var }} # name = variable names \n    )\n}\n\n# Apply this function to sex, race, hyperten:smokecurr \n  \n# sex\nsex &lt;- df |&gt;\n  freq_pct(trt_ab, sex) |&gt; \n  mutate(\n    name = str_c(\"Sex - \", name)\n  )\n\n# race\nrace &lt;- df |&gt;\n  freq_pct(trt_ab, race) |&gt; \n  mutate(\n    name = str_c(\"Race - \", name)\n  )\n\nhyperten &lt;- df |&gt;\n  freq_pct(trt_ab, hyperten) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Hypertension\"\n  )\n\nhyperten &lt;- df |&gt;\n  freq_pct(trt_ab, hyperten) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Hypertension\"\n  )\n\n\nCOPD &lt;- df |&gt;\n  freq_pct(trt_ab, COPD) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"COPD\"\n)  \n\ndiabetes &lt;- df |&gt;\n  freq_pct(trt_ab, diabetes) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Diabetes\"\n  )  \n\nacei &lt;- df |&gt;\n   freq_pct(trt_ab, acei) |&gt; \n   filter(name == \"Yes\") |&gt; \n   mutate(\n     name = \"ACE Inhibitor\"\n   ) \n   \nbetab &lt;- df |&gt;\n  freq_pct(trt_ab, betab) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Beta Blocker\"\n  )     \n\n\nsmokecurr &lt;- df |&gt;\n  freq_pct(trt_ab, betab) |&gt; \n  filter(name == \"smokecurr\") |&gt; \n  mutate(\n    name = \"Smoker\"\n  )     \n\n\ntabone &lt;- bind_rows(\n  tab_quant[1, ],\n  sex, race,\n  tab_quant[2:3, ],\n  hyperten, COPD, diabetes, acei, betab, smokecurr    \n)\n\n\n## add N to group names  \ncolnames(tabone) &lt;- c(\" \", str_c(colnames(tabone)[2:3], \" (N=\", table(df$trt_ab),\")\"))\n## print out the table\nkable(tabone, align = c(\"lcc\"))\n\n\n\n\nTable 4.1: Patient characteristics in non-ischemic cohort of HF-ACTION\n\n\n\nUsual care (N=231)\nTraining (N=220)\n\n\n\n\nAge (years)\n56 (46, 65.5)\n54 (46, 62.2)\n\n\nSex - Female\n153 (66.2%)\n121 (55%)\n\n\nSex - Male\n78 (33.8%)\n99 (45%)\n\n\nRace - White\n117 (50.6%)\n111 (50.5%)\n\n\nRace - Black\n103 (44.6%)\n101 (45.9%)\n\n\nRace - Other\n11 (4.8%)\n8 (3.6%)\n\n\nBMI\n31.3 (26.3, 37.2)\n31 (25.8, 36.5)\n\n\nLVEF (%)\n25.1 (20.9, 31.3)\n25.1 (20.9, 31.2)\n\n\nHypertension\n129 (55.8%)\n129 (58.6%)\n\n\nCOPD\n21 (9.1%)\n15 (6.8%)\n\n\nDiabetes\n71 (30.7%)\n58 (26.4%)\n\n\nACE Inhibitor\n174 (75.3%)\n167 (75.9%)\n\n\nBeta Blocker\n223 (96.5%)\n211 (95.9%)\n\n\n\n\n\n\n\n\nShow the code\n# PW regression analysis --------------------------------------------------\n\n# re-label the covariates with informative names.\n\ncolnames(non_ischemic)[4:16]=c(\n  \"Training vs Usual\",\"Age (year)\",\"Male vs Female\",\"Black vs White\", \n  \"Other vs White\", \"BMI\",\"LVEF\",\"Hypertension\",\"COPD\",\"Diabetes\",\n  \"ACE Inhibitor\",\"Beta Blocker\", \"Smoker\"\n)\n\n\np &lt;- ncol(non_ischemic)-3\n\n# extract ID, time, status and covariates matrix Z from the data.\n# note that: ID, time and status should be column vector\nID &lt;- non_ischemic[,\"ID\"]\ntime &lt;- non_ischemic[,\"time\"] / 30.5 # days to months\nstatus &lt;- non_ischemic[,\"status\"]\nZ &lt;- as.matrix(non_ischemic[,4:(3+p)])\n\n# pass the parameters into the function\nobj &lt;- pwreg(ID, time, status, Z)\nobj\n\n# extract estimates of (beta_4, beta_5)\nbeta &lt;- matrix(obj$beta[4:5])\n# extract estimated covariance matrix for (beta_4, beta_5)\nSigma &lt;- obj$Var[4:5, 4:5]\n# compute chisq statistic in quadratic form\nchistats &lt;- t(beta) %*% solve(Sigma) %*% beta  \n\n# compare the Wald statistic with the reference\n# distribution of chisq(2) to obtain the p-value\n1 - pchisq(chistats, df = 2)\n#&gt;           [,1]\n#&gt; [1,] 0.1016988\n\n\n# compute score processes\nscore_obj &lt;- score.proc(obj)\n# plot scores for all 13 covariates\npar(mfrow = c(4, 4))\nfor(i in c(1:13)){\n  plot(score_obj, k = i, xlab = \"Time (months)\")\n  # add reference lines\n  abline(a = 2, b = 0, lty = 3)\n  abline(a = 0, b = 0, lty = 3)\n  abline(a = - 2, b = 0, lty = 3)\n}\n\n\n### Exercise: Stratify by sex ###\nsex &lt;- Z[, 3]\nZs &lt;- Z[, -3]\nobj_str&lt;-pwreg(ID, time, status, Zs, strata = sex)\nobj_str"
  },
  {
    "objectID": "discussions.html#slides",
    "href": "discussions.html#slides",
    "title": "5  Discussions",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Akacha, M., Binkowitz, B., Bretz, F., Fritsch, A., Hougaard, P.,\nJahn-Eimermacher, A., & al., et. (2018). Request for CHMP\nqualification opinion: Clinically interpretable treatment effect\nmeasures based on recurrent event endpoints that allow for efficient\nstatistical analyses. http://www.ema.europa.eu/documents/other/qualification-opinion-treatment-effect-measures-when-using-recurrent-event-endpoints-applicants_en.pdf.\n\n\nAkacha, M., Bretz, F., Ohlssen, D., Rosenkranz, G., & Schmidli, H.\n(2017). Estimands and Their Role in Clinical Trials. Statistics in\nBiopharmaceutical Research, 9(3), 268–271. https://doi.org/10.1080/19466315.2017.1302358\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win\nratio analysis of a composite outcome based on prioritized components.\nBiostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBennett, S. (1983). Analysis of survival data by the proportional odds\nmodel. Statistics in Medicine, 2(2), 273–277. https://doi.org/10.1002/sim.4780020223\n\n\nBrunner, E., Vandemeulebroecke, M., & Mütze, T. (2021). Win odds: An\nadaptation of the win ratio to include ties. Statistics in\nMedicine, 40(14), 3367–3384. https://doi.org/10.1002/sim.8967\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized\noutcomes in the two-sample problem. Statistics in\nMedicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nCHMP. (2020). Qualification opinion of clinically interpretable\ntreatment effect measures based on recurrent event endpoints that allow\nfor efficient statistical analyses. https://www.ema.europa.eu/en/documents/other/qualification-opinion-clinically-interpretable-treatment-effect-measures-based-recurrent-event_en.pdf.\n\n\nCui, Y., & Huang, B. (2023). WINS: The r WINS package. https://CRAN.R-project.org/package=WINS\n\n\nDeltuvaite-Thomas, V., Verbeeck, J., Burzykowski, T., Buyse, M.,\nTournigand, C., Molenberghs, G., & Thas, O. (2022). Generalized\npairwise comparisons for censored data: An overview. Biometrical\nJournal, 65(2). https://doi.org/10.1002/bimj.202100354\n\n\nDong, G., Hoaglin, D. C., Huang, B., Cui, Y., Wang, D., Cheng, Y., &\nGamalo-Siebers, M. (2023). The stratified win statistics (win ratio, win\nodds, and net benefit). Pharmaceutical Statistics,\n22(4), 748–756. https://doi.org/10.1002/pst.2293\n\n\nDong, G., Huang, B., Chang, Y.-W., Seifu, Y., Song, J., & Hoaglin,\nD. C. (2020a). The win ratio: Impact of censoring and\nfollow-up time and use with nonproportional hazards.\nPharmaceutical Statistics, 19(3), 168–177. https://doi.org/10.1002/pst.1977\n\n\nDong, G., Huang, B., Wang, D., Verbeeck, J., Wang, J., & Hoaglin, D.\nC. (2021). Adjusting win statistics for dependent censoring.\nPharmaceutical Statistics, 20(3), 440–450. https://doi.org/10.1002/pst.2086\n\n\nDong, G., Li, D., Ballerstedt, S., & Vandemeulebroecke, M. (2016). A\ngeneralized analytic solution to the win ratio to analyze a composite\nendpoint considering the clinical importance order among components.\nPharmaceutical Statistics, 15(5), 430–437. https://doi.org/10.1002/pst.1763\n\n\nDong, G., Mao, L., Huang, B., Gamalo-Siebers, M., Wang, J., Yu, G.,\n& Hoaglin, D. C. (2020b). The inverse-probability-of-censoring\nweighting (IPCW) adjusted win ratio statistic: an unbiased estimator in\nthe presence of independent censoring. Journal of Biopharmaceutical\nStatistics, 30(5), 882–899. https://doi.org/10.1080/10543406.2020.1757692\n\n\nDong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2017). The\nstratified win ratio. Journal of Biopharmaceutical Statistics,\n28(4), 778–796. https://doi.org/10.1080/10543406.2017.1397007\n\n\nEUnetHTA. (2015). Guidance for industry: Multiple endpoints in\nclinical trials. https://www.eunethta.eu/wp-content/uploads/2018/01/Endpoints-used-for-Relative-Effectiveness-Assessment-Composite-endpoints_Amended-JA1-Guideline_Final-Nov-2015_0.pdf\n\n\nFay, M. P., Brittain, E. H., Shih, J. H., Follmann, D. A., &\nGabriel, E. E. (2018). Causal estimands and confidence intervals\nassociated with Wilcoxon-Mann-Whitney tests in\nrandomized experiments. Statistics in Medicine,\n37(20), 2923–2937. https://doi.org/10.1002/sim.7799\n\n\nFDA. (2017). Guidance for industry: Multiple endpoints in clinical\ntrials. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/multiple-endpoints-clinical-trials-guidance-industry\n\n\nFDA. (2023). Guidance document: Adjusting for covariates in\nrandomized clinical trials for drugs and biological products. US\nFood and Drug Adminstration. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/adjusting-covariates-randomized-clinical-trials-drugs-and-biological-products\n\n\nFine, J. P., & Gray, R. J. (1999). A Proportional Hazards Model for\nthe Subdistribution of a Competing Risk. Journal of the American\nStatistical Association, 94(446), 496–509. https://doi.org/10.1080/01621459.1999.10474144\n\n\nFinkelstein, D. M., & Schoenfeld, D. A. (1999). Combining mortality\nand longitudinal measures in clinical trials. Statistics in\nMedicine, 18(11), 1341–1354. https://doi.org/10.1002/(sici)1097-0258(19990615)18:11&lt;1341::aid-sim129&gt;3.0.co;2-7\n\n\nFollmann, D., Fay, M. P., Hamasaki, T., & Evans, S. (2019). Analysis\nof ordered composite endpoints. Statistics in Medicine,\n39(5), 602–616. https://doi.org/10.1002/sim.8431\n\n\nFreemantle, N., Calvert, M., Wood, J., Eastaugh, J., & Griffin, C.\n(2003). Composite Outcomes in Randomized Trials. JAMA,\n289(19), 2554. https://doi.org/10.1001/jama.289.19.2554\n\n\nFritsch, A., Schlömer, P., Mendolia, F., Mütze, T., &\nJahn-Eimermacher, A. (2023). Efficiency Comparison of Analysis Methods\nfor Recurrent Event and Time-to-First Event Endpoints in the Presence of\nTerminal EventsApplication to Clinical Trials in Chronic\nHeart Failure. Statistics in Biopharmaceutical Research,\n15(2), 268–279. https://doi.org/10.1080/19466315.2021.1945488\n\n\nGasparyan, S. B., Kowalewski, E. K., Folkvaljon, F., Bengtsson, O.,\nBuenconsejo, J., Adler, J., & Koch, G. G. (2021). Power and sample\nsize calculation for the win odds test: application to an ordinal\nendpoint in COVID-19 trials. Journal of Biopharmaceutical\nStatistics, 31(6), 765–787. https://doi.org/10.1080/10543406.2021.1968893\n\n\nGhosh, D., & Lin, D. Y. (2000). Nonparametric Analysis of Recurrent\nEvents and Death. Biometrics, 56(2), 554–562. https://doi.org/10.1111/j.0006-341x.2000.00554.x\n\n\nGray, R. J. (1988). A class of K-sample tests for comparing the\ncumulative incidence of a competing risk. The Annals of\nStatistics, 16(3). https://doi.org/10.1214/aos/1176350951\n\n\nICH. (1998). Statistical principles for clinical trials.\nLondon: European Medicines Evaluation Agency.\n\n\nICH. (2020). ICH E9 (R1) addendum on estimands and sensitivity\nanalysis in clinical trials to the guideline on statistical principles\nfor clinical trials, step 5. London: European Medicines Evaluation\nAgency.\n\n\nIonan, A. C., Paterniti, M., Mehrotra, D. V., Scott, J., Ratitch, B.,\nCollins, S., Gomatam, S., Nie, L., Rufibach, K., & Bretz, F. (2022).\nClinical and Statistical Perspectives on the ICH E9(R1) Estimand\nFramework Implementation. Statistics in Biopharmaceutical\nResearch, 15(3), 554–559. https://doi.org/10.1080/19466315.2022.2081601\n\n\nLi, H., Chen, W.-C., Lu, N., Tang, R., & Zhao, Y. (2024). The\nelusiveness of the win ratio parameter in the presence of missing data.\nTherapeutic Innovation & Regulatory Science, 1–2.\n\n\nLin, D. Y., Wei, L. J., & Ying, Z. (1993). Checking the Cox model\nwith cumulative sums of martingale-based residuals. Biometrika,\n80(3), 557–572. https://doi.org/10.1093/biomet/80.3.557\n\n\nLu, Y., & Tian, L. (2021). Statistical Considerations for Sequential\nAnalysis of the Restricted Mean Survival Time for Randomized Clinical\nTrials. Statistics in Biopharmaceutical Research,\n13(2), 210–218. https://doi.org/10.1080/19466315.2020.1816491\n\n\nLuo, X., Huang, B., & Quan, H. (2019). Design and monitoring of\nsurvival trials based on restricted mean survival times. Clinical\nTrials, 16(6), 616–625. https://doi.org/10.1177/1740774519871447\n\n\nLuo, X., Qiu, J., Bai, S., & Tian, H. (2017). Weighted win loss\napproach for analyzing prioritized outcomes. Statistics in\nMedicine, 36(15), 2452–2465. https://doi.org/10.1002/sim.7284\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative\nApproach to Confidence Interval Estimation for the Win Ratio Statistic.\nBiometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2018). On causal estimation using U-statistics. Biometrika,\n105(1), 215–220. https://doi.org/10.1093/biomet/asx071\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio.\nBiometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L. (2023a). Nonparametric Inference of General While-Alive\nEstimands for Recurrent Events. Biometrics, 79(3),\n1749–1760. https://doi.org/10.1111/biom.13709\n\n\nMao, L. (2023b). On restricted mean time in favor of treatment.\nBiometrics, 79(1), 61–72. https://doi.org/10.1111/biom.13570\n\n\nMao, L. (2023c). Power and Sample Size Calculations for the Restricted\nMean Time Analysis of Prioritized Composite Endpoints. Statistics in\nBiopharmaceutical Research, 15(3), 540–548. https://doi.org/10.1080/19466315.2022.2110936\n\n\nMao, L. (2023d). Study Design for Restricted Mean Time Analysis of\nRecurrent Events and Death. Biometrics, 79(4),\n3701–3714. https://doi.org/10.1111/biom.13923\n\n\nMao, L. (2024). Defining estimand for the win ratio: separate the true\neffect from censoring. Clinical Trials, In press.\n\n\nMao, L., & Kim, K. (2021). Statistical Models for Composite\nEndpoints of Death and Nonfatal Events: A Review. Statistics in\nBiopharmaceutical Research, 13(3), 260–269. https://doi.org/10.1080/19466315.2021.1927824\n\n\nMao, L., Kim, K., & Li, Y. (2022). On recurrent-event win ratio.\nStatistical Methods in Medical Research, 31(6),\n1120–1134. https://doi.org/10.1177/09622802221084134\n\n\nMao, L., Kim, K., & Miao, X. (2022). Sample size formula for general\nwin ratio analysis. Biometrics, 78(3), 1257–1268. https://doi.org/10.1111/biom.13501\n\n\nMao, L., & Lin, D. Y. (2016). Semiparametric regression for the\nweighted composite endpoint of recurrent and terminal events.\nBiostatistics, 17(2), 390–403. https://doi.org/10.1093/biostatistics/kxv050\n\n\nMao, L., & Wang, T. (2021). A class of proportional\nwin-fractions regression models for composite outcomes.\nBiometrics, 77(4), 1265–1275. https://doi.org/10.1111/biom.13382\n\n\nMao, L., & Wang, T. (2024). Dissecting the restricted mean time in\nfavor of treatment. Journal of Biopharmaceutical Statistics,\n34(1), 111–126. https://doi.org/10.1080/10543406.2023.2210658\n\n\nMoertel, C. G., Fleming, T. R., Macdonald, J. S., Haller, D. G., Laurie,\nJ. A., Goodman, P. J., Ungerleider, J. S., Emerson, W. A., Tormey, D.\nC., Glick, J. H., Veeder, M. H., & Mailliard, J. A. (1990).\nLevamisole and Fluorouracil for Adjuvant Therapy of Resected Colon\nCarcinoma. New England Journal of Medicine, 322(6),\n352–358. https://doi.org/10.1056/nejm199002083220602\n\n\nMurphy, S. A., Rossini, A. J., & Vaart, A. W. van der. (1997).\nMaximum Likelihood Estimation in the Proportional Odds Model.\nJournal of the American Statistical Association,\n92(439), 968–976. https://doi.org/10.1080/01621459.1997.10474051\n\n\nO’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L.\nS., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W.,\nBlumenthal, J. A., Rendall, D. S., Miller, N. H., Fleg, J. L., Schulman,\nK. A., McKelvie, R. S., Zannad, F., Piña, I. L., & HF-ACTION\nInvestigators, for the. (2009). Efficacy and Safety of Exercise Training\nin Patients With Chronic Heart Failure. JAMA, 301(14),\n1439. https://doi.org/10.1001/jama.2009.454\n\n\nOakes, D. (1989). Bivariate Survival Models Induced by Frailties.\nJournal of the American Statistical Association,\n84(406), 487–493. https://doi.org/10.1080/01621459.1989.10478795\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with\nmultiple types of event. Biometrika, 103(3), 742–745.\nhttps://doi.org/10.1093/biomet/asw026\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The\nwin ratio: a new approach to the analysis of composite endpoints in\nclinical trials based on clinical priorities. European Heart\nJournal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nQu, Y., & Lipkovich, I. (2021). Implementation of ICH E9 (R1): A Few\nPoints Learned During the COVID-19 Pandemic. Therapeutic Innovation\n& Regulatory Science, 55(5), 984–988. https://doi.org/10.1007/s43441-021-00297-6\n\n\nRatitch, B., Bell, J., Mallinckrodt, C., Bartlett, J. W., Goel, N.,\nMolenberghs, G., O’Kelly, M., Singh, P., & Lipkovich, I. (2020).\nChoosing Estimands in Clinical Trials: Putting the ICH E9(R1) Into\nPractice. Therapeutic Innovation & Regulatory Science,\n54(2), 324–341. https://doi.org/10.1007/s43441-019-00061-x\n\n\nRoyston, P., & Parmar, M. K. B. (2011). The use of restricted mean\nsurvival time to estimate the treatment effect in randomized clinical\ntrials when the proportional hazards assumption is in doubt.\nStatistics in Medicine, 30(19), 2409–2421. https://doi.org/10.1002/sim.4274\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023a). Estimands for\nRecurrent Event Endpoints in the Presence of a Terminal Event.\nStatistics in Biopharmaceutical Research, 15(2),\n238–248. https://doi.org/10.1080/19466315.2021.1895883\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023b). Rejoinder to\nCommentaries on “Estimands for Recurrent Event Endpoints in\nthe Presence of a Terminal Event”. Statistics in\nBiopharmaceutical Research, 15(2), 255–256. https://doi.org/10.1080/19466315.2023.2166098\n\n\nSeifu, Y., Mt-Isa, S., Duke, K., Gamalo-Siebers, M., Wang, W., Dong, G.,\n& Kolassa, J. (2022). Design of paediatric trials with benefit-risk\nendpoints using a composite score of adverse events of interest (AEI)\nand win-statistics. Journal of Biopharmaceutical Statistics,\n33(6), 696–707. https://doi.org/10.1080/10543406.2022.2153202\n\n\nSong, J., Verbeeck, J., Huang, B., Hoaglin, D. C., Gamalo-Siebers, M.,\nSeifu, Y., Wang, D., Cooner, F., & Dong, G. (2022). The win odds:\nstatistical inference and regression. Journal of Biopharmaceutical\nStatistics, 33(2), 140–150. https://doi.org/10.1080/10543406.2022.2089156\n\n\nTroendle, J. F., Leifer, E. S., Yang, S., Jeffries, N., Kim, D.-Y., Joo,\nJ., & O’Connor, C. M. (2024). Use of win time for ordered composite\nendpoints in clinical trials. Statistics in Medicine,\n43(10), 1920–1932. https://doi.org/10.1002/sim.10045\n\n\nTsiatis, A. A., Davidian, M., Zhang, M., & Lu, X. (2008). Covariate\nadjustment for two-sample treatment comparisons in\nrandomized clinical trials: A principled yet flexible approach.\nStatistics in Medicine, 27(23), 4658–4677. https://doi.org/10.1002/sim.3113\n\n\nUno, H., & Horiguchi, M. (2023). Ratio and difference of average\nhazard with survival weight: New measures to quantify survival benefit\nof new therapy. Statistics in Medicine, 42(7),\n936–952. https://doi.org/10.1002/sim.9651\n\n\nVerbeeck, J., De Backer, M., Verwerft, J., Salvaggio, S., Valgimigli,\nM., Vranckx, P., Buyse, M., & Brunner, E. (2023). Generalized\nPairwise Comparisons to Assess Treatment Effects. Journal of the\nAmerican College of Cardiology, 82(13), 1360–1372. https://doi.org/10.1016/j.jacc.2023.06.047\n\n\nWang, B., Susukida, R., Mojtabai, R., Amin-Esmaeili, M., &\nRosenblum, M. (2021). Model-Robust Inference for Clinical Trials that\nImprove Precision by Stratified Randomization and Covariate Adjustment.\nJournal of the American Statistical Association,\n118(542), 1152–1163. https://doi.org/10.1080/01621459.2021.1981338\n\n\nWang, B., Zhou, D., Zhang, J., Kim, Y., Chen, L.-W., Dunnmon, P., Bai,\nS., Liu, Q., & Ishida, E. (2023). Statistical power considerations\nin the use of win ratio in cardiovascular outcome trials.\nContemporary Clinical Trials, 124, 107040. https://doi.org/10.1016/j.cct.2022.107040\n\n\nWang, T., Li, Y., & Qu, Y. (2024). Restricted time win ratio: from\nestimands to estimation. Statistics in Biopharmaceutical\nResearch, 1–18. https://doi.org/10.1080/19466315.2024.2332675\n\n\nWang, T., & Mao, L. (2022). Stratified proportional\nwin-fractions regression analysis. Statistics in\nMedicine, 41(26), 5305–5318. https://doi.org/10.1002/sim.9570\n\n\nWang, T., Zilinskas, R., Li, Y., & Qu, Y. (2023). Missing Data\nImputation for a Multivariate Outcome of Mixed Variable Types.\nStatistics in Biopharmaceutical Research, 15(4),\n826–837. https://doi.org/10.1080/19466315.2023.2169753\n\n\nWei, J., Mütze, T., Jahn-Eimermacher, A., & Roger, J. (2023).\nProperties of Two While-Alive Estimands for Recurrent Events and Their\nPotential Estimators. Statistics in Biopharmaceutical Research,\n15(2), 257–267. https://doi.org/10.1080/19466315.2021.1994457\n\n\nWu, P., Han, Y., Chen, T., & Tu, X. M. (2013). Causal inference for\nMann-Whitney-Wilcoxon rank sum and other nonparametric statistics.\nStatistics in Medicine, 33(8), 1261–1271. https://doi.org/10.1002/sim.6026\n\n\nYe, T., Shao, J., Yi, Y., & Zhao, Q. (2022). Toward Better Practice\nof Covariate Adjustment in Analyzing Randomized Clinical Trials.\nJournal of the American Statistical Association,\n118(544), 2370–2382. https://doi.org/10.1080/01621459.2022.2049278\n\n\nYu, R. X., & Ganju, J. (2022). Sample size formula for a win ratio\nendpoint. Statistics in Medicine, 41(6), 950–963. https://doi.org/10.1002/sim.9297\n\n\nZhou, T. J., LaValley, M. P., Nelson, K. P., Cabral, H. J., &\nMassaro, J. M. (2022). Calculating power for the Finkelstein and\nSchoenfeld test statistic for a composite endpoint with two components.\nStatistics in Medicine, 41(17), 3321–3335. https://doi.org/10.1002/sim.9419\n\n\nZinman, B., Wanner, C., Lachin, J. M., Fitchett, D., Bluhmki, E.,\nHantel, S., Mattheus, M., Devins, T., Johansen, O. E., Woerle, H. J.,\nBroedl, U. C., & Inzucchi, S. E. (2015). Empagliflozin,\nCardiovascular Outcomes, and Mortality in Type 2 Diabetes. New\nEngland Journal of Medicine, 373(22), 2117–2128. https://doi.org/10.1056/nejmoa1504720"
  }
]