[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "",
    "text": "Course Info\nThis is a companion site for the same-titled workshop for the 44th annual Applied Statistics Workshop hosted by the Southern California Chapter of the ASA.",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#time-and-place",
    "href": "index.html#time-and-place",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Time and Place",
    "text": "Time and Place\n\nFriday, April 25 · 9am - 4pm PDT\nPlatt Conference Center, Cooper Auditorium\nCity of Hope, 1500 East Duarte Road, Duarte, CA 91010",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#instructor-profile",
    "href": "index.html#instructor-profile",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Instructor Profile",
    "text": "Instructor Profile\n\nLu Mao, PhD\n\nAssociate Professor of Biostatistics at UW-Madison\nMethodologic research\n\nR01HL149875: Novel Statistical Methods for Complex Time-to-Event Data in Cardiovascular Clinical Trials (12/01/2019 – 07/31/2028)\nDMS2015526: Randomized Trials with Non-Compliance (07/01/2020 – 06/30/2024)\n\nCollaborative research\n\nCardiovascular disease, cancer, radiology, behavioral health interventions\n\nTeaching\n\nSurvival Analysis: Theory and Methods (UW; 2020 - 2024)\n\nEditorial service\n\nStatistical Editor, JACC Journals\nAssociate Editor, Statistics for Biopharmaceutical Research",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Learning Outcomes",
    "text": "Learning Outcomes\n\nIdentify statistical and regulatory challenges with composite endpoints\n\nApply key methods such as hypothesis testing, power analysis, and regression\n\nGain hands-on experience with real data using R packages",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#syllabus",
    "href": "index.html#syllabus",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "Syllabus",
    "text": "Syllabus\n\n1. Introduction (30 min)\n\n1.1 Examples & guidelines\n1.2 Traditional methods and limitations\n1.3 Win ratio methods and limitations\n\n2. Hypothesis Testing (40 min)\n\n2.1 Win ratio by Pocock et al. (2012)\n2.2 Statistical properties\n2.3 Handling recurrent events (R-package WR)\n2.4 Sample size calculation (R-package WR)\n\n3. Nonparametric Estimation (60 min)\n\n3.1 Restricted win ratio\n3.2 Average win time analysis (R-package rmt)\n\n3.1.1 Restricted mean time in favor of treatment\n3.1.2 Estimation, inference, and graphics\n3.1.3 Real Examples\n\n3.3 While-alive loss rate (R-package WA)\n\n3.2.1 Definition, interpretation, and estimation\n3.2.3 Real Examples\n\n\n4. Semiparametric Regression (45 min)\n\n4.1 Proportional win-fractions model (R-package WR)\n\n4.1.1 Model assumptions\n4.1.2 Estimation, inference, and model diagnostics\n4.1.3 Real Examples\n\n4.2 Variable selection and risk prediction\n\n4.2.1 Elastic net approach (WRNet)\n\n\n5. Discussions (25 min)\n\n5.1. Open problems\n\n5.1.1 Covariate adjustment\n5.1.2 Interim monitoring\n5.1.3 Meta analysis\n\n5.2. Course summary",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "index.html#r-packages",
    "href": "index.html#r-packages",
    "title": "Statistical Methods for Composite Endpoints",
    "section": "R-Packages",
    "text": "R-Packages\nYou will need the following R packages for this workshop:\nWcompo, WR, rmt, and WA, along with base packages like tidyverse and survival.\n\ninstall.packages(c(\"Wcompo\", \"WR\", \"rmt\", \"WA\"))\nlibrary(tidyverse)\nlibrary(survival)\nlibrary(Wcompo)\nlibrary(WR)\nlibrary(rmt)\nlibrary(WA)",
    "crumbs": [
      "Course Info"
    ]
  },
  {
    "objectID": "intro.html#slides",
    "href": "intro.html#slides",
    "title": "Introduction",
    "section": "",
    "text": "Chapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "intro.html#r-code",
    "href": "intro.html#r-code",
    "title": "1  Introduction",
    "section": "R code",
    "text": "R code\n\n\nShow the code\n#################################################################\n# This code generates the numerical results in chapter 1       ##\n#################################################################\n\nlibrary(survival)  # For standard (univariate) survival analysis\nlibrary(Wcompo)    # For weighted total events (CompoML function)\nlibrary(rmt)       # For the hfaction data set (Heart Failure ACTION trial)\nlibrary(tidyverse) # For data wrangling (dplyr, ggplot2, etc.)\n\n# load hfaction data\ndata(hfaction)\nhead(hfaction) \n#&gt; Shows the first rows of the hfaction data frame\n\n# convert status=1 for death, 2=hospitalization\n# (Swapping the original coding of event types in hfaction)\nhfaction &lt;- hfaction |&gt;\n  mutate(\n    status = case_when(\n      status == 1 ~ 2, # status previously \"1\" becomes \"2\" now\n      status == 2 ~ 1, # status previously \"2\" becomes \"1\" now\n      status == 0 ~ 0  # status \"0\" remains \"0\" (censoring)\n    )\n  )\n\nhead(hfaction)\n#&gt; Check that the status values have been reassigned correctly\n\n# count unique patients in each arm\nhfaction |&gt; \n  group_by(trt_ab) |&gt;\n  distinct(patid) |&gt;\n  count(trt_ab)\n#&gt; Summarizes how many unique patients are in each treatment arm (trt_ab)\n\n# TFE: take the first event per patient id\n# This means each patient is represented by their earliest event (or censoring)\nhfaction_TFE &lt;- hfaction |&gt;\n  arrange(patid, time) |&gt;\n  group_by(patid) |&gt;\n  slice_head() |&gt;\n  ungroup()\n\n# -------------------------------------------------------------------------\n# Mortality analysis\n# -------------------------------------------------------------------------\n\n## Get mortality data\nhfaction_D &lt;- hfaction |&gt;\n  filter(status != 2) # remove hospitalization records (now coded as \"2\")\n\n## Cox model for death against trt_ab\nobj_D &lt;- coxph(Surv(time, status) ~ trt_ab, data = hfaction_D)\nsummary(obj_D)\n#&gt; n= 426, number of events= 93 \n#&gt; coef exp(coef) se(coef)      z Pr(&gt;|z|)  \n#&gt; trt_ab -0.3973    0.6721   0.2129 -1.866   0.0621 .\n# Interpretation: a hazard ratio &lt; 1 suggests lower hazard of death in the \n# training arm, though p-value is ~0.06.\n\n# -------------------------------------------------------------------------\n# TFE analysis\n# -------------------------------------------------------------------------\n\n## how many of first events are death (1) or hosp (2)\nhfaction_TFE |&gt;\n  count(status)\n#&gt; Tells how many first events were coded as status=1 or status=2\n\n# Cox model for TFE against trt_ab\n# Here \"status &gt; 0\" means any event (death or hospitalization) vs. censoring\nobj_TFE &lt;- coxph(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE)\nsummary(obj_TFE)\n#&gt; Similar interpretation as above, now for time to first event \n# (either death or hospitalization).\n\n# -------------------------------------------------------------------------\n# Mortality vs TFE\n# -------------------------------------------------------------------------\n\nlibrary(ggsurvfit) # For Kaplan-Meier plots using ggplot2\nlibrary(patchwork) # For combining plots side by side\n\npD &lt;- survfit2(Surv(time, status) ~ trt_ab, data = hfaction_D) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Overall survival\")\n#&gt; pD is the plot of overall survival (death only) for each arm\n\npTFE &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Hospitalization-free survival\")\n#&gt; pTFE is the plot for time to first event (death or hospitalization)\n\n# Combine pD and pTFE plots side by side, sharing legends\npD + pTFE + plot_layout(guides = \"collect\") & \n  theme(\n    legend.position = \"top\", \n    legend.text = element_text(size = 12)\n  )\n\n# ggsave(\"images/intro_hfaction_unis.png\", width = 8, height = 4.5)\n#&gt; Uncomment to save the plot (if needed)\n\n# -------------------------------------------------------------------------\n# Total events (proportional mean)\n# -------------------------------------------------------------------------\n\n## fit proportional means model with death = 2 x hosp\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, hfaction$status, \n                  hfaction$trt_ab, w = c(2, 1))\n#&gt; This model weights death as \"2\" and hospitalization as \"1\". \n#&gt; CompoML fits a marginal proportional means model for these outcomes.\n\n## summary results\nobj_ML\n#&gt; Provides estimates of the weighted event rates in each arm, etc.\n\n## plot model-based mean functions\nplot(obj_ML, 0, ylim= c(0, 5), xlim= c(0, 4), xlab=\"Time (years)\", \n     col = \"red\", lwd = 2)\nplot(obj_ML, 1, add = TRUE, col = \"blue\", lwd=2)\nlegend(0, 5, col = c(\"red\", \"blue\"), c(\"Usual care\",\"Training\"), lwd = 2)\n#&gt; Illustrates the cumulative mean count of \"weighted\" events over time",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "testing.html#slides",
    "href": "testing.html#slides",
    "title": "Hypothesis Testing",
    "section": "",
    "text": "Chapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "testing.html#r-code",
    "href": "testing.html#r-code",
    "title": "2  Hypothesis Testing",
    "section": "R code",
    "text": "R code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in chapter 2         #\n##################################################################\n\n# load the survival package\nlibrary(survival)\n\n# install and load the WR package for\n# 1. dataset hfaction_cpx9;\n# 2. function WRrec() for win ratio test (of recurrent events and death)\n# 3. functions base() and WRSS() for sample size calculation\n# install.packages(\"WR\")\nlibrary(WR)\nlibrary(tidyverse) # for data wrangling (dplyr, ggplot2, etc.)\n\n##### Read in HF-ACTION DATA ########\n# same as rmt::hfaction used in chap 1 \n#  (except for status coding)\ndata(hfaction_cpx9)\nhfaction &lt;- hfaction_cpx9\nhead(hfaction)\n#&gt; Shows the first few rows of hfaction_cpx9 dataset\n\n# count unique patients in each arm\nhfaction |&gt; \n  group_by(trt_ab) |&gt; \n  distinct(patid) |&gt; \n  count(trt_ab)\n#&gt; This gives the number of unique patients (patid) by treatment arm (trt_ab)\n\n#### demo ############\n# WRrec() fits the recurrent event plus death model (Win Ratio approach)\nobj &lt;- WRrec(\n  ID = hfaction$patid,\n  time = hfaction$time,\n  status = hfaction$status,\n  trt = hfaction$trt_ab,\n  strata = hfaction$age60,\n  naive = TRUE\n)\n# summary results\nobj\n#&gt; Displays the main results, including win ratio estimates for each method.\n\n# LWR\nbeta &lt;- obj$log.WR  # log-win ratio for LWR\nse &lt;- obj$se        # standard error for log-win ratio (LWR)\n# test\npval &lt;- 2 * (1 - pnorm(abs(beta / se)))\npval\n#&gt; Two-sided p-value for LWR\n\n# NWR\nbeta.naive &lt;- obj$log.WR.naive  # log-win ratio for naive WR (NWR)\nse.naive &lt;- obj$se.naive        # its standard error\n# test\npval.naive &lt;- 2 * (1 - pnorm(abs(beta.naive / se.naive)))\npval.naive\n#&gt; Two-sided p-value for NWR\n\n# FWR\nbeta.FI &lt;- obj$log.WR.FI  # log-win ratio for Fisher’s information-based WR (FWR)\nse.FI &lt;- obj$se.FI        # standard error for log(FWR)\n# test\npval.FI &lt;- 2 * (1 - pnorm(abs(beta.FI / se.FI)))\npval.FI\n#&gt; Two-sided p-value for FWR\n\n#################################\n# Win ratio analyses: tabulate  #\n#################################\n\ndata &lt;- hfaction \n### create a dataset with only the first hospitalization -&gt; data.H1\n\n# hospitalization data\ntmpH &lt;- data[data$status == 2, ]\n# get the first record of each id\no &lt;- order(tmpH$patid, tmpH$time)\ntmpH &lt;- tmpH[o, ]\ntmpFH &lt;- tmpH[!duplicated(tmpH$patid), ]\n\n# combine it with mortality data\ndata.H1 &lt;- rbind(tmpFH, data[data$status != 2, ])\no &lt;- order(data.H1$patid, data.H1$time)\ndata.H1 &lt;- data.H1[o, ]\n\n# Function to create a summary table for\n# PWR, NWR, FWR, and LWR with their 95% CI and p-values\n# ind:  index (logical) for rows in the main 'data'\n# ind1: index (logical) for rows in 'data.H1'\n# r:    number of decimals for rounding in the output\ngwr.fun = function(ind, ind1, r = 2) {\n  \n  # fit NWR, FWR, and LWR to original data (multiple events)\n  obj &lt;- WRrec(\n    ID = data$patid[ind],\n    time = data$time[ind],\n    status = data$status[ind],\n    trt = data$trt_ab[ind],\n    strata = data$age60[ind],\n    naive = TRUE\n  )\n  \n  # fit sWR (PWR) to dataset with first hospitalization only\n  # This typically addresses \"semi-competing\" event structure\n  obj1 &lt;- WRrec(\n    ID = data.H1$patid[ind1],\n    time = data.H1$time[ind1],\n    status = data.H1$status[ind1],\n    trt = data.H1$trt_ab[ind1],\n    strata = data.H1$age60[ind1],\n    naive = FALSE\n  )\n  \n  # critical value for a 95% confidence interval\n  za &lt;- qnorm(0.975)\n  \n  ## LWR results\n  beta &lt;- obj$log.WR\n  se &lt;- obj$se\n  theta &lt;- obj$theta  # proportion of pairwise comparisons that are wins/losses\n  \n  # Format: percentage of wins, percentage of losses, \n  #         win ratio & 95% CI, p-value\n  r4 &lt;- c(\n    paste0(round(100 * theta[1], 1), \"%\"),  # Win\n    paste0(round(100 * theta[2], 1), \"%\"),  # Loss\n    paste0(\n      round(exp(beta), r), \" (\",\n      round(exp(beta - za * se), r), \", \",\n      round(exp(beta + za * se), r), \")\"\n    ),\n    round(1 - pchisq((beta / se)^2, 1), 3)\n  )\n  \n  ## PWR results\n  beta1 &lt;- obj1$log.WR\n  se1 &lt;- obj1$se\n  theta1 &lt;- obj1$theta\n  \n  r1 &lt;- c(\n    paste0(round(100 * theta1[1], 1), \"%\"),\n    paste0(round(100 * theta1[2], 1), \"%\"),\n    paste0(\n      round(exp(beta1), r), \" (\",\n      round(exp(beta1 - za * se1), r), \", \",\n      round(exp(beta1 + za * se1), r), \")\"\n    ),\n    round(1 - pchisq((beta1 / se1)^2, 1), 3)\n  )\n  \n  ## NWR results\n  beta.naive &lt;- obj$log.WR.naive\n  se.naive &lt;- obj$se.naive\n  theta.naive &lt;- obj$theta.naive\n  \n  r2 &lt;- c(\n    paste0(round(100 * theta.naive[1], 1), \"%\"),\n    paste0(round(100 * theta.naive[2], 1), \"%\"),\n    paste0(\n      round(exp(beta.naive), r), \" (\",\n      round(exp(beta.naive - za * se.naive), r), \", \",\n      round(exp(beta.naive + za * se.naive), r), \")\"\n    ),\n    round(1 - pchisq((beta.naive / se.naive)^2, 1), 3)\n  )\n  \n  ## FWR results\n  beta.FI &lt;- obj$log.WR.FI\n  se.FI &lt;- obj$se.FI\n  theta.FI &lt;- obj$theta.FI\n  \n  r3 &lt;- c(\n    paste0(round(100 * theta.FI[1], 1), \"%\"),\n    paste0(round(100 * theta.FI[2], 1), \"%\"),\n    paste0(\n      round(exp(beta.FI), r), \" (\",\n      round(exp(beta.FI - za * se.FI), r), \", \",\n      round(exp(beta.FI + za * se.FI), r), \")\"\n    ),\n    round(1 - pchisq((beta.FI / se.FI)^2, 1), 3)\n  )\n  \n  # Combine rows into a single table\n  result &lt;- rbind(r1, r2, r3, r4)\n  rownames(result) &lt;- c(\"PWR\", \"NWR\", \"FWR\", \"LWR\")\n  \n  return(result)\n}\n\n# Create table\n## Age &lt;= 60 years\nind &lt;- (data$age60 == 0)\nind1 &lt;- (data.H1$age60 == 0)\nresult.lt60 &lt;- gwr.fun(ind, ind1, r = 2)\n\n## Age &gt; 60 years\nind &lt;- (data$age60 == 1)\nind1 &lt;- (data.H1$age60 == 1)\nresult.ge60 &lt;- gwr.fun(ind, ind1, r = 2)\n\n## overall\nind &lt;- rep(TRUE, nrow(data))\nind1 &lt;- rep(TRUE, nrow(data.H1))\nresult.all &lt;- gwr.fun(ind, ind1, r = 2)\n\n# combine results \nresults &lt;- rbind(result.lt60, result.ge60, result.all)\ncolnames(results) &lt;- c(\"Win\", \"Loss\", \"Win ratio (95% CI)\", \"p-value\")\nnoquote(results)\n#&gt; Final table of all 4 measures (PWR, NWR, FWR, LWR) across strata.\n\n############################################################################\n#               Sample size calculation                                    #     \n############################################################################\n\n# get training arm data\npilot &lt;- hfaction |&gt;\n  filter(trt_ab == 1)\n# number of subjects\npilot |&gt;\n  distinct(patid) |&gt;\n  count()\n#&gt; This indicates how many unique subjects were in the training arm\n\n############## estimate parameters ##############\n# Get the variables from pilot dataset\n# to estimate baseline parameters \n# lambda_D, lambda_H, kappa\n\noutcome_base &lt;- gumbel.est(pilot$patid, pilot$time / 12, pilot$status)\n\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- outcome_base$kappa\n\nlambda_D\nlambda_H\nkappa\n#&gt; Baseline hazards for death/hospitalization and the gumbel 'kappa' parameter\n\n## Kendall's rank correlation\n1 - 1/kappa\n#&gt; [1] 0.360812\n#&gt; This measures correlation between timing of repeated events\n\n### demo ###################\n# set design parameters\ntau_b &lt;- 3   # time from baseline to start of follow-up for base() computation\ntau &lt;- 4     # total follow-up (in years)\nlambda_L &lt;- 0.01  # Additional parameter used in the base() function\n\n# use base() function to compute zeta2 and delta\n## may take up to 30s\nbparam &lt;- base(lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\n#&gt; bparam includes the baseline rates and distribution shape \n#&gt; used for sample size calculations\n\n# compute sample size under HRs 0.8 and 0.9\n# for death and nonfatal event, respectively\nobj &lt;- WRSS(\n  xi = log(c(0.9, 0.8)),\n  bparam = bparam,\n  q = 0.5,\n  alpha = 0.05,\n  power = 0.8\n)\nobj$n\n#&gt; The required sample size for the given HRs at 80% power\n\n## effect size specification\nthetaD &lt;- seq(0.6, 0.95, by = 0.05) # hazard ratio for death\nthetaH &lt;- seq(0.6, 0.95, by = 0.05) # hazard ratio for hospitalization\n\n## create a matrix \"SS08\" for sample size powered at 80% \n## under each combination of thetaD and thetaH\nmD &lt;- length(thetaD)\nmH &lt;- length(thetaH)\nSS08 &lt;- matrix(NA, mD, mH)\nrownames(SS08) &lt;- thetaD\ncolnames(SS08) &lt;- thetaH\n\n## fill in the computed sample size values\nfor (i in 1:mD) {\n  for (j in 1:mH) {\n    ## sample size under hazard ratios thetaD[i] for death \n    ## and thetaH[j] for hospitalization\n    SS08[i, j] &lt;- WRSS(\n      xi = log(c(thetaD[i], thetaH[j])),\n      bparam = bparam,\n      q = 0.5,\n      alpha = 0.05,\n      power = 0.8\n    )$n\n  }\n}\n## print the calculated sample sizes\nprint(SS08)\n#&gt; Shows how sample size changes under different hazard ratios for death/hosp\n\n## repeating the same calculation for power = 90%\nSS09 &lt;- matrix(NA, mD, mH)\nrownames(SS09) &lt;- thetaD\ncolnames(SS09) &lt; -thetaH  # As in original code; sets the colnames to the sequence of thetaH\n\n## fill in the computed sample size values\nfor (i in 1:mD) {\n  for (j in 1:mH) {\n    ## sample size under hazard ratios thetaD[i] for death \n    ## and thetaH[j] for hospitalization\n    SS09[i, j] &lt;- WRSS(\n      xi = log(c(thetaD[i], thetaH[j])),\n      bparam = bparam,\n      q = 0.5,\n      alpha = 0.05,\n      power = 0.9\n    )$n\n  }\n}\n## print the calculated sample sizes\nprint(SS09)\n#&gt; Sample sizes under 90% power requirements\n\noldpar &lt;- par(mfrow = par(\"mfrow\"))\npar(mfrow = c(1, 2))\n\npersp(\n  thetaD, thetaH, SS08 / 1000,\n  theta = 50, phi = 15, expand = 0.8, col = \"gray\",\n  ltheta = 180, lphi = 180, shade = 0.75,\n  ticktype = \"detailed\",\n  xlab = \"\\n HR on Death\", ylab = \"\\n HR on Hospitalization\",\n  zlab = paste0(\"\\n Sample Size (10e3)\"),\n  main = \"Power = 80%\",\n  zlim = c(0, 26)\n)\n#&gt; 3D perspective plot of sample size (in thousands) for power=80% \n#&gt; over various hazard ratios for death/hosp\n\npersp(\n  thetaD, thetaH, SS09 / 1000,\n  theta = 50, phi = 15, expand = 0.8, col = \"gray\",\n  ltheta = 180, lphi = 180, shade = 0.75,\n  ticktype = \"detailed\",\n  xlab = \"\\nHR on Death\", ylab = \"\\nHR on Hospitalization\",\n  zlab = paste0(\"\\n Sample Size (10e3)\"),\n  main = \"Power = 90%\",\n  zlim = c(0, 26)\n)\n#&gt; Similar 3D perspective for power=90%\n\n\n\\[\\newcommand{\\d}{{\\rm d}}\n\\newcommand{\\T}{{\\rm T}}\n\\newcommand{\\dd}{{\\rm d}}\n\\newcommand{\\cc}{{\\rm c}}\n\\newcommand{\\pr}{{\\rm pr}}\n\\newcommand{\\var}{{\\rm var}}\n\\newcommand{\\se}{{\\rm se}}\n\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\n\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\def\\a{{(a)}}\n\\def\\b{{(1-a)}}\n\\def\\t{{(1)}}\n\\def\\c{{(0)}}\n\\def\\d{{\\rm d}}\n\\def\\T{{\\rm T}}\n\\def\\bs{\\boldsymbol}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "estimation.html#slides",
    "href": "estimation.html#slides",
    "title": "Nonparametric Estimation",
    "section": "",
    "text": "Chapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "estimation.html#r-code",
    "href": "estimation.html#r-code",
    "title": "3  Nonparametric Estimation",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in chapter 3         #\n##################################################################\n\n# install.packages(\"rmt\") # if not already installed\nlibrary(rmt)\nlibrary(tidyverse)\n\n##### Read in HF-ACTION DATA ########\ndata(hfaction)\nhead(hfaction)\n#&gt; Displays the first few rows of the HF-ACTION dataset (patid, time, status, trt_ab)\n\n# TFE: take the first event per patient id\n# TFE = Time to First Event (death or hospitalization)\nhfaction_TFE &lt;- hfaction |&gt;\n  arrange(patid, time) |&gt;\n  group_by(patid) |&gt;\n  slice_head() |&gt;\n  ungroup()\n\n###### Standard RMST analysis #################\nlibrary(survRM2)\n\n# -------------------------------------------------------------------------\n# Mortality analysis\n# -------------------------------------------------------------------------\n\n## get mortality data\nhfaction_D &lt;- hfaction |&gt;\n  filter(status != 1) # remove hospitalization records (status=1)\n\n## RMST (Restricted Mean Survival Time) analysis for overall survival\n# Here we compare arm=1 (training) vs arm=0 (usual care)\nrmst_obj &lt;- rmst2(\n  time    = hfaction_D$time,\n  status  = hfaction_D$status &gt; 0,\n  arm     = hfaction_D$trt_ab,\n  tau     = 3.97\n)\nrmst_obj\n#&gt; Prints estimates of restricted mean survival (in years), differences, ratios, and p-values\n# Between-group contrast \n#                       Est. lower .95 upper .95     p\n# RMST (arm=1)-(arm=0) 0.238     0.013     0.464 0.039\n# RMST (arm=1)/(arm=0) 1.074     1.003     1.150 0.040\n# RMTL (arm=1)/(arm=0) 0.680     0.468     0.988 0.043\n\n# Extract the difference in RMST (in years) and convert to months\nrmst &lt;- rmst_obj$unadjusted.result[1, 1] * 12 \nrmst_p &lt;- rmst_obj$unadjusted.result[1, 4]\n\n# -------------------------------------------------------------------------\n# TFE analysis\n# -------------------------------------------------------------------------\n\n## Check how many of the first events are death (status=1) or hospitalization (status=2)\nhfaction_TFE |&gt;\n  count(status)\n\n## RMST analysis for hospitalization-free survival\nrmest_obj &lt;- rmst2(\n  time    = hfaction_TFE$time,\n  status  = hfaction_TFE$status &gt; 0,\n  arm     = hfaction_TFE$trt_ab,\n  tau     = 3.97\n)\nrmest_obj\n#&gt; Similar output for restricted mean event-free survival\n# Between-group contrast \n#                       Est. lower .95 upper .95     p\n# RMST (arm=1)-(arm=0) 0.198    -0.064     0.459 0.139\n# RMST (arm=1)/(arm=0) 1.145     0.957     1.370 0.139\n# RMTL (arm=1)/(arm=0) 0.924     0.832     1.027 0.141\n\n# Extract the difference in event-free survival (years) and convert to months\nrmest &lt;- rmest_obj$unadjusted.result[1, 1] * 12\nrmest_p &lt;- rmest_obj$unadjusted.result[1, 4]\n\n# -------------------------------------------------------------------------\n# Mortality vs TFE (Kaplan-Meier plots with annotations)\n# -------------------------------------------------------------------------\n\nlibrary(ggsurvfit)\nlibrary(patchwork)\n\n# Plot for overall survival\npD &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_D) |&gt;\n  ggsurvfit(linewidth = 1) +\n  scale_ggsurvfit() +\n  annotate(\n    \"text\", x = 4, y = 1, hjust = 1, vjust = 1,\n    label = str_c(\"4y-RMST = \", round(rmst, 2), \" months\",\n                  \" (P = \", round(rmst_p, 3), \")\")\n  ) +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(y = \"Overall survival\")\n\n# Plot for hospitalization-free survival\npTFE &lt;- survfit2(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE) |&gt;\n  ggsurvfit(linewidth = 1) +\n  annotate(\n    \"text\", x = 4, y = 1, hjust = 1, vjust = 1,\n    label = str_c(\"4y-RMEST = \", round(rmest, 2), \" months\",\n                  \" (P = \", round(rmest_p, 3), \")\")\n  ) +\n  scale_ggsurvfit() +\n  scale_color_discrete(labels = c(\"Usual care\", \"Training\")) +\n  scale_x_continuous(\"Time (years)\", limits = c(0, 4)) +\n  labs(\n    y = \"Hospitalization-free survival\",\n    caption = \"RMEST: restricted mean event-free survival time\"\n  )\n\n# Combine side-by-side\npD + pTFE + plot_layout(guides = \"collect\") &\n  theme(\n    legend.position = \"top\",\n    legend.text = element_text(size = 12)\n  ) \n\n# # ggsave(\"images/est_hfaction_unis.png\", width = 8, height = 4.6)\n#&gt; Uncomment above to save the combined figure\n\n# -------------------------------------------------------------------------\n# RMT-IF analysis\n# -------------------------------------------------------------------------\n\n# rmtfit() from the rmt package fits the restricted mean time lost / \n# time free approach for recurrent events & death\nobj &lt;- rmtfit(rec(patid, time, status) ~ trt_ab, data = hfaction)\n\nsummary(obj, Kmax = 1, tau = 3.97)\n#&gt; Summarizes the model up to a maximum follow-up of 3.97 years, \n#&gt; focusing on the first event (Kmax=1) or aggregated events\n\n#############################################################\n# Graphical analysis of the HF-ACTION trial to\n# evaluate the effect of exercise training.\n###########################################################\n\npar(mfrow = c(1, 2))\n\n# bouquet() displays the \"bouquet plot\" for each k up to Kmax=4\nbouquet(\n  obj, Kmax = 4, cex.group = 1.0,\n  xlab = \"Restricted mean win/loss time (years)\",\n  ylab = \"Follow-up time (years)\",\n  group.label = FALSE, ylim = c(0, 4.2)\n)\ntext(-0.8, 4.15, paste(\"Usual care\"))\ntext(0.8, 4.15, paste(\"Exercise training\"))\n\n# plot() visualizes the RMT-IF difference as a function of time\nplot(\n  obj, conf = TRUE, lwd = 2,\n  xlab = \"Follow-up time (years)\",\n  ylab = \"RMT-IF of training (years)\", \n  main = \"\"\n)\n\npar(mfrow = c(1, 1))\n#&gt; Reset the graphic device to a single panel\n\n### LaTeX table ###\n\npval_fmt3 = function(x) {\n  if (x &lt; 0.001) {\n    return(\"$&lt;$0.001\")\n  } else {\n    return(round(x, 3))\n  }\n}\n\nltable = NULL\n# aggregate the results for k=1,...,K\nhosp_sum = summary(obj, Kmax = 1, tau = 3.97)$tab\n# aggregate the results for k=4,...,K\nall_sum = summary(obj, Kmax = 4, tau = 3.97)$tab\n\nltable = c(\n  \"&\", \"&\", \"&\",\n  round(12 * hosp_sum[1, 1], 2), \"&\", round(12 * hosp_sum[1, 2], 2),\n  \"&\", pval_fmt3(hosp_sum[1, 4]), \"\\\\\"\n)\n\nfor (i in 1:6) {\n  tmp = c(\n    \"&\", i, \"&&\",\n    round(12 * all_sum[i, 1], 2), \"&\", round(12 * all_sum[i, 2], 2),\n    \"&\", pval_fmt3(all_sum[i, 4]), \"\\\\\"\n  )\n  ltable = rbind(ltable, tmp)\n}\n\nltable[5, 2] = \"4+\"\nltable[6:7, 2] = \"\"\n\nrownames(ltable) = c(\"Hopitalization\", \"\", \"\", \"\", \"\", \"Death\", \"Overall\")\n\nnoquote(ltable)\n#&gt; Produces a LaTeX-formatted table summarizing the RMT-IF results\n\n#######################################################################\n#               WA analysis                                           #\n#######################################################################\n\n# install.packages(\"WA\") # if needed\nlibrary(WA)\n\n# load the hf-action study data (already loaded, but repeated here)\nhead(hfaction)\n\n# descriptive analysis\n\n## death & hosp rates by treatment arm\nhfaction |&gt;\n  group_by(trt_ab, patid) |&gt;\n  summarize(\n    ND = sum(status == 2),\n    NH = sum(status == 1)\n  ) |&gt;\n  summarize(\n    death_rate = mean(ND),\n    avgNH = mean(NH),\n    sdNH = sd(NH)\n  )\n\n# weighted while-alive event rate analysis \n# with death weighted as 2 vs 1 for hospitalization\nobj &lt;- LRfit(\n  id = hfaction$patid,\n  time = hfaction$time,\n  status = hfaction$status,\n  trt = hfaction$trt_ab,\n  Dweight = 2\n)\n## print some descriptive information \nobj\n\n## summarize the inference results at tau=4 years\nsummary(obj, tau = 3.97, joint.test = TRUE)\n\nplot(obj)\n#&gt; Plots the Weighted-Alive event rates over time for each arm\n\n# -------------------------------------------------------------------------\n# unadjusted cumulative mean (Ch 1)\n# -------------------------------------------------------------------------\n\n## fit proportional means model with death = 2 x hosp\nlibrary(Wcompo)\n\n## change status coding\nstatus &lt;- hfaction$status\nstatus[status != 0] &lt;- 3 - status[status != 0]\n#&gt; This transforms status=1-&gt;2, status=2-&gt;1, effectively swapping them\n\nobj_ML &lt;- CompoML(\n  hfaction$patid,\n  hfaction$time,\n  status,\n  hfaction$trt_ab,\n  w = c(2, 1)\n)\n## summary results\nt &lt;- obj_ML$t     # time points\nmu0 &lt;- obj_ML$y   # baseline cumulative mean events\nmu1 &lt;- mu0 * exp(as.numeric(obj_ML$beta))\n#&gt; The exponentiated beta shifts the baseline function for the second arm\n\n## plot survival-adjusted cumulative event \n## vs unadjusted under PM model\nplot(\n  obj,\n  ylab = \"Cumulative loss\",\n  xlab = \"Time (years)\"\n)\nlines(\n  t[t &lt;= 3.97], mu0[t &lt;= 3.97],\n  lty = 3, col = \"red\", lwd = 2\n)\nlines(\n  t[t &lt;= 3.97], mu1[t &lt;= 3.97],\n  lty = 3, col = \"blue\", lwd = 2\n)\nlegend(\n  \"bottomright\",\n  col = c(\"red\", \"red\", \"blue\", \"blue\"),\n  c(\"Usual care (WA)\", \"Usual care (unadj)\",\n    \"Training (WA)\", \"Training (unadj)\"),\n  lty = c(1, 3, 1, 3),\n  lwd = 2\n)\n#&gt; Compares Weighted-Alive-based event accumulation with the \"unadjusted\" PM model\n\n\n\\[\\newcommand{\\d}{{\\rm d}}\n\\newcommand{\\T}{{\\rm T}}\n\\newcommand{\\dd}{{\\rm d}}\n\\newcommand{\\cc}{{\\rm c}}\n\\newcommand{\\pr}{{\\rm pr}}\n\\newcommand{\\var}{{\\rm var}}\n\\newcommand{\\se}{{\\rm se}}\n\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\n\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\def\\a{{(a)}}\n\\def\\b{{(1-a)}}\n\\def\\t{{(1)}}\n\\def\\c{{(0)}}\n\\def\\d{{\\rm d}}\n\\def\\T{{\\rm T}}\n\\def\\bs{\\boldsymbol}\n\\]",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "regression.html#slides",
    "href": "regression.html#slides",
    "title": "4  Semiparametric Regression",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "regression.html#r-code",
    "href": "regression.html#r-code",
    "title": "4  Semiparametric Regression",
    "section": "R-code",
    "text": "R-code\n\n\nShow the code\n##################################################################\n# This code generates the numerical results in  chapter 4       ##\n##################################################################\n\n\n# install.packages(\"WR\")\nlibrary(WR)\nlibrary(tidyverse)\nlibrary(knitr) # for formatted table output\n\n\n# load the data\ndata(non_ischemic)\n# head(non_ischemic)\n\n\n\n# Descriptive analysis ----------------------------------------------------\n\n# function to convert 1-0 to Yes-No\none_zero_to_yn &lt;- function(x){\n  if_else(x == 1, \"Yes\", \"No\")\n}\n\n\n# clean up data\ndf &lt;- non_ischemic |&gt; \n  filter(status != 2) |&gt;  # de-duplicate\n  mutate( # clean up the levels of categorical variables\n    trt_ab = fct(if_else(trt_ab == 0, \"Usual care\", \"Training\")),\n    sex = if_else(sex == 1, \"Female\", \"Male\"),\n    race = case_when(\n      Black.vs.White == 1 ~ \"Black\",\n      Other.vs.White == 1 ~ \"Other\",\n      Black.vs.White == 0 & Other.vs.White == 0 ~ \"White\"\n    ),\n    race = fct(race),\n    across(hyperten:smokecurr, one_zero_to_yn)\n  ) \n\n\n## a function to compute median (IQR) for x\n## rounded to the rth decimal place\nmed_iqr &lt;- function(x, r = 1){\n  qt &lt;- quantile(x, na.rm = TRUE)\n  \n  str_c(round(qt[3], r), \" (\", \n        round(qt[2], r), \", \",\n        round(qt[4], r), \")\")\n}\n\n# create summary table for quantitative variables\n# age, size, nodes, prog, estrg\ntab_quant &lt;- df |&gt; \n  group_by(trt_ab) |&gt; \n  summarize(\n    across(c(age, bmi, bipllvef), med_iqr)\n  ) |&gt; \n  pivot_longer( # long format: value = median (IQR); name = variable names\n    !trt_ab,\n    values_to = \"value\",\n    names_to = \"name\"\n  ) |&gt; \n  pivot_wider( # wide format: name = variable names; trt_ab as columns\n    values_from = value,\n    names_from = trt_ab\n  ) |&gt; \n  mutate(\n    name = case_when( # format the variable names\n      name == \"age\" ~ \"Age (years)\",\n      name == \"bmi\" ~ \"BMI\",\n      name == \"bipllvef\" ~ \"LVEF (%)\"\n    )\n  )\n\n\n## a function that computes N (%) for each level of var\n## by group in data frame df (percent rounded to rth point)\nfreq_pct&lt;- function(df, group, var, r = 1){\n  # compute the N for each level of var by group\n  var_counts &lt;- df |&gt; \n    group_by({{ group }}, {{ var }}) |&gt; \n    summarize(\n      n = n(),\n      .groups = \"drop\"\n    ) \n  # compute N (%)\n  var_counts |&gt; \n    left_join( # compute the total number (demoninator) in each group\n      # and joint it back to the numerator\n      var_counts |&gt; group_by({{ group }}) |&gt; summarize(N = sum(n)),\n      by = join_by({{ group }})\n    ) |&gt; \n    mutate( # N (%)\n      value = str_c(n, \" (\", round(100 * n / N, r), \"%)\")\n    ) |&gt; \n    select(- c(n, N)) |&gt; \n    pivot_wider( # put group levels on columns\n      names_from = {{ group }},\n      values_from = value\n    ) |&gt; \n    rename(\n      name = {{ var }} # name = variable names \n    )\n}\n\n# Apply this function to sex, race, hyperten:smokecurr \n  \n# sex\nsex &lt;- df |&gt;\n  freq_pct(trt_ab, sex) |&gt; \n  mutate(\n    name = str_c(\"Sex - \", name)\n  )\n\n# race\nrace &lt;- df |&gt;\n  freq_pct(trt_ab, race) |&gt; \n  mutate(\n    name = str_c(\"Race - \", name)\n  )\n\nhyperten &lt;- df |&gt;\n  freq_pct(trt_ab, hyperten) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Hypertension\"\n  )\n\nhyperten &lt;- df |&gt;\n  freq_pct(trt_ab, hyperten) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Hypertension\"\n  )\n\n\nCOPD &lt;- df |&gt;\n  freq_pct(trt_ab, COPD) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"COPD\"\n)  \n\ndiabetes &lt;- df |&gt;\n  freq_pct(trt_ab, diabetes) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Diabetes\"\n  )  \n\nacei &lt;- df |&gt;\n   freq_pct(trt_ab, acei) |&gt; \n   filter(name == \"Yes\") |&gt; \n   mutate(\n     name = \"ACE Inhibitor\"\n   ) \n   \nbetab &lt;- df |&gt;\n  freq_pct(trt_ab, betab) |&gt; \n  filter(name == \"Yes\") |&gt; \n  mutate(\n    name = \"Beta Blocker\"\n  )     \n\n\nsmokecurr &lt;- df |&gt;\n  freq_pct(trt_ab, betab) |&gt; \n  filter(name == \"smokecurr\") |&gt; \n  mutate(\n    name = \"Smoker\"\n  )     \n\n\ntabone &lt;- bind_rows(\n  tab_quant[1, ],\n  sex, race,\n  tab_quant[2:3, ],\n  hyperten, COPD, diabetes, acei, betab, smokecurr    \n)\n\n\n## add N to group names  \ncolnames(tabone) &lt;- c(\" \", str_c(colnames(tabone)[2:3], \" (N=\", table(df$trt_ab),\")\"))\n## print out the table\nkable(tabone, align = c(\"lcc\"))\n\n\n\n\nTable 4.1: Patient characteristics in non-ischemic cohort of HF-ACTION\n\n\n\nUsual care (N=231)\nTraining (N=220)\n\n\n\n\nAge (years)\n56 (46, 65.5)\n54 (46, 62.2)\n\n\nSex - Female\n153 (66.2%)\n121 (55%)\n\n\nSex - Male\n78 (33.8%)\n99 (45%)\n\n\nRace - White\n117 (50.6%)\n111 (50.5%)\n\n\nRace - Black\n103 (44.6%)\n101 (45.9%)\n\n\nRace - Other\n11 (4.8%)\n8 (3.6%)\n\n\nBMI\n31.3 (26.3, 37.2)\n31 (25.8, 36.5)\n\n\nLVEF (%)\n25.1 (20.9, 31.3)\n25.1 (20.9, 31.2)\n\n\nHypertension\n129 (55.8%)\n129 (58.6%)\n\n\nCOPD\n21 (9.1%)\n15 (6.8%)\n\n\nDiabetes\n71 (30.7%)\n58 (26.4%)\n\n\nACE Inhibitor\n174 (75.3%)\n167 (75.9%)\n\n\nBeta Blocker\n223 (96.5%)\n211 (95.9%)\n\n\n\n\n\n\n\n\nShow the code\n# PW regression analysis --------------------------------------------------\n\n# re-label the covariates with informative names.\n\ncolnames(non_ischemic)[4:16]=c(\n  \"Training vs Usual\",\"Age (year)\",\"Male vs Female\",\"Black vs White\", \n  \"Other vs White\", \"BMI\",\"LVEF\",\"Hypertension\",\"COPD\",\"Diabetes\",\n  \"ACE Inhibitor\",\"Beta Blocker\", \"Smoker\"\n)\n\n\np &lt;- ncol(non_ischemic)-3\n\n# extract ID, time, status and covariates matrix Z from the data.\n# note that: ID, time and status should be column vector\nID &lt;- non_ischemic[,\"ID\"]\ntime &lt;- non_ischemic[,\"time\"] / 30.5 # days to months\nstatus &lt;- non_ischemic[,\"status\"]\nZ &lt;- as.matrix(non_ischemic[,4:(3+p)])\n\n# pass the parameters into the function\nobj &lt;- pwreg(ID, time, status, Z)\nobj\n\n# extract estimates of (beta_4, beta_5)\nbeta &lt;- matrix(obj$beta[4:5])\n# extract estimated covariance matrix for (beta_4, beta_5)\nSigma &lt;- obj$Var[4:5, 4:5]\n# compute chisq statistic in quadratic form\nchistats &lt;- t(beta) %*% solve(Sigma) %*% beta  \n\n# compare the Wald statistic with the reference\n# distribution of chisq(2) to obtain the p-value\n1 - pchisq(chistats, df = 2)\n#&gt;           [,1]\n#&gt; [1,] 0.1016988\n\n\n# compute score processes\nscore_obj &lt;- score.proc(obj)\n# plot scores for all 13 covariates\npar(mfrow = c(4, 4))\nfor(i in c(1:13)){\n  plot(score_obj, k = i, xlab = \"Time (months)\")\n  # add reference lines\n  abline(a = 2, b = 0, lty = 3)\n  abline(a = 0, b = 0, lty = 3)\n  abline(a = - 2, b = 0, lty = 3)\n}\n\n\n### Exercise: Stratify by sex ###\nsex &lt;- Z[, 3]\nZs &lt;- Z[, -3]\nobj_str&lt;-pwreg(ID, time, status, Zs, strata = sex)\nobj_str"
  },
  {
    "objectID": "discussions.html#slides",
    "href": "discussions.html#slides",
    "title": "5  Discussions",
    "section": "Slides",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)"
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Akacha, M., Binkowitz, B., Bretz, F., Fritsch, A., Hougaard, P.,\nJahn-Eimermacher, A., & al., et. (2018). Request for CHMP\nqualification opinion: Clinically interpretable treatment effect\nmeasures based on recurrent event endpoints that allow for efficient\nstatistical analyses. http://www.ema.europa.eu/documents/other/qualification-opinion-treatment-effect-measures-when-using-recurrent-event-endpoints-applicants_en.pdf.\n\n\nAkacha, M., Bretz, F., Ohlssen, D., Rosenkranz, G., & Schmidli, H.\n(2017). Estimands and Their Role in Clinical Trials. Statistics in\nBiopharmaceutical Research, 9(3), 268–271. https://doi.org/10.1080/19466315.2017.1302358\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win\nratio analysis of a composite outcome based on prioritized components.\nBiostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBennett, S. (1983). Analysis of survival data by the proportional odds\nmodel. Statistics in Medicine, 2(2), 273–277. https://doi.org/10.1002/sim.4780020223\n\n\nBrunner, E., Vandemeulebroecke, M., & Mütze, T. (2021). Win odds: An\nadaptation of the win ratio to include ties. Statistics in\nMedicine, 40(14), 3367–3384. https://doi.org/10.1002/sim.8967\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized\noutcomes in the two-sample problem. Statistics in\nMedicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nCHMP. (2020). Qualification opinion of clinically interpretable\ntreatment effect measures based on recurrent event endpoints that allow\nfor efficient statistical analyses. https://www.ema.europa.eu/en/documents/other/qualification-opinion-clinically-interpretable-treatment-effect-measures-based-recurrent-event_en.pdf.\n\n\nCui, Y., & Huang, B. (2023). WINS: The r WINS package. https://CRAN.R-project.org/package=WINS\n\n\nDeltuvaite-Thomas, V., Verbeeck, J., Burzykowski, T., Buyse, M.,\nTournigand, C., Molenberghs, G., & Thas, O. (2022). Generalized\npairwise comparisons for censored data: An overview. Biometrical\nJournal, 65(2). https://doi.org/10.1002/bimj.202100354\n\n\nDong, G., Hoaglin, D. C., Huang, B., Cui, Y., Wang, D., Cheng, Y., &\nGamalo-Siebers, M. (2023). The stratified win statistics (win ratio, win\nodds, and net benefit). Pharmaceutical Statistics,\n22(4), 748–756. https://doi.org/10.1002/pst.2293\n\n\nDong, G., Hoaglin, D. C., Qiu, J., Matsouaka, R. A., Chang, Y.-W., Wang,\nJ., & Vandemeulebroecke, M. (2020). The Win Ratio: On Interpretation\nand Handling of Ties. Statistics in Biopharmaceutical Research,\n12(1), 99–106. https://doi.org/10.1080/19466315.2019.1575279\n\n\nDong, G., Huang, B., Chang, Y.-W., Seifu, Y., Song, J., & Hoaglin,\nD. C. (2020a). The win ratio: Impact of censoring and\nfollow-up time and use with nonproportional hazards.\nPharmaceutical Statistics, 19(3), 168–177. https://doi.org/10.1002/pst.1977\n\n\nDong, G., Huang, B., Verbeeck, J., Cui, Y., Song, J., Gamalo-Siebers,\nM., Wang, D., Hoaglin, D. C., Seifu, Y., Mütze, T., & Kolassa, J.\n(2022). Win statistics (win ratio, win odds, and net benefit) can\ncomplement one another to show the strength of the treatment effect on\ntime-to-event outcomes. Pharmaceutical\nStatistics, 22(1), 20–33. https://doi.org/10.1002/pst.2251\n\n\nDong, G., Huang, B., Wang, D., Verbeeck, J., Wang, J., & Hoaglin, D.\nC. (2021). Adjusting win statistics for dependent censoring.\nPharmaceutical Statistics, 20(3), 440–450. https://doi.org/10.1002/pst.2086\n\n\nDong, G., Li, D., Ballerstedt, S., & Vandemeulebroecke, M. (2016). A\ngeneralized analytic solution to the win ratio to analyze a composite\nendpoint considering the clinical importance order among components.\nPharmaceutical Statistics, 15(5), 430–437. https://doi.org/10.1002/pst.1763\n\n\nDong, G., Mao, L., Huang, B., Gamalo-Siebers, M., Wang, J., Yu, G.,\n& Hoaglin, D. C. (2020b). The inverse-probability-of-censoring\nweighting (IPCW) adjusted win ratio statistic: an unbiased estimator in\nthe presence of independent censoring. Journal of Biopharmaceutical\nStatistics, 30(5), 882–899. https://doi.org/10.1080/10543406.2020.1757692\n\n\nDong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2017). The\nstratified win ratio. Journal of Biopharmaceutical Statistics,\n28(4), 778–796. https://doi.org/10.1080/10543406.2017.1397007\n\n\nEUnetHTA. (2015). Guidance for industry: Multiple endpoints in\nclinical trials. https://www.eunethta.eu/wp-content/uploads/2018/01/Endpoints-used-for-Relative-Effectiveness-Assessment-Composite-endpoints_Amended-JA1-Guideline_Final-Nov-2015_0.pdf\n\n\nFay, M. P., Brittain, E. H., Shih, J. H., Follmann, D. A., &\nGabriel, E. E. (2018). Causal estimands and confidence intervals\nassociated with Wilcoxon-Mann-Whitney tests in\nrandomized experiments. Statistics in Medicine,\n37(20), 2923–2937. https://doi.org/10.1002/sim.7799\n\n\nFDA. (2022). Guidance for industry: Multiple endpoints in clinical\ntrials. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/multiple-endpoints-clinical-trials-guidance-industry\n\n\nFDA. (2023). Guidance document: Adjusting for covariates in\nrandomized clinical trials for drugs and biological products. US\nFood and Drug Adminstration. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/adjusting-covariates-randomized-clinical-trials-drugs-and-biological-products\n\n\nFine, J. P., & Gray, R. J. (1999). A Proportional Hazards Model for\nthe Subdistribution of a Competing Risk. Journal of the American\nStatistical Association, 94(446), 496–509. https://doi.org/10.1080/01621459.1999.10474144\n\n\nFinkelstein, D. M., & Schoenfeld, D. A. (1999). Combining mortality\nand longitudinal measures in clinical trials. Statistics in\nMedicine, 18(11), 1341–1354. https://doi.org/10.1002/(sici)1097-0258(19990615)18:11&lt;1341::aid-sim129&gt;3.0.co;2-7\n\n\nFollmann, D., Fay, M. P., Hamasaki, T., & Evans, S. (2019). Analysis\nof ordered composite endpoints. Statistics in Medicine,\n39(5), 602–616. https://doi.org/10.1002/sim.8431\n\n\nFreemantle, N., Calvert, M., Wood, J., Eastaugh, J., & Griffin, C.\n(2003). Composite Outcomes in Randomized Trials. JAMA,\n289(19), 2554. https://doi.org/10.1001/jama.289.19.2554\n\n\nFritsch, A., Schlömer, P., Mendolia, F., Mütze, T., &\nJahn-Eimermacher, A. (2023). Efficiency Comparison of Analysis Methods\nfor Recurrent Event and Time-to-First Event Endpoints in the Presence of\nTerminal EventsApplication to Clinical Trials in Chronic\nHeart Failure. Statistics in Biopharmaceutical Research,\n15(2), 268–279. https://doi.org/10.1080/19466315.2021.1945488\n\n\nGasparyan, S. B., Folkvaljon, F., Bengtsson, O., Buenconsejo, J., &\nKoch, G. G. (2020). Adjusted win ratio with stratification: Calculation\nmethods and interpretation. Statistical Methods in Medical\nResearch, 30(2), 580–611. https://doi.org/10.1177/0962280220942558\n\n\nGasparyan, S. B., Kowalewski, E. K., Folkvaljon, F., Bengtsson, O.,\nBuenconsejo, J., Adler, J., & Koch, G. G. (2021). Power and sample\nsize calculation for the win odds test: application to an ordinal\nendpoint in COVID-19 trials. Journal of Biopharmaceutical\nStatistics, 31(6), 765–787. https://doi.org/10.1080/10543406.2021.1968893\n\n\nGehan, E. A. (1965). A generalized Wilcoxon test for comparing\narbitrarily singly-censored samples. Biometrika,\n52(1-2), 203–224. https://doi.org/10.1093/biomet/52.1-2.203\n\n\nGhosh, D., & Lin, D. Y. (2000). Nonparametric Analysis of Recurrent\nEvents and Death. Biometrics, 56(2), 554–562. https://doi.org/10.1111/j.0006-341x.2000.00554.x\n\n\nGray, R. J. (1988). A class of K-sample tests for comparing the\ncumulative incidence of a competing risk. The Annals of\nStatistics, 16(3). https://doi.org/10.1214/aos/1176350951\n\n\nICH. (1998). Statistical principles for clinical trials.\nLondon: European Medicines Evaluation Agency.\n\n\nICH. (2020). ICH E9 (R1) addendum on estimands and sensitivity\nanalysis in clinical trials to the guideline on statistical principles\nfor clinical trials, step 5. London: European Medicines Evaluation\nAgency.\n\n\nIonan, A. C., Paterniti, M., Mehrotra, D. V., Scott, J., Ratitch, B.,\nCollins, S., Gomatam, S., Nie, L., Rufibach, K., & Bretz, F. (2022).\nClinical and Statistical Perspectives on the ICH E9(R1) Estimand\nFramework Implementation. Statistics in Biopharmaceutical\nResearch, 15(3), 554–559. https://doi.org/10.1080/19466315.2022.2081601\n\n\nLi, H., Chen, W.-C., Lu, N., Tang, R., & Zhao, Y. (2024). The\nelusiveness of the win ratio parameter in the presence of missing data.\nTherapeutic Innovation & Regulatory Science, 1–2.\n\n\nLin, D. Y., Wei, L. J., & Ying, Z. (1993). Checking the Cox model\nwith cumulative sums of martingale-based residuals. Biometrika,\n80(3), 557–572. https://doi.org/10.1093/biomet/80.3.557\n\n\nLu, Y., & Tian, L. (2021). Statistical Considerations for Sequential\nAnalysis of the Restricted Mean Survival Time for Randomized Clinical\nTrials. Statistics in Biopharmaceutical Research,\n13(2), 210–218. https://doi.org/10.1080/19466315.2020.1816491\n\n\nLuo, X., Huang, B., & Quan, H. (2019). Design and monitoring of\nsurvival trials based on restricted mean survival times. Clinical\nTrials, 16(6), 616–625. https://doi.org/10.1177/1740774519871447\n\n\nLuo, X., Qiu, J., Bai, S., & Tian, H. (2017). Weighted win loss\napproach for analyzing prioritized outcomes. Statistics in\nMedicine, 36(15), 2452–2465. https://doi.org/10.1002/sim.7284\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative\nApproach to Confidence Interval Estimation for the Win Ratio Statistic.\nBiometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2018). On causal estimation using U-statistics. Biometrika,\n105(1), 215–220. https://doi.org/10.1093/biomet/asx071\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio.\nBiometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L. (2023a). Nonparametric Inference of General While-Alive\nEstimands for Recurrent Events. Biometrics, 79(3),\n1749–1760. https://doi.org/10.1111/biom.13709\n\n\nMao, L. (2023b). On restricted mean time in favor of treatment.\nBiometrics, 79(1), 61–72. https://doi.org/10.1111/biom.13570\n\n\nMao, L. (2023c). Power and Sample Size Calculations for the Restricted\nMean Time Analysis of Prioritized Composite Endpoints. Statistics in\nBiopharmaceutical Research, 15(3), 540–548. https://doi.org/10.1080/19466315.2022.2110936\n\n\nMao, L. (2023d). Study Design for Restricted Mean Time Analysis of\nRecurrent Events and Death. Biometrics, 79(4),\n3701–3714. https://doi.org/10.1111/biom.13923\n\n\nMao, L. (2024). Defining estimand for the win ratio: separate the true\neffect from censoring. Clinical Trials, In press.\n\n\nMao, L., & Kim, K. (2021). Statistical Models for Composite\nEndpoints of Death and Nonfatal Events: A Review. Statistics in\nBiopharmaceutical Research, 13(3), 260–269. https://doi.org/10.1080/19466315.2021.1927824\n\n\nMao, L., Kim, K., & Li, Y. (2022). On recurrent-event win ratio.\nStatistical Methods in Medical Research, 31(6),\n1120–1134. https://doi.org/10.1177/09622802221084134\n\n\nMao, L., Kim, K., & Miao, X. (2022). Sample size formula for general\nwin ratio analysis. Biometrics, 78(3), 1257–1268. https://doi.org/10.1111/biom.13501\n\n\nMao, L., & Lin, D. Y. (2016). Semiparametric regression for the\nweighted composite endpoint of recurrent and terminal events.\nBiostatistics, 17(2), 390–403. https://doi.org/10.1093/biostatistics/kxv050\n\n\nMao, L., & Wang, T. (2021). A class of proportional\nwin-fractions regression models for composite outcomes.\nBiometrics, 77(4), 1265–1275. https://doi.org/10.1111/biom.13382\n\n\nMao, L., & Wang, T. (2024). Dissecting the restricted mean time in\nfavor of treatment. Journal of Biopharmaceutical Statistics,\n34(1), 111–126. https://doi.org/10.1080/10543406.2023.2210658\n\n\nMoertel, C. G., Fleming, T. R., Macdonald, J. S., Haller, D. G., Laurie,\nJ. A., Goodman, P. J., Ungerleider, J. S., Emerson, W. A., Tormey, D.\nC., Glick, J. H., Veeder, M. H., & Mailliard, J. A. (1990).\nLevamisole and Fluorouracil for Adjuvant Therapy of Resected Colon\nCarcinoma. New England Journal of Medicine, 322(6),\n352–358. https://doi.org/10.1056/nejm199002083220602\n\n\nMurphy, S. A., Rossini, A. J., & Vaart, A. W. van der. (1997).\nMaximum Likelihood Estimation in the Proportional Odds Model.\nJournal of the American Statistical Association,\n92(439), 968–976. https://doi.org/10.1080/01621459.1997.10474051\n\n\nO’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L.\nS., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W.,\nBlumenthal, J. A., Rendall, D. S., Miller, N. H., Fleg, J. L., Schulman,\nK. A., McKelvie, R. S., Zannad, F., Piña, I. L., & HF-ACTION\nInvestigators, for the. (2009). Efficacy and Safety of Exercise Training\nin Patients With Chronic Heart Failure. JAMA, 301(14),\n1439. https://doi.org/10.1001/jama.2009.454\n\n\nOakes, D. (1989). Bivariate Survival Models Induced by Frailties.\nJournal of the American Statistical Association,\n84(406), 487–493. https://doi.org/10.1080/01621459.1989.10478795\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with\nmultiple types of event. Biometrika, 103(3), 742–745.\nhttps://doi.org/10.1093/biomet/asw026\n\n\nPéron, J., Buyse, M., Ozenne, B., Roche, L., & Roy, P. (2016). An\nextension of generalized pairwise comparisons for prioritized outcomes\nin the presence of censoring. Statistical Methods in Medical\nResearch, 27(4), 1230–1239. https://doi.org/10.1177/0962280216658320\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The\nwin ratio: a new approach to the analysis of composite endpoints in\nclinical trials based on clinical priorities. European Heart\nJournal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nQu, Y., & Lipkovich, I. (2021). Implementation of ICH E9 (R1): A Few\nPoints Learned During the COVID-19 Pandemic. Therapeutic Innovation\n& Regulatory Science, 55(5), 984–988. https://doi.org/10.1007/s43441-021-00297-6\n\n\nRatitch, B., Bell, J., Mallinckrodt, C., Bartlett, J. W., Goel, N.,\nMolenberghs, G., O’Kelly, M., Singh, P., & Lipkovich, I. (2020).\nChoosing Estimands in Clinical Trials: Putting the ICH E9(R1) Into\nPractice. Therapeutic Innovation & Regulatory Science,\n54(2), 324–341. https://doi.org/10.1007/s43441-019-00061-x\n\n\nRedfors, B., Gregson, J., Crowley, A., McAndrew, T., Ben-Yehuda, O.,\nStone, G. W., & Pocock, S. J. (2020). The win ratio approach for\ncomposite endpoints: practical guidance based on previous experience.\nEuropean Heart Journal, 41(46), 4391–4399. https://doi.org/10.1093/eurheartj/ehaa665\n\n\nRoyston, P., & Parmar, M. K. B. (2011). The use of restricted mean\nsurvival time to estimate the treatment effect in randomized clinical\ntrials when the proportional hazards assumption is in doubt.\nStatistics in Medicine, 30(19), 2409–2421. https://doi.org/10.1002/sim.4274\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023a). Estimands for\nRecurrent Event Endpoints in the Presence of a Terminal Event.\nStatistics in Biopharmaceutical Research, 15(2),\n238–248. https://doi.org/10.1080/19466315.2021.1895883\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023b). Rejoinder to\nCommentaries on “Estimands for Recurrent Event Endpoints in\nthe Presence of a Terminal Event”. Statistics in\nBiopharmaceutical Research, 15(2), 255–256. https://doi.org/10.1080/19466315.2023.2166098\n\n\nSeifu, Y., Mt-Isa, S., Duke, K., Gamalo-Siebers, M., Wang, W., Dong, G.,\n& Kolassa, J. (2022). Design of paediatric trials with benefit-risk\nendpoints using a composite score of adverse events of interest (AEI)\nand win-statistics. Journal of Biopharmaceutical Statistics,\n33(6), 696–707. https://doi.org/10.1080/10543406.2022.2153202\n\n\nSong, J., Verbeeck, J., Huang, B., Hoaglin, D. C., Gamalo-Siebers, M.,\nSeifu, Y., Wang, D., Cooner, F., & Dong, G. (2022). The win odds:\nstatistical inference and regression. Journal of Biopharmaceutical\nStatistics, 33(2), 140–150. https://doi.org/10.1080/10543406.2022.2089156\n\n\nTian, L., Jin, H., Uno, H., Lu, Y., Huang, B., Anderson, K. M., &\nWei, L. (2020). On the empirical choice of the time window for\nrestricted mean survival time. Biometrics, 76(4),\n1157–1166. https://doi.org/10.1111/biom.13237\n\n\nTroendle, J. F., Leifer, E. S., Yang, S., Jeffries, N., Kim, D.-Y., Joo,\nJ., & O’Connor, C. M. (2024). Use of win time for ordered composite\nendpoints in clinical trials. Statistics in Medicine,\n43(10), 1920–1932. https://doi.org/10.1002/sim.10045\n\n\nTsiatis, A. A., Davidian, M., Zhang, M., & Lu, X. (2008). Covariate\nadjustment for two-sample treatment comparisons in\nrandomized clinical trials: A principled yet flexible approach.\nStatistics in Medicine, 27(23), 4658–4677. https://doi.org/10.1002/sim.3113\n\n\nUno, H., & Horiguchi, M. (2023). Ratio and difference of average\nhazard with survival weight: New measures to quantify survival benefit\nof new therapy. Statistics in Medicine, 42(7),\n936–952. https://doi.org/10.1002/sim.9651\n\n\nVerbeeck, J., De Backer, M., Verwerft, J., Salvaggio, S., Valgimigli,\nM., Vranckx, P., Buyse, M., & Brunner, E. (2023). Generalized\nPairwise Comparisons to Assess Treatment Effects. Journal of the\nAmerican College of Cardiology, 82(13), 1360–1372. https://doi.org/10.1016/j.jacc.2023.06.047\n\n\nWang, B., Susukida, R., Mojtabai, R., Amin-Esmaeili, M., &\nRosenblum, M. (2021). Model-Robust Inference for Clinical Trials that\nImprove Precision by Stratified Randomization and Covariate Adjustment.\nJournal of the American Statistical Association,\n118(542), 1152–1163. https://doi.org/10.1080/01621459.2021.1981338\n\n\nWang, B., Zhou, D., Zhang, J., Kim, Y., Chen, L.-W., Dunnmon, P., Bai,\nS., Liu, Q., & Ishida, E. (2023). Statistical power considerations\nin the use of win ratio in cardiovascular outcome trials.\nContemporary Clinical Trials, 124, 107040. https://doi.org/10.1016/j.cct.2022.107040\n\n\nWang, T., Li, Y., & Qu, Y. (2024). Restricted time win ratio: from\nestimands to estimation. Statistics in Biopharmaceutical\nResearch, 1–18. https://doi.org/10.1080/19466315.2024.2332675\n\n\nWang, T., & Mao, L. (2022). Stratified proportional\nwin-fractions regression analysis. Statistics in\nMedicine, 41(26), 5305–5318. https://doi.org/10.1002/sim.9570\n\n\nWang, T., Zilinskas, R., Li, Y., & Qu, Y. (2023). Missing Data\nImputation for a Multivariate Outcome of Mixed Variable Types.\nStatistics in Biopharmaceutical Research, 15(4),\n826–837. https://doi.org/10.1080/19466315.2023.2169753\n\n\nWei, J., Mütze, T., Jahn-Eimermacher, A., & Roger, J. (2023).\nProperties of Two While-Alive Estimands for Recurrent Events and Their\nPotential Estimators. Statistics in Biopharmaceutical Research,\n15(2), 257–267. https://doi.org/10.1080/19466315.2021.1994457\n\n\nWu, P., Han, Y., Chen, T., & Tu, X. M. (2013). Causal inference for\nMann-Whitney-Wilcoxon rank sum and other nonparametric statistics.\nStatistics in Medicine, 33(8), 1261–1271. https://doi.org/10.1002/sim.6026\n\n\nYang, S., & Troendle, J. (2020). Event-specific win ratios and\ntesting with terminal and non-terminal events. Clinical Trials,\n18(2), 180–187. https://doi.org/10.1177/1740774520972408\n\n\nYang, S., Troendle, J., Pak, D., & Leifer, E. (2022).\nEvent-specific win ratios for inference with terminal and\nnon-terminal events. Statistics in Medicine,\n41(7), 1225–1241. https://doi.org/10.1002/sim.9266\n\n\nYe, T., Shao, J., Yi, Y., & Zhao, Q. (2023). Toward Better Practice\nof Covariate Adjustment in Analyzing Randomized Clinical Trials.\nJournal of the American Statistical Association,\n118(544), 2370–2382. https://doi.org/10.1080/01621459.2022.2049278\n\n\nYu, R. X., & Ganju, J. (2022). Sample size formula for a win ratio\nendpoint. Statistics in Medicine, 41(6), 950–963. https://doi.org/10.1002/sim.9297\n\n\nZhou, T. J., LaValley, M. P., Nelson, K. P., Cabral, H. J., &\nMassaro, J. M. (2022). Calculating power for the Finkelstein and\nSchoenfeld test statistic for a composite endpoint with two components.\nStatistics in Medicine, 41(17), 3321–3335. https://doi.org/10.1002/sim.9419\n\n\nZinman, B., Wanner, C., Lachin, J. M., Fitchett, D., Bluhmki, E.,\nHantel, S., Mattheus, M., Devins, T., Johansen, O. E., Woerle, H. J.,\nBroedl, U. C., & Inzucchi, S. E. (2015). Empagliflozin,\nCardiovascular Outcomes, and Mortality in Type 2 Diabetes. New\nEngland Journal of Medicine, 373(22), 2117–2128. https://doi.org/10.1056/nejmoa1504720"
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#chapter-summary",
    "href": "intro.html#chapter-summary",
    "title": "1  Introduction",
    "section": "1.1 Chapter Summary",
    "text": "1.1 Chapter Summary\n\n1.1.1 Motivating Examples\nIn trials where patients may experience both fatal and nonfatal events, time-to-first-event analyses can obscure clinically meaningful treatment effects. For instance, in a colon cancer trial of 619 patients, relapse-free survival was used as the primary endpoint. Although the treatment significantly delayed relapse (log-rank \\(p &lt; 0.001\\)), 89% of deaths occurred after relapse and were ignored in the analysis.\nSimilarly, in the HF-ACTION trial of heart failure patients, a composite of death and hospitalization failed to show a statistically significant benefit (log-rank \\(p = 0.10\\)), even though 88% of patients died and 69% had recurrent hospitalizations. By equating hospitalization with death and counting only the first event, the analysis diluted the observed mortality effect.\nThese examples highlight the limitations of standard composite endpoints and motivate approaches that account for the clinical hierarchy and full event history.\n\n\n1.1.2 Composite Endpoints and Guidelines\nComposite endpoints increase statistical power by aggregating different event types, reducing the need for multiple testing and improving trial efficiency. However, their validity hinges on appropriate construction and interpretation.\nRegulatory guidelines provide direction:\n\nICH E9 recommends using a single primary variable or a composite when individual outcomes cannot capture the treatment effect.\nFDA allows time-to-first or total-event analysis but emphasizes component-wise interpretation.\nEuropean HTA bodies advise combining outcomes of similar severity and always including mortality when relevant, especially if it censors other outcomes.\n\nThese guidelines support the use of composite endpoints while cautioning against misinterpretation.\n\n\n1.1.3 Traditional Composite Methods\nLet \\(\\mathcal{H}^*(t)\\) denote the cumulative history of death and \\(K\\) nonfatal events up to time \\(t\\).\n\n1.1.3.1 Time to First Event\nThe standard approach defines: \\[\nN^*_{\\text{TFE}}(t) = I\\left\\{ N_D^*(t) + \\sum_{k=1}^K N_k^*(t) \\geq 1 \\right\\},\n\\] where \\(N_D^*(t)\\) and \\(N_k^*(t)\\) are counting processes for death and nonfatal event \\(k\\), respectively. This method reduces all outcome complexity to a single event time, analyzed via Kaplan–Meier, log-rank, or Cox models.\n\n\n1.1.3.2 Weighted Total Events\nTo incorporate more information, the total number of events can be weighted: \\[\nN^*_{\\text{R}}(t) = w_D N_D^*(t) + \\sum_{k=1}^K w_k N_k^*(t),\n\\] with \\(w_D, w_k\\) representing clinical importance. Estimation is performed under a proportional means model: \\[\nE\\{ N^*_{\\text{R}}(t) \\mid Z \\} = \\exp(\\beta^\\mathrm{T} Z) \\mu_0(t).\n\\]\nThe Wcompo R package provides tools for this approach via the CompoML() function.\n\n\n\n1.1.4 HF-ACTION Revisited\nIn the HF-ACTION trial, separate analyses illustrate the limitations of standard methods:\n\nCox model for death showed a 32.8% risk reduction (HR = 0.672, \\(p = 0.062\\)).\nCox model for TFE (death or first hospitalization) showed only a 16.2% reduction (HR = 0.838, \\(p = 0.111\\)).\nWeighted total events (death weighted twice) estimated a 14.3% reduction in event burden, but the \\(p\\)-value was still nonsignificant.\n\nThese results demonstrate how frequent nonfatal events can mask treatment benefits on mortality, particularly in analyses that do not prioritize outcome severity or account for survival time.\n\n\n1.1.5 Win Ratio and Hierarchical Approaches\nThe win ratio (WR) offers a solution by comparing patient pairs across treatment arms. Each pair is evaluated hierarchically:\n\nLonger survival indicates a win.\nIf both survive, fewer or later nonfatal events confer a win.\nIf tied, functional outcomes may be compared.\n\nThe win ratio is defined as: \\[\n\\widehat{\\text{WR}} = \\frac{\\text{\\# of treatment wins}}{\\text{\\# of control wins}}.\n\\]\nAlternative metrics include:\n\nNet benefit (PIF): wins minus losses.\nWin odds (WO): accounts for ties: \\[\n\\text{WO} = \\frac{\\text{wins} + \\frac{1}{2} \\text{ties}}{\\text{losses} + \\frac{1}{2} \\text{ties}}.\n\\]\n\nThese measures align with clinical priorities and are increasingly used in practice.\n\n\n1.1.6 Estimand Challenges\nA critical limitation of the win ratio is its dependency on censoring. Because patients may be censored at different times, the win/loss status of a pair can change over time. The observed win ratio thus reflects an average over the censoring distribution, not a fixed population quantity.\nThis raises concerns for interpretation and estimation:\n\nTesting remains valid under the null hypothesis, especially if the treatment consistently outperforms control.\nEstimation, however, is biased unless a fixed follow-up time is defined or a model constrains the win ratio to be constant over time.\n\nThe ICH E9 (R1) addendum emphasizes that a clearly defined estimand is essential for interpreting treatment effects. For the win ratio, this requires careful attention to follow-up duration and censoring.\n\n\n1.1.7 Toward Model-Based Estimands\nLimitations of traditional and empirical approaches motivate model-based alternatives: - The restricted mean time in favor (RMT-IF) quantifies the net amount of time one group remains in a more favorable state. - The proportional win-fractions (PW) model expresses the win ratio as a function of covariates, enabling estimation of treatment effects under a semiparametric framework.\nBoth methods respect clinical hierarchies and avoid dependence on arbitrary censoring patterns. They form the foundation of the methods introduced in subsequent chapters.\n\n\n\n1.1.8 Example R code\n\n########################################\n# 1. Proportional means model using Wcompo\n########################################\nlibrary(Wcompo)\nobj &lt;- CompoML(id, time, status, Z, w = c(2, 1))\nsummary(obj)\nplot(obj)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#motivating-examples",
    "href": "intro.html#motivating-examples",
    "title": "1  Introduction",
    "section": "1.1 Motivating Examples",
    "text": "1.1 Motivating Examples\nIn trials where patients may experience both fatal and nonfatal events, time-to-first-event analyses can obscure clinically meaningful treatment effects. For instance, in a colon cancer trial of 619 patients, relapse-free survival was used as the primary endpoint. Although the treatment significantly delayed relapse (log-rank \\(p &lt; 0.001\\)), 89% of deaths occurred after relapse and were ignored in the analysis.\n\n\n\n\n\nSimilarly, in the HF-ACTION trial of heart failure patients, a composite of death and hospitalization failed to show a statistically significant benefit (log-rank \\(p = 0.10\\)), even though 88% of patients died and 69% had recurrent hospitalizations. By equating hospitalization with death and counting only the first event, the analysis diluted the observed mortality effect.\n\n\n\n\n\nThese examples highlight the limitations of standard composite endpoints and motivate approaches that account for the clinical hierarchy and full event history.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#composite-endpoints-and-guidelines",
    "href": "intro.html#composite-endpoints-and-guidelines",
    "title": "1  Introduction",
    "section": "1.2 Composite Endpoints and Guidelines",
    "text": "1.2 Composite Endpoints and Guidelines\nComposite endpoints increase statistical power by aggregating different event types, reducing the need for multiple testing and improving trial efficiency. However, their validity hinges on appropriate construction and interpretation.\nRegulatory guidelines provide direction:\n\nICH E9 recommends using a single primary variable or a composite when individual outcomes cannot capture the treatment effect.\nFDA allows time-to-first or total-event analysis but emphasizes component-wise interpretation.\nEuropean HTA bodies advise combining outcomes of similar severity and always including mortality when relevant, especially if it censors other outcomes.\n\nThese guidelines support the use of composite endpoints while cautioning against misinterpretation.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#traditional-composite-methods",
    "href": "intro.html#traditional-composite-methods",
    "title": "1  Introduction",
    "section": "1.3 Traditional Composite Methods",
    "text": "1.3 Traditional Composite Methods\nLet \\(\\mathcal{H}^*(t)\\) denote the cumulative history of death and \\(K\\) nonfatal events up to time \\(t\\).\n\n1.3.1 Time to First Event\nThe standard approach defines: \\[\nN^*_{\\text{TFE}}(t) = I\\left\\{ N_D^*(t) + \\sum_{k=1}^K N_k^*(t) \\geq 1 \\right\\},\n\\] where \\(N_D^*(t)\\) and \\(N_k^*(t)\\) are counting processes for death and nonfatal event \\(k\\), respectively. This method reduces all outcome complexity to a single event time, analyzed via Kaplan–Meier, log-rank, or Cox models.\n\n\n1.3.2 Weighted Total Events\nTo incorporate more information, the total number of events can be weighted: \\[\nN^*_{\\text{R}}(t) = w_D N_D^*(t) + \\sum_{k=1}^K w_k N_k^*(t),\n\\] with \\(w_D, w_k\\) representing clinical importance. Estimation is performed under a proportional means model: \\[\nE\\{ N^*_{\\text{R}}(t) \\mid Z \\} = \\exp(\\beta^\\mathrm{T} Z) \\mu_0(t).\n\\]\nThe Wcompo R package provides tools for this approach via the CompoML() function.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#hf-action-revisited",
    "href": "intro.html#hf-action-revisited",
    "title": "1  Introduction",
    "section": "1.4 HF-ACTION Revisited",
    "text": "1.4 HF-ACTION Revisited\nIn the HF-ACTION trial, separate analyses illustrate the limitations of standard methods:\n\nCox model for death showed a 32.8% risk reduction (HR = 0.672, p = 0.062).\nCox model for TFE (death or first hospitalization) showed only a 16.2% reduction (HR = 0.838, p = 0.111).\nWeighted total events (death weighted twice) estimated a 14.3% reduction in event burden, but the p-value was still nonsignificant.\n\nThese results demonstrate how frequent nonfatal events can mask treatment benefits on mortality, particularly in analyses that do not prioritize outcome severity or account for survival time.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#win-ratio-and-hierarchical-approaches",
    "href": "intro.html#win-ratio-and-hierarchical-approaches",
    "title": "1  Introduction",
    "section": "1.5 Win Ratio and Hierarchical Approaches",
    "text": "1.5 Win Ratio and Hierarchical Approaches\nThe win ratio (WR) offers a solution by comparing patient pairs across treatment arms. Each pair is evaluated hierarchically:\n\nLonger survival indicates a win.\nIf both survive, fewer or later nonfatal events confer a win.\nIf tied, functional outcomes may be compared.\n\nThe win ratio is defined as: \\[\n\\widehat{\\text{WR}} = \\frac{\\text{\\# of treatment wins}}{\\text{\\# of control wins}}.\n\\]\nAlternative metrics include:\n\nNet benefit (PIF): wins minus losses.\nWin odds (WO): accounts for ties: \\[\n\\text{WO} = \\frac{\\text{wins} + 2^{-1} \\text{ties}}{\\text{losses} + 2^{-1} \\text{ties}}.\n\\]\n\nThese measures align with clinical priorities and are increasingly used in practice.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#estimand-challenges",
    "href": "intro.html#estimand-challenges",
    "title": "1  Introduction",
    "section": "1.6 Estimand Challenges",
    "text": "1.6 Estimand Challenges\nA critical limitation of the win ratio is its dependency on censoring. Because patients may be censored at different times, the win/loss status of a pair can change over time. The observed win ratio thus reflects an average over the censoring distribution, not a fixed population quantity.\n\n\n\n\n\nThis raises concerns for interpretation and estimation:\n\nTesting remains valid under the null hypothesis, especially if the treatment consistently outperforms control.\nEstimation, however, is biased unless a fixed follow-up time is defined or a model constrains the win ratio to be constant over time.\n\nThe ICH E9 (R1) addendum emphasizes that a clearly defined estimand is essential for interpreting treatment effects. For the win ratio, this requires careful attention to follow-up duration and censoring.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#toward-model-based-estimands",
    "href": "intro.html#toward-model-based-estimands",
    "title": "1  Introduction",
    "section": "1.7 Toward Model-Based Estimands",
    "text": "1.7 Toward Model-Based Estimands\nLimitations of traditional and empirical approaches motivate model-based alternatives:\n\nThe restricted mean time in favor (RMT-IF) quantifies the net amount of time one group remains in a more favorable state.\nThe proportional win-fractions (PW) model expresses the win ratio as a function of covariates, enabling estimation of treatment effects under a semiparametric framework.\n\nBoth methods respect clinical hierarchies and avoid dependence on arbitrary censoring patterns. They form the foundation of the methods introduced in subsequent chapters.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#example-r-code",
    "href": "intro.html#example-r-code",
    "title": "1  Introduction",
    "section": "1.8 Example R code",
    "text": "1.8 Example R code\nThe following example assumes a data frame df in long format, with columns:\n\nid: subject identifier\n\ntime: event or censoring time\n\nstatus: event type (0 = censoring, 1 = death, 2 = nonfatal)\n\ntrt: treatment group (0 = control, 1 = treatment)\n\n\n########################################\n# 1. Prepare data for survival analyses\n########################################\nlibrary(dplyr)\n# For time-to-death analysis: remove nonfatal events\ndf_death &lt;- df |&gt; \n  filter(status != 2)\n# For time-to-first-event (TFE): take earliest record per subject\ndf_tfe &lt;- df |&gt;\n  arrange(id, time) |&gt;\n  group_by(id) |&gt;\n  slice_head() |&gt;\n  ungroup()\n\n########################################\n# 2. Cox models for death and TFE\n########################################\nlibrary(survival)\n# Time to death\ncox_death &lt;- coxph(Surv(time, status == 1) ~ trt, data = df_death)\n# Time to first event (death or nonfatal)\ncox_tfe &lt;- coxph(Surv(time, status &gt; 0) ~ trt, data = df_tfe)\n\n########################################\n# 3. Weighted total events analysis\n########################################\nlibrary(Wcompo)\n# Weighting: death:nonfatal = 2:1\nfit_wte &lt;- CompoML(id, time, status, Z = trt, data = df, w = c(2, 1))",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "chap1.html#outline",
    "href": "chap1.html#outline",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Outline",
    "text": "Outline\n\nExamples and regulatory guidelines\nTraditional methods\n\nTime to first event\nWeighted total events (Wcompo package)\n\nWin ratio and hierarchical endpoints\n\nThe estimand issue\n\n\n\\[\\newcommand{\\d}{{\\rm d}}\\] \\[\\newcommand{\\T}{{\\rm T}}\\] \\[\\newcommand{\\dd}{{\\rm d}}\\] \\[\\newcommand{\\cc}{{\\rm c}}\\] \\[\\newcommand{\\pr}{{\\rm pr}}\\] \\[\\newcommand{\\var}{{\\rm var}}\\] \\[\\newcommand{\\se}{{\\rm se}}\\] \\[\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\\] \\[\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\\] \\[\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\] \\[\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\] \\[ \\def\\a{{(a)}} \\def\\b{{(1-a)}} \\def\\t{{(1)}} \\def\\c{{(0)}} \\def\\d{{\\rm d}} \\def\\T{{\\rm T}}\n\\]"
  },
  {
    "objectID": "chap1.html#motivating-example-colon-cancer",
    "href": "chap1.html#motivating-example-colon-cancer",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Motivating Example: Colon Cancer",
    "text": "Motivating Example: Colon Cancer\n\n\nLandmark colon cancer trial\n\nPopulation: 619 patients with stage C disease (Moertel et al., 1990)\nArms: Levamisole + fluorouracil (\\(n=304\\)) vs control (\\(n=315\\))\nEndpoint: relapse-free survival (log-rank test p&lt;0.001)\n\nDeath = Relapse\n258 deaths (89%) after relapse ignored"
  },
  {
    "objectID": "chap1.html#motivating-example-hf-action",
    "href": "chap1.html#motivating-example-hf-action",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Motivating Example: HF-ACTION",
    "text": "Motivating Example: HF-ACTION\n\n\nA cardiovascular trial (HF-ACTION)\n\nSubpopulation: 426 heart failure patients (O’Connor et al., 2009)\nArms: Exercise training + usual care (\\(n=205\\)) vs usual care (\\(n=221\\))\nEndpoint: hospitalization-free survival (log-rank test p=0.100)\n\nDeath = Hospitalization\n82 (88%) deaths + 707 (69%) recurrent hospitalizations ignored"
  },
  {
    "objectID": "chap1.html#composite-endpoints",
    "href": "chap1.html#composite-endpoints",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Composite Endpoints",
    "text": "Composite Endpoints\n\n\nTraditional composite endpoint (TCE)\n\nTime to first event\n\nRelapse/Progression-free survival\nFirst major adverse cardiac event (MACE): death, heart failure, myocardio-infarction, stroke (event-free survival)\n\nLimitations\n\nLack of clinical priority\nStatistical inefficiency (waste of data)\n\n\n\n\n\n\nHierarchical composite endpoint (HCE)\n\nExample: Death &gt; nonfatal MACE &gt; six-minute walk test (6MWT)/NYHA class"
  },
  {
    "objectID": "chap1.html#why-composite",
    "href": "chap1.html#why-composite",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Why Composite",
    "text": "Why Composite\n\n\nAdvantages\n\nMore events \\(\\to\\) higher power \\(\\to\\) smaller sample size/lower costs\nNo need for multiplicity adjustment\nA unified measure of treatment effect\n\n\n\n\n\n\n\nICH-E9 “Statistical Principles for Clinical Trials” (ICH, 1998)\n\n\n\n“There should generally be only one primary variable”\n“If a single primary variable cannot be selected …, another useful strategy is to integrate or combine the multiple measurements into a single or composite variable …”\n“[composite endpoint] addresses the multiplicity problem without adjustment to the type I error”"
  },
  {
    "objectID": "chap1.html#regulatory-guidelines-fda",
    "href": "chap1.html#regulatory-guidelines-fda",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Regulatory Guidelines: FDA",
    "text": "Regulatory Guidelines: FDA\n\n\nMain points\n\nTypically first event but can do total events\nComponent-wise analysis important for interpretation\n\n\n\n\n\n\n\nFDA Guidance for Industry: “Multiple Endpoints in Clinical Trials” (FDA, 2022)\n\n\n\n“Composite endpoints are often assessed as the time to first occurrence of any one of the components, …, it also may be possible to analyze total endpoint events”\n“The treatment effect on the composite rate can be interpreted as characterizing the overall clinical effect when the individual events all have reasonably similar clinical importance”\n“…analyses of the components of the composite endpoint are important and can influence interpretation of the overall study results”"
  },
  {
    "objectID": "chap1.html#regulatory-guidelines-europe",
    "href": "chap1.html#regulatory-guidelines-europe",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Regulatory Guidelines: Europe",
    "text": "Regulatory Guidelines: Europe\n\n\nMain points\n\nCombine events of similar importance\nInclude mortality as a component\n\n\n\n\n\n\n\nEuropean Network for Health Technology Assessment “Endpoints used for Relative Effectiveness Assessment – Composite Endpoints” (EUnetHTA, 2015)\n\n\n\n“All components of a composite endpoint should be separately defined as secondary endpoints and reported with the results of the primary analysis”\n“Components of similar clinical importance and sensitivity to intervention should preferably be combined”\n“If adequate, mortality should however be included if it is likely to have a censoring effect on the observation of other components”"
  },
  {
    "objectID": "chap1.html#a-tricky-example",
    "href": "chap1.html#a-tricky-example",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A Tricky Example",
    "text": "A Tricky Example\n\n\nThe EMPA-REG Trial (NCT01131676)\n\nPopulation: 7,020 patients with type 2 diabetes (Zinman et al., 2015)\nTreatment arms: Empagliflozin vs control\nEndpoint: Time to first CV death, nonfatal MI, nonfatal stroke"
  },
  {
    "objectID": "chap1.html#data-and-notation",
    "href": "chap1.html#data-and-notation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Data and Notation",
    "text": "Data and Notation\n\n\nFull data \\(\\mathcal H^*(\\infty)\\)\n\n\\(D\\): survival time; \\(N^*_D(t)=I(D\\leq t)\\)\n\\(N^*_1(t), \\ldots, N^*_K(t)\\): counting processes for \\(K\\) nonfatal event types\nCumulative data: \\(\\mathcal H^*(t)=\\{N^*_D(u), N^*_1(u), \\ldots, N^*_K(u):0\\leq u\\leq t\\}\\)\n\n\n\n\n\nObserved (censored) data \\(\\{\\mathcal H^*(X), X\\}\\)\n\n\\(\\mathcal H^*(X)\\): outcomes up to time \\(X\\)\n\\(X=D\\wedge C\\): length of follow-up (\\(a\\wedge b = \\min(a, b)\\))\n\\(C\\): independent censoring time\nGoal: estimate/test features of \\(\\mathcal H^*(\\infty)\\) using \\(\\{\\mathcal H^*(X), X\\}\\)"
  },
  {
    "objectID": "chap1.html#first-event",
    "href": "chap1.html#first-event",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "First Event",
    "text": "First Event\n\n\nUnivariate endpoint\n\n\\(N^*_{\\rm TFE}(t) = I\\{N^*_D(t)+\\sum_{k=1}^KN^*_k(t)\\geq 1\\}\\)\n\n\\(I(\\cdot)\\): 0-1 indicator\n\n\\(\\tilde T\\): time to first event\n\nKaplan–Meier curve, log-rank test, Cox model\n\n\n\n\n\n\nComponent-wise weighting\n\nUpweight death over nonfatal events\n\nE.g., Death = 2 \\(\\times\\) hospitalization"
  },
  {
    "objectID": "chap1.html#total-events",
    "href": "chap1.html#total-events",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Total Events",
    "text": "Total Events\n\n\nWeighted composite event process\n\n\\(N^*_{\\rm R}(t)=w_DN^*_D(t)+\\sum_{k=1}^Kw_kN^*_k(t)\\)\n\n\\(w_D, w_1, \\ldots, w_K\\): weights to death and nonfatal events \n\nProportional means model (Mao & Lin, 2016) \\[\nE\\{N^*_{\\rm R}(t)\\mid Z\\} = \\exp(\\beta^\\T Z)\\mu_0(t)\n\\]\n\n\\(\\exp(\\beta)\\): mean ratio of weighted total events comparing treatment \\((Z=1)\\) vs control \\((Z=0)\\)\n\nR-package: Wcompo"
  },
  {
    "objectID": "chap1.html#software-wcompocompoml",
    "href": "chap1.html#software-wcompocompoml",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: Wcompo::CompoML()",
    "text": "Software: Wcompo::CompoML()\n\n\nBasic syntax\n\nid: unique patient identifier; time: event times; status: event types (1: death; 2,...,K nonfatal event types; Z: covariate matrix)\nw: \\(K\\)-vector of weights to event types 1,...K; default is unweighted\n\n\n\n\nlibrary(Wcompo)\nobj &lt;- CompoML(id, time, status, Z, w = c(2, 1))\n\n\n\n\n\nOutput: a list of class CompoML\n\nobj$beta: \\(\\hat\\beta\\); obj$var: \\(\\hat\\var(\\hat\\beta)\\)\nplot(obj, z): plot mean function \\(\\exp(\\hat\\beta^{\\rm T} z)\\hat\\mu_0(t)\\)"
  },
  {
    "objectID": "chap1.html#hf-action-an-example",
    "href": "chap1.html#hf-action-an-example",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: An Example",
    "text": "HF-ACTION: An Example\n\n\nHigh-risk subgroup (n=426)\n\nBaseline cardiopulmonary exercise (CPX) test \\(\\leq\\) 9 min\n\n\n\n\n\n\n\n\nTable 1: Summary statistics for a high-risk subgroup (n=426) in HF-ACTION trial.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUsual care (N = 221)\nExercise training (N = 205)\n\n\n\n\nAge\n≤ 60 years\n122 (55.2%)\n128 (62.4%)\n\n\n\n&gt; 60 years\n99 (44.8%)\n77 (37.6%)\n\n\nFollow-up\n(months)\n28.6 (18.4, 39.3)\n27.6 (19, 40.2)\n\n\nDeath\n\n57 (25.8%)\n36 (17.6%)\n\n\nHospitalizations\n0\n51 (23.1%)\n60 (29.3%)\n\n\n\n1-3\n114 (51.6%)\n102 (49.8%)\n\n\n\n4-10\n49 (22.2%)\n39 (19%)\n\n\n\n&gt;10\n7 (3.2%)\n4 (2%)"
  },
  {
    "objectID": "chap1.html#hf-action-preparation",
    "href": "chap1.html#hf-action-preparation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Preparation",
    "text": "HF-ACTION: Preparation\n\n\nLoad packages and data\n\n\nlibrary(survival) # for standard survival analysis\nlibrary(Wcompo) # for weighted total events\nlibrary(rmt) # for hfaction data\nlibrary(tidyverse) # for data wrangling\n\n# Load data\ndata(hfaction)\nhead(hfaction) # trt_ab=1: training; 0: usual care\n#&gt;        patid       time status trt_ab age60\n#&gt; 1 HFACT00001 0.60506502      1      0     1\n#&gt; 2 HFACT00001 1.04859685      0      0     1\n#&gt; 3 HFACT00002 0.06297057      1      0     1\n#&gt; 4 HFACT00002 0.35865845      1      0     1\n#&gt; 5 HFACT00002 0.39698836      1      0     1\n#&gt; 6 HFACT00002 3.83299110      0      0     1"
  },
  {
    "objectID": "chap1.html#hf-action-data",
    "href": "chap1.html#hf-action-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Data",
    "text": "HF-ACTION: Data\n\n\nData processing\n\n\n# For weighted total analysis by compoML()\n# Convert status=1 for death, 2=hospitalization\nhfaction &lt;- hfaction |&gt; \n  mutate(\n    status = case_when(\n      status == 1 ~ 2,\n      status == 2 ~ 1,\n      status == 0 ~ 0)\n  )\n\n# TFE: take the first event per patient id\nhfaction_TFE &lt;- hfaction |&gt; \n  arrange(patid, time) |&gt; # sort by patid and time\n  group_by(patid) |&gt; \n  slice_head() |&gt; # take first row\n  ungroup()"
  },
  {
    "objectID": "chap1.html#hf-action-mortality",
    "href": "chap1.html#hf-action-mortality",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Mortality",
    "text": "HF-ACTION: Mortality\n\n\nCox model for death\n\nHR: \\(\\exp(-0.3973) = 67.2\\%\\) (\\(32.8\\%\\) reduction in risk)\n\\(P\\)-value: 0.0621 (borderline significant)\n\n\n\n## Get mortality data\nhfaction_D &lt;- hfaction |&gt; \n  filter(status != 2) # remove hospitalization records\n\n## Cox model for death against trt_ab\nobj_D &lt;- coxph(Surv(time, status) ~ trt_ab, data = hfaction_D)\nsummary(obj_D)\n#&gt; n= 426, number of events= 93 \n#&gt;           coef exp(coef) se(coef)      z      p\n#&gt; trt_ab -0.3973    0.6721   0.2129 -1.866 0.0621"
  },
  {
    "objectID": "chap1.html#hf-action-tfe",
    "href": "chap1.html#hf-action-tfe",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: TFE",
    "text": "HF-ACTION: TFE\n\n\nCox model for hospitalization-free survival\n\nHR: \\(\\exp(-0.1770) = 83.8\\%\\) (\\(16.2\\%\\) reduction in risk)\n\\(P\\)-value: 0.111 (less significant than death)\n\n\n\n# Cox model for TFE against trt_ab\nobj_TFE &lt;- coxph(Surv(time, status &gt; 0) ~ trt_ab, data = hfaction_TFE)\nsummary(obj_TFE)\n#&gt;   n= 426, number of events= 326 \n#&gt;           coef exp(coef) se(coef)      z Pr(&gt;|z|)\n#&gt; trt_ab -0.1770    0.8378   0.1112 -1.592    0.111"
  },
  {
    "objectID": "chap1.html#hf-action-death-vs-tfe",
    "href": "chap1.html#hf-action-death-vs-tfe",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Death vs TFE",
    "text": "HF-ACTION: Death vs TFE\n\n\nHospitalizations dilute effect on death …\n\nAn EMPA-REG-like situation"
  },
  {
    "objectID": "chap1.html#hf-action-weighted-total",
    "href": "chap1.html#hf-action-weighted-total",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Weighted Total",
    "text": "HF-ACTION: Weighted Total\n\n\nProportional means model (death = \\(2\\times\\) hosp)\n\nMR: \\(\\exp(-0.15398) = 85.7\\%\\) (\\(14.3\\%\\) reduction in total number of composite events)\n\\(P\\)-value: 0.170 (less significant than TFE)\nLimitation: Survival \\(\\uparrow\\) \\(\\to\\) cumulative total \\(\\uparrow\\) \\(\\to\\) attenuated effect\n\n\n# Total events (proportional mean) -------------------------------\nobj_ML &lt;- CompoML(hfaction$patid, hfaction$time, hfaction$status, \n                  hfaction$trt_ab, w = c(2, 1))\nobj_ML\n#&gt;         Event 1 (Death) Event 2\n#&gt; Weight               2       1\n#&gt;         Estimate      se z.value p.value\n#&gt; trt_ab -0.15398  0.11215 -1.3729  0.1698"
  },
  {
    "objectID": "chap1.html#hf-action-cumulative-means",
    "href": "chap1.html#hf-action-cumulative-means",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Cumulative Means",
    "text": "HF-ACTION: Cumulative Means\n\n\nModel-based mean functions\n\n\nplot(obj_ML, 0, ylim= c(0, 5), xlab=\"Time (years)\", col= \"red\", lwd = 2)\nplot(obj_ML, 1, add = TRUE, col = \"blue\", lwd = 2)\nlegend(0, 5, col=c(\"red\",\"blue\"), c(\"Usual care\", \"Training\"), lwd = 2)"
  },
  {
    "objectID": "chap1.html#lessons-learned",
    "href": "chap1.html#lessons-learned",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Lessons Learned",
    "text": "Lessons Learned\n\n\nAdding nonfatal events \\(\\neq\\) higher power\n\nComponent may be less discriminating (Freemantle et al., 2003)\nLength of exposure (death as competing risk) (Schmidli et al., 2023)\n\n\n\n\n\nSolutions\n\nHierarchically prioritize death\n\nEvaluate nonfatal components only on survivors\n\nQuantitative weighting \\(\\to\\) adjust for survival time\n\nLoss rate = cumulative total / length of exposure (Ch 3)"
  },
  {
    "objectID": "chap1.html#win-ratio-basics",
    "href": "chap1.html#win-ratio-basics",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win Ratio: Basics",
    "text": "Win Ratio: Basics\n\n\nA common approach to HCE\n\nProposed and popularized by Pocock et al. (2012)\nTreatment vs control: generalized pairwise comparisons\nWin-loss: sequential comparison on components\n\nLonger survival &gt; fewer/later nonfatal MACE &gt; better 6MWT/NYHA score\n\nEffect size: WR \\(=\\) wins / losses\n\n\n\n\n\nAlternative metrics\n\nProportion in favor (net benefit): PIF \\(=\\) wins \\(-\\) losses (Buyse, 2010)\nWin odds: WO \\(=\\) (wins \\(+\\) \\(2^{-1}\\)ties) / (losses \\(+\\) \\(2^{-1}\\)ties) (Brunner et al., 2021; Dong et al., 2020)"
  },
  {
    "objectID": "chap1.html#win-ratio-gaining-popularity",
    "href": "chap1.html#win-ratio-gaining-popularity",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win Ratio: Gaining Popularity",
    "text": "Win Ratio: Gaining Popularity\n\n\nMore trials are using it…"
  },
  {
    "objectID": "chap1.html#an-important-caveat",
    "href": "chap1.html#an-important-caveat",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "An Important Caveat",
    "text": "An Important Caveat\n\n\nWR’s estimand depends on censoring …\n\nLuo et al. (2015), Bebu & Lachin (2016), Oakes (2016), Mao (2019), Dong et al. (2020a), Li et al. (2024), etc.\n\n\n\n\n\nWhat is an estimand?\n\nPopulation-level quantity to be estimated\n\nPopulation-mean difference, (true) risk ratio, etc.\n\nSpecifies how treatment effect is measured\nICH E9 (R1) addendum: estimand construction one of the “central questions for drug development and licensing” (ICH, 2020)"
  },
  {
    "objectID": "chap1.html#win-loss-changes-with-time",
    "href": "chap1.html#win-loss-changes-with-time",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win-Loss Changes with Time",
    "text": "Win-Loss Changes with Time\n\n\nIllustration\n\nWin-loss status, and deciding component, changes with time \nLonger follow-up …\n\nParameters: win/loss proportions \\(\\uparrow\\) (WR uncertain); tie proportion \\(\\downarrow\\)\nComponent contributions: prioritized \\(\\uparrow\\); deprioritized \\(\\downarrow\\)"
  },
  {
    "objectID": "chap1.html#trial-dependent-estimand",
    "href": "chap1.html#trial-dependent-estimand",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Trial-Dependent Estimand",
    "text": "Trial-Dependent Estimand\n\n\nActual estimand\n\nAverage WR mixing shorter-term with longer-term comparisons\nWeight set (haphazardly) by censoring distribution\n\nStaggered entry, random withdrawal \\(\\to\\) non-scientific\n\n\n\n\n\n\nTesting vs estimation\n\nTesting (qualitative): okay\n\nValid under \\(H_0\\), powerful if treatment consistently outperforms control over time\n\nEstimation (quantitative): not okay\n\nPre-define restriction time \\(\\to\\) use censoring weight for unbiased estimation (Ch 3)\nSpecify a time-constant WR model (Ch 4)"
  },
  {
    "objectID": "chap1.html#notes",
    "href": "chap1.html#notes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Notes",
    "text": "Notes\n\nMore on\n\nRegulatory guidelines for composite endpoints (Mao & Kim, 2021)\nICH E9 (R1) implementation (Akacha et al., 2017; Ionan et al., 2022; Qu & Lipkovich, 2021; Ratitch et al., 2020)\nPractical guidance (Pocock et al., 2024; Redfors et al., 2020)\nDefining estimand for win ratio (Mao, 2024)\nGeneralized pairwise comparisons (Deltuvaite-Thomas et al., 2022; Dong et al., 2022; Péron et al., 2016; Verbeeck et al., 2023)\n\nCumulative total events\n\nBased on cumulative incidence/frequency under competing risks (Fine & Gray, 1999; Ghosh & Lin, 2000; Gray, 1988)"
  },
  {
    "objectID": "chap1.html#summary",
    "href": "chap1.html#summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Summary",
    "text": "Summary\n\nComposite endpoints\n\nDeath + hospitalization/progression/relapse\nRegulatory recommendation\n\nTraditional\n\nTime to first: death = nonfatal (survival::coxph())\nWeighted total: death = \\(w_D\\times\\) nonfatal (Wcompo::compoML())\n\nHierarchical\n\nWin ratio, net benifit, win odds: death &gt; nonfatal\nEstimand issue - ICH E9 (R1)"
  },
  {
    "objectID": "chap1.html#references",
    "href": "chap1.html#references",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "References",
    "text": "References\n\n\n\n\nAkacha, M., Bretz, F., Ohlssen, D., Rosenkranz, G., & Schmidli, H. (2017). Estimands and Their Role in Clinical Trials. Statistics in Biopharmaceutical Research, 9(3), 268–271. https://doi.org/10.1080/19466315.2017.1302358\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win ratio analysis of a composite outcome based on prioritized components. Biostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBrunner, E., Vandemeulebroecke, M., & Mütze, T. (2021). Win odds: An adaptation of the win ratio to include ties. Statistics in Medicine, 40(14), 3367–3384. https://doi.org/10.1002/sim.8967\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized outcomes in the two-sample problem. Statistics in Medicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nDeltuvaite-Thomas, V., Verbeeck, J., Burzykowski, T., Buyse, M., Tournigand, C., Molenberghs, G., & Thas, O. (2022). Generalized pairwise comparisons for censored data: An overview. Biometrical Journal, 65(2). https://doi.org/10.1002/bimj.202100354\n\n\nDong, G., Hoaglin, D. C., Qiu, J., Matsouaka, R. A., Chang, Y.-W., Wang, J., & Vandemeulebroecke, M. (2020). The Win Ratio: On Interpretation and Handling of Ties. Statistics in Biopharmaceutical Research, 12(1), 99–106. https://doi.org/10.1080/19466315.2019.1575279\n\n\nDong, G., Huang, B., Chang, Y.-W., Seifu, Y., Song, J., & Hoaglin, D. C. (2020a). The win ratio: Impact of censoring and follow-up time and use with nonproportional hazards. Pharmaceutical Statistics, 19(3), 168–177. https://doi.org/10.1002/pst.1977\n\n\nDong, G., Huang, B., Verbeeck, J., Cui, Y., Song, J., Gamalo-Siebers, M., Wang, D., Hoaglin, D. C., Seifu, Y., Mütze, T., & Kolassa, J. (2022). Win statistics (win ratio, win odds, and net benefit) can complement one another to show the strength of the treatment effect on time-to-event outcomes. Pharmaceutical Statistics, 22(1), 20–33. https://doi.org/10.1002/pst.2251\n\n\nEUnetHTA. (2015). Guidance for industry: Multiple endpoints in clinical trials. https://www.eunethta.eu/wp-content/uploads/2018/01/Endpoints-used-for-Relative-Effectiveness-Assessment-Composite-endpoints_Amended-JA1-Guideline_Final-Nov-2015_0.pdf\n\n\nFDA. (2022). Guidance for industry: Multiple endpoints in clinical trials. https://www.fda.gov/regulatory-information/search-fda-guidance-documents/multiple-endpoints-clinical-trials-guidance-industry\n\n\nFine, J. P., & Gray, R. J. (1999). A Proportional Hazards Model for the Subdistribution of a Competing Risk. Journal of the American Statistical Association, 94(446), 496–509. https://doi.org/10.1080/01621459.1999.10474144\n\n\nFreemantle, N., Calvert, M., Wood, J., Eastaugh, J., & Griffin, C. (2003). Composite Outcomes in Randomized Trials. JAMA, 289(19), 2554. https://doi.org/10.1001/jama.289.19.2554\n\n\nGhosh, D., & Lin, D. Y. (2000). Nonparametric Analysis of Recurrent Events and Death. Biometrics, 56(2), 554–562. https://doi.org/10.1111/j.0006-341x.2000.00554.x\n\n\nGray, R. J. (1988). A class of \\(K\\)-sample tests for comparing the cumulative incidence of a competing risk. The Annals of Statistics, 16(3). https://doi.org/10.1214/aos/1176350951\n\n\nICH. (1998). Statistical principles for clinical trials. London: European Medicines Evaluation Agency.\n\n\nICH. (2020). ICH E9 (R1) addendum on estimands and sensitivity analysis in clinical trials to the guideline on statistical principles for clinical trials, step 5. London: European Medicines Evaluation Agency.\n\n\nIonan, A. C., Paterniti, M., Mehrotra, D. V., Scott, J., Ratitch, B., Collins, S., Gomatam, S., Nie, L., Rufibach, K., & Bretz, F. (2022). Clinical and Statistical Perspectives on the ICH E9(R1) Estimand Framework Implementation. Statistics in Biopharmaceutical Research, 15(3), 554–559. https://doi.org/10.1080/19466315.2022.2081601\n\n\nLi, H., Chen, W.-C., Lu, N., Tang, R., & Zhao, Y. (2024). The elusiveness of the win ratio parameter in the presence of missing data. Therapeutic Innovation & Regulatory Science, 1–2.\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative Approach to Confidence Interval Estimation for the Win Ratio Statistic. Biometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio. Biometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L. (2024). Defining estimand for the win ratio: Separate the true effect from censoring. Clinical Trials, 21(5), 584–594.\n\n\nMao, L., & Kim, K. (2021). Statistical Models for Composite Endpoints of Death and Nonfatal Events: A Review. Statistics in Biopharmaceutical Research, 13(3), 260–269. https://doi.org/10.1080/19466315.2021.1927824\n\n\nMao, L., & Lin, D. Y. (2016). Semiparametric regression for the weighted composite endpoint of recurrent and terminal events. Biostatistics, 17(2), 390–403. https://doi.org/10.1093/biostatistics/kxv050\n\n\nMoertel, C. G., Fleming, T. R., Macdonald, J. S., Haller, D. G., Laurie, J. A., Goodman, P. J., Ungerleider, J. S., Emerson, W. A., Tormey, D. C., Glick, J. H., Veeder, M. H., & Mailliard, J. A. (1990). Levamisole and Fluorouracil for Adjuvant Therapy of Resected Colon Carcinoma. New England Journal of Medicine, 322(6), 352–358. https://doi.org/10.1056/nejm199002083220602\n\n\nO’Connor, C. M., Whellan, D. J., Lee, K. L., Keteyian, S. J., Cooper, L. S., Ellis, S. J., Leifer, E. S., Kraus, W. E., Kitzman, D. W., Blumenthal, J. A., Rendall, D. S., Miller, N. H., Fleg, J. L., Schulman, K. A., McKelvie, R. S., Zannad, F., Piña, I. L., & HF-ACTION Investigators, for the. (2009). Efficacy and Safety of Exercise Training in Patients With Chronic Heart Failure. JAMA, 301(14), 1439. https://doi.org/10.1001/jama.2009.454\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with multiple types of event. Biometrika, 103(3), 742–745. https://doi.org/10.1093/biomet/asw026\n\n\nPéron, J., Buyse, M., Ozenne, B., Roche, L., & Roy, P. (2016). An extension of generalized pairwise comparisons for prioritized outcomes in the presence of censoring. Statistical Methods in Medical Research, 27(4), 1230–1239. https://doi.org/10.1177/0962280216658320\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The win ratio: a new approach to the analysis of composite endpoints in clinical trials based on clinical priorities. European Heart Journal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nPocock, S. J., Gregson, J., Collier, T. J., Ferreira, J. P., & Stone, G. W. (2024). The win ratio in cardiology trials: Lessons learnt, new developments, and wise future use. European Heart Journal, 45(44), 4684–4699.\n\n\nQu, Y., & Lipkovich, I. (2021). Implementation of ICH E9 (R1): A Few Points Learned During the COVID-19 Pandemic. Therapeutic Innovation & Regulatory Science, 55(5), 984–988. https://doi.org/10.1007/s43441-021-00297-6\n\n\nRatitch, B., Bell, J., Mallinckrodt, C., Bartlett, J. W., Goel, N., Molenberghs, G., O’Kelly, M., Singh, P., & Lipkovich, I. (2020). Choosing Estimands in Clinical Trials: Putting the ICH E9(R1) Into Practice. Therapeutic Innovation & Regulatory Science, 54(2), 324–341. https://doi.org/10.1007/s43441-019-00061-x\n\n\nRedfors, B., Gregson, J., Crowley, A., McAndrew, T., Ben-Yehuda, O., Stone, G. W., & Pocock, S. J. (2020). The win ratio approach for composite endpoints: practical guidance based on previous experience. European Heart Journal, 41(46), 4391–4399. https://doi.org/10.1093/eurheartj/ehaa665\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023). Rejoinder to Commentaries on “Estimands for Recurrent Event Endpoints in the Presence of a Terminal Event”. Statistics in Biopharmaceutical Research, 15(2), 255–256. https://doi.org/10.1080/19466315.2023.2166098\n\n\nVerbeeck, J., De Backer, M., Verwerft, J., Salvaggio, S., Valgimigli, M., Vranckx, P., Buyse, M., & Brunner, E. (2023). Generalized Pairwise Comparisons to Assess Treatment Effects. Journal of the American College of Cardiology, 82(13), 1360–1372. https://doi.org/10.1016/j.jacc.2023.06.047\n\n\nZinman, B., Wanner, C., Lachin, J. M., Fitchett, D., Bluhmki, E., Hantel, S., Mattheus, M., Devins, T., Johansen, O. E., Woerle, H. J., Broedl, U. C., & Inzucchi, S. E. (2015). Empagliflozin, Cardiovascular Outcomes, and Mortality in Type 2 Diabetes. New England Journal of Medicine, 373(22), 2117–2128. https://doi.org/10.1056/nejmoa1504720"
  },
  {
    "objectID": "intro.html#conclusion",
    "href": "intro.html#conclusion",
    "title": "1  Introduction",
    "section": "1.9 Conclusion",
    "text": "1.9 Conclusion\nStandard methods for analyzing composite endpoints—such as time to first event or weighted event counts—often oversimplify patient trajectories and obscure clinically important effects. Hierarchical approaches like the win ratio offer a more principled alternative but require careful attention to the estimand, especially in the presence of censoring. Modern methods such as RMT-IF and the proportional win-fractions model provide robust and interpretable tools for analyzing composite outcomes in a way that respects both clinical priority and statistical rigor.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "testing.html",
    "href": "testing.html",
    "title": "2  Hypothesis Testing",
    "section": "",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "chap2.html#outline",
    "href": "chap2.html#outline",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Outline",
    "text": "Outline\n\nWin ratio basics and properties\nGeneralize to recurrent events\n\nHF-ACTION example (WR package)\n\nSample size calculations\n\nHF-ACTION example (WR package) \\[\\newcommand{\\d}{{\\rm d}}\\] \\[\\newcommand{\\T}{{\\rm T}}\\] \\[\\newcommand{\\dd}{{\\rm d}}\\] \\[\\newcommand{\\cc}{{\\rm c}}\\] \\[\\newcommand{\\pr}{{\\rm pr}}\\] \\[\\newcommand{\\var}{{\\rm var}}\\] \\[\\newcommand{\\se}{{\\rm se}}\\] \\[\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\\] \\[\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\\] \\[\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\] \\[\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\] \\[ \\def\\a{{(a)}} \\def\\b{{(1-a)}} \\def\\t{{(1)}} \\def\\c{{(0)}} \\def\\d{{\\rm d}} \\def\\T{{\\rm T}} \\def\\bs{\\boldsymbol}\n\\]"
  },
  {
    "objectID": "chap2.html#standard-two-sample",
    "href": "chap2.html#standard-two-sample",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Standard Two-Sample",
    "text": "Standard Two-Sample\n\n\nTwo-sample comparison (Pocock et al., 2012)\n\nData: \\(D_i^{(a)}, T_i^{(a)}, C_i^{(a)}\\): survival, hospitalization, censoring times on \\(i\\)th subject in group \\(a\\) \\((i=1,\\ldots, N_a; a= 1, 0)\\)\nPairwise comparisons: \\(i\\)th in group \\(a\\) vs \\(j\\)th in group \\(1-a\\)\n\nHierarchical composite: Death &gt; hospitalization in \\(\\left[0, C_i^{(a)}\\wedge C_j^{(1-a)}\\right]\\) \\[\\begin{align}\n\\hat w^{(a, 1-a)}_{ij}&= \\underbrace{I(D_j^{(1-a)}&lt; D_i^{(a)}\\wedge C_i^{(a)}\\wedge C_j^{(1-a)})}_{\\mbox{win on survival}}\\\\\n& + \\underbrace{I(\\min(D_i^{(a)}, D_j^{(1-a)}) &gt; C_i^{(a)}\\wedge C_j^{(1-a)}, T_j^{(1-a)}&lt; T_i^{(a)}\\wedge C_i^{(1)}\\wedge C_j^{(0)})}_{\\mbox{tie on survival, win on hospitalization}}\n\\end{align}\\]"
  },
  {
    "objectID": "chap2.html#pococks-rule",
    "href": "chap2.html#pococks-rule",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Pocock’s Rule",
    "text": "Pocock’s Rule\n\n\nWin, lose, or tie?"
  },
  {
    "objectID": "chap2.html#calculation-of-win-ratio",
    "href": "chap2.html#calculation-of-win-ratio",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Calculation of Win Ratio",
    "text": "Calculation of Win Ratio\n\n\nTwo-sample statistics\n\nWin (loss) fraction for group \\(a\\) (\\(1-a\\)) \\[\n\\hat w^{(a, 1-a)}=(N_0N_1)^{-1}\\sum_{i=1}^{N_a}\\sum_{j=1}^{N_{1-a}}\\hat w^{(a, 1-a)}_{ij}\\]\nWin ratio statistic \\[\nWR = \\hat w^{(1, 0)} / \\hat w^{(0, 1)}\n\\]\nOther measures\n\nNet benefit (proportion in favor): \\(\\hat w^{(1, 0)} - \\hat w^{(0, 1)}\\) (Buyse, 2010)\nWin odds: \\((\\hat w^{(1, 0)} - \\hat w^{(0, 1)} + 1)/ (\\hat w^{(0, 1)} - \\hat w^{(1, 0)} + 1)\\) (Dong et al., 2020)"
  },
  {
    "objectID": "chap2.html#the-binary-case",
    "href": "chap2.html#the-binary-case",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "The Binary Case",
    "text": "The Binary Case\n\n\nConsider binary \\(Y^{(a)}= 1, 0\\)\n\n\\(\\hat w^{(a, 1-a)}_{ij} = I(Y_i^{(a)}&gt; Y_j^{(1-a)})=Y_i^{(a)}(1-Y_j^{(1-a)})\\)\nWin (loss) fraction \\[\n\\hat w^{(a, 1-a)} = (N_1N_0)^{-1}\\sum_{i=1}^{N_a}\\sum_{j=1}^{N_{1-a}}Y_i^{(a)}(1-Y_j^{(1-a)})\n= \\hat p^{(a)}(1-\\hat p^{(1-a)})\\]\n\n\\(\\hat p^{(a)}= N_a^{-1}\\sum_{i=1}^{N_a} Y_i^{(a)}\\) (success probability)\n\nEquivalencies \\[\\begin{align}\n{\\rm Win\\,\\, ratio}&= \\frac{\\hat w^{(1, 0)}}{\\hat w^{(0, 1)}} = \\frac{\\hat p^{(1)}(1-\\hat p^{(0)})}{\\hat p^{(0)}(1-\\hat p^{(1)})} = {\\rm Odds \\,\\, ratio}\\\\\n{\\rm Net \\,\\, benefit}&=\\hat w^{(1, 0)} - \\hat w^{(0, 1)} = \\hat p^{(1)}- \\hat p^{(0)}= {\\rm Risk \\,\\, difference}\n\\end{align}\\]"
  },
  {
    "objectID": "chap2.html#hypothesis-testing",
    "href": "chap2.html#hypothesis-testing",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Hypothesis Testing",
    "text": "Hypothesis Testing\n\n\nTest statistic\n\nLog-transformed and normalized \\[\nS_n = \\frac{n^{1/2}\\log(\\hat w_{1,0}/\\hat w_{0,1})}{\\hat{\\rm SE}} \\stackrel{H_0}{\\sim} N (0, 1)\n\\]\n\n\\(\\hat{\\rm SE}\\): standard error of numerator by \\(U\\)-statistic method (Bebu & Lachin, 2016; Dong et al., 2016; Luo et al., 2015); \\(n = N_1 + N_0\\)\n\nNull hypothesis \\[\nH_0: H^\\t(s, t) = H^\\c(s, t)\\mbox{ for all } t\\leq s\n\\]\n\n\\(H^\\a(s, t)=\\pr(D^\\a &gt; s, T^\\a &gt; t)\\)"
  },
  {
    "objectID": "chap2.html#alternative-hypothesis",
    "href": "chap2.html#alternative-hypothesis",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Alternative Hypothesis",
    "text": "Alternative Hypothesis\n\n\nWhat is estimand of WR?\n\nCensoring-weighted average of time-dependent WRs (Oakes, 2016) \\[\n\\frac{\\hat w_{1,0}}{\\hat w_{0,1}}\\to\n\\frac{\\int_0^\\infty\\pr(\\mbox{Treatment wins by } t)\\dd G(t)}\n{\\int_0^\\infty\\pr(\\mbox{Control wins by } t)\\dd G(t)} =\\text{Non-centrality parameter}\n\\]\n\n\\(G(t)\\): Distribution function of \\(C^\\t\\wedge C^\\c\\) \n\nTreatment wins consistently against control over time (Mao, 2019) \\[\nH_A: \\pr(\\mbox{Treatment wins by } t)\\geq \\pr(\\mbox{Control wins by } t)\n\\mbox{ for all } t\n\\]\nSufficient condition: joint stochastic order of death and nonfatal event \\[\nH_A: H^\\t(s, t) \\geq  H^\\c(s, t)\\mbox{ for all } t\\leq s\n\\]"
  },
  {
    "objectID": "chap2.html#variations",
    "href": "chap2.html#variations",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Variations",
    "text": "Variations\n\n\nWeighting\n\nUnweighted pairwise comparisons \\(\\to\\) Gehan (1965) test\nWeight win/loss by time of follow-up \\(\\to\\) log-rank (more efficient) (Luo et al., 2017)\n\n\n\n\n\nStratification\n\nStratified WR: within-stratum comparisons (Dong et al., 2017, 2023; Gasparyan et al., 2020)\n\nSum of stratum-specific wins / sum of stratum-specific losses\n\nAdjust for confounding; increase efficiency"
  },
  {
    "objectID": "chap2.html#general-data",
    "href": "chap2.html#general-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "General Data",
    "text": "General Data\n\n\nFull outcomes\n\nA subject in group \\(a\\) \\((a=1, 0)\\) \\[\\mathcal H^{*{(a)}}(t)=\\left\\{N^{*{(a)}}_D(u), N^{*{(a)}}_1(u), \\ldots, N^{*{(a)}}_K(u):0\\leq u\\leq t\\right\\}\\]\n\\(N^{*{(a)}}_D(u), N^{*{(a)}}_1(u), \\ldots, N^{*{(a)}}_K(u)\\): counting processes for death and \\(K\\) different types of nonfatal events\n\n\n\n\n\nObserved data\n\n\\(\\mathcal H^{*{(a)}}(X^{(a)})\\): life history up to \\(X^{(a)}= D^{(a)}\\wedge C^{(a)}\\)"
  },
  {
    "objectID": "chap2.html#general-rule-of-comparison",
    "href": "chap2.html#general-rule-of-comparison",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "General Rule of Comparison",
    "text": "General Rule of Comparison\n\n\nWin function\n\nTime frame of comparison: \\([0, t]\\) \\[\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t) =I\\left\\{\\mathcal H^{*{(a)}}(t) \\mbox{ is more favorable than } \\mathcal H^{*{(1-a)}}(t)\\right\\}\\]\nBasic requirements\n\n(W1) \\(\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)\\) is a function only of \\(\\mathcal H^{*{(a)}}(t)\\) and \\(\\mathcal H^{*{(1-a)}}(t)\\)\n(W2) \\(\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)+\\mathcal W(\\mathcal H^{*{(1-a)}}, \\mathcal H^{*{(a)}})(t) \\in \\{0, 1\\}\\)\n(W3) \\(\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)=\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(D^{(a)}\\wedge D^{(1-a)}\\wedge t)\\)\n\nInterpretations\n\n(W1) Consistency of time frame\n(W2) Either win, loss, or tie\n(W3) No change of win-loss status after death (satisfied if death is prioritized)"
  },
  {
    "objectID": "chap2.html#generalized-win-ratio",
    "href": "chap2.html#generalized-win-ratio",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Generalized Win Ratio",
    "text": "Generalized Win Ratio\n\n\nUnder general win function \\(\\mathcal W(\\cdot,\\cdot)\\)\n\nWin ratio statistic \\[\\begin{equation}\\label{eq:wr:gen_WR}\n\\hat{\\mathcal E}_n(\\mathcal W)=\\frac{(N_1N_0)^{-1}\\sum_{i=1}^{N_1}\\sum_{j=1}^{N_0}\\mathcal W(\\mathcal H^{*{(1)}}_{i}, \\mathcal H^{*{(0)}}_{j})(X^{{(1)}}_{i}\\wedge X^{{(0)}}_{j})}\n{(N_1N_0)^{-1}\\sum_{i=1}^{N_1}\\sum_{j=1}^{N_0}\\mathcal W(\\mathcal H^{*{(0)}}_{j}, \\mathcal H^{*{(1)}}_{i})(X^{{(1)}}_{i}\\wedge X^{{(0)}}_{j})}\n\\end{equation}\\]\nStill each pair is compared over \\(\\left[0, X^{{(1)}}_{i}\\wedge X^{{(0)}}_{j}\\right]\\), but by a general rule \\(\\mathcal W\\)\nStratified win ratio: ratio between weighted sum of within-stratum win/loss fractions"
  },
  {
    "objectID": "chap2.html#examples",
    "href": "chap2.html#examples",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Examples",
    "text": "Examples\n\n\nPocock’s WR\n\n\\(T^{(a)}_1\\): time of first event in \\(N^{*{(a)}}(t)=\\sum_{k=1}^K N^{*{(a)}}_k(t)\\) \\[\\begin{align}\\label{eq:wr:PWR}\n\\mathcal W_{\\rm P}(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(t)&=I\\{D^{(1-a)}&lt;D^{(a)}\\wedge t\\}\\notag\\\\\n&\\hspace{2mm}+I\\{D^{(a)}\\wedge D^{(1-a)}&gt;t, T_{1}^{(1-a)}&lt;T_{1}^{(a)}\\wedge t\\}\n\\end{align}\\]\n\\(\\hat{\\mathcal E}_n(\\mathcal W_{\\rm P})\\)\n\n\n\n\n\nTFE WR\n\n\\(\\tilde T^{(a)}=\\min(D^{(a)}, T_1^{(a)})\\) \\[\n\\mathcal W_{\\rm TFE}(\\mathcal H^{*{(a)}},\\mathcal H^{*{(1-a)}})(t)=I(\\tilde T^{(1-a)}&lt;\\tilde T^{(a)}\\wedge t)\n\\]\n\\(\\hat{\\mathcal E}_n(\\mathcal W_{\\rm TFE})\\): allowable but not desirable"
  },
  {
    "objectID": "chap2.html#options-for-recurrent-events",
    "href": "chap2.html#options-for-recurrent-events",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Options for Recurrent Events",
    "text": "Options for Recurrent Events\n\n\nThree variations (Mao et al., 2022)\n\nNaive: Death &gt; number of events (Finkelstein & Schoenfeld, 1999)\nFirst-event: Death &gt; number of events &gt; time to first event\nLast-event: Death &gt; number of events &gt; time to last event\n\n\n\n\n\nProperties\n\nFirst/Last-event fewer ties than standard WR\nFirst/Last-event \\(\\to\\) Pocock’s WR with nonrecurrent event\n\n\n\n\n\n\nExercise\n\n\nWrite out the win function \\(\\mathcal W\\) for the three versions of recurrent-event WR."
  },
  {
    "objectID": "chap2.html#comparison-with-pococks",
    "href": "chap2.html#comparison-with-pococks",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Comparison with Pocock’s",
    "text": "Comparison with Pocock’s\n\n\nLast-event WR (LWR)\n\nvs Pocock’s WR (PWR)"
  },
  {
    "objectID": "chap2.html#alternative-hypothesis-for-lwr",
    "href": "chap2.html#alternative-hypothesis-for-lwr",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Alternative Hypothesis for LWR",
    "text": "Alternative Hypothesis for LWR\n\n\nLWR\n\nTests joint stochastic order of all events \\[\n  H_A: H^\\t(s, t_1, t_2, \\ldots) \\geq  H^\\c(s, t_1, t_2, \\ldots)\\mbox{ for all }\n  t_1\\leq t_2\\leq\\cdots\\leq s\n  \\]\n\n\\(H^\\t(s, t_1, t_2, \\ldots)=\\pr(D^\\a &gt; s, T_1^\\a &gt; t_1, T_2^\\a &gt; t_2, \\ldots)\\)\n\\(T_k^\\a\\): \\(k\\)th recurrent event in \\(N^{*{(a)}}(t)\\) \\((k=1, 2, \\ldots)\\)\n\nTreatment stochastically delays all events\nAll variations of WR implemented in WR package\n\nSimulations show LWR more powerful than rest (Mao et al., 2022)"
  },
  {
    "objectID": "chap2.html#software-wrwrrec",
    "href": "chap2.html#software-wrwrrec",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WR::WRrec()",
    "text": "Software: WR::WRrec()\n\n\nBasic syntax\n\nLong format ID: unique patient identifier; time: event times; status: event types (1: death; 2: recurrent events; 0: censoring); trt: binary treatment; strata: strata variable\nnaive = TRUE: calculates naive/FWR as well as LWR\n\n\n\n\nlibrary(WR)\nobj &lt;- WRrec(ID, time, status, trt, strata = NULL, naive = FALSE)\n\n\n\nOutput: a list of class WRrec\n\nobj$log.WR: log-LWR; obj$se: \\(\\hat\\se(\\mbox{log-LWR})\\)\nprint(obj) to print summary results"
  },
  {
    "objectID": "chap2.html#hf-action-data",
    "href": "chap2.html#hf-action-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Data",
    "text": "HF-ACTION: Data\n\n\nHigh-risk subset \\((n=426)\\)\n\nage60: indicator of age \\(\\geq\\) 60 yrs\n\n\n\nlibrary(WR)\n##### Read in HF-ACTION DATA########\n# same as rmt::hfaction used in chap 1 \n#  (except for status coding)\ndata(hfaction_cpx9)\nhfaction &lt;- hfaction_cpx9\nhead(hfaction)\n#&gt;        patid       time status trt_ab age60\n#&gt; 1 HFACT00001  7.2459016      2      0     1\n#&gt; 2 HFACT00001 12.5573770      0      0     1\n#&gt; 3 HFACT00002  0.7540984      2      0     1\n#&gt; 4 HFACT00002  4.2950820      2      0     1\n#&gt; 5 HFACT00002  4.7540984      2      0     1\n#&gt; 6 HFACT00002 45.9016393      0      0     1"
  },
  {
    "objectID": "chap2.html#hf-action-summary",
    "href": "chap2.html#hf-action-summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Summary",
    "text": "HF-ACTION: Summary\n\n\nDescriptive\n\n\n\n\n\nTable 1: Summary statistics for a high-risk subgroup (n=426) in HF-ACTION trial.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nUsual care (N = 221)\nExercise training (N = 205)\n\n\n\n\nAge\n≤ 60 years\n122 (55.2%)\n128 (62.4%)\n\n\n\n&gt; 60 years\n99 (44.8%)\n77 (37.6%)\n\n\nFollow-up\n(months)\n28.6 (18.4, 39.3)\n27.6 (19, 40.2)\n\n\nDeath\n\n57 (25.8%)\n36 (17.6%)\n\n\nHospitalizations\n0\n51 (23.1%)\n60 (29.3%)\n\n\n\n1-3\n114 (51.6%)\n102 (49.8%)\n\n\n\n4-10\n49 (22.2%)\n39 (19%)\n\n\n\n&gt;10\n7 (3.2%)\n4 (2%)"
  },
  {
    "objectID": "chap2.html#hf-action-wr-analyses",
    "href": "chap2.html#hf-action-wr-analyses",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: WR Analyses",
    "text": "HF-ACTION: WR Analyses\n\n\nNaive (NWR), first-event (FWR), LWR\n\nStratified by age \\(&lt;\\) or \\(\\geq 60\\)\n\n\nobj &lt;- WRrec(ID = hfaction$patid, time = hfaction$time, \n             status = hfaction$status, trt = hfaction$trt_ab,\n             strata = hfaction$age60, naive = TRUE)\n\n\nobj\n#&gt;             N Rec. Event Death Med. Follow-up\n#&gt; Control   221        571    57       28.62295\n#&gt; Treatment 205        451    36       27.57377\n#&gt; \n#&gt; WR analyses:\n#&gt;     Win prob Loss prob WR (95% CI)*      p-value\n#&gt; LWR 50.4%    38.2%     1.32 (1.05, 1.66) 0.0189 \n#&gt; FWR 50.4%    38.3%     1.32 (1.04, 1.66) 0.0202 \n#&gt; NWR 47%      35%       1.34 (1.05, 1.72) 0.0193 \n#&gt; -----\n#&gt; *Note: The scale of WR depends on censoring distribution."
  },
  {
    "objectID": "chap2.html#hf-action-overall",
    "href": "chap2.html#hf-action-overall",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Overall",
    "text": "HF-ACTION: Overall\n\n\nRecurrent-event WRs more powerful than PWR\n\nNWR/FWR/LWR similar as \\(N\\) hosp is highly variable (0 - 26)"
  },
  {
    "objectID": "chap2.html#special-case-pwr",
    "href": "chap2.html#special-case-pwr",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Special Case: PWR",
    "text": "Special Case: PWR\n\n\nSimplified outcome model\n\nGumbel-Hougaard copula (Oakes, 1989) \\[\n\\pr(D^\\a&gt;s, T_1^\\a&gt;t) = \\exp\\left(-\\left[\\{\\exp(a\\xi_D)\\lambda_Ds\\}^\\kappa + \\{\\exp(a\\xi_H)\\lambda_Ht\\}^\\kappa \\right]^{1/\\kappa}\\right)\n\\]\n\n\\(\\lambda_D, \\lambda_H\\): baseline hazard rates for death/nonfatal event\n\\(\\exp(\\xi_D), \\exp(\\xi_H)\\): treatment HR on death/nonfatal event (effect sizes)\n\\(\\kappa\\geq 1\\): association parameter (Kendall’s rank correlation \\(1-\\kappa^{-1}\\))\n\n\n\n\n\n\nStudy design\n\nUniform patient accrual over \\([0, \\tau_b]\\); follow all until \\(\\tau&gt;\\tau_b\\)\nRandom loss-to-follow-up (LTFU) rate \\(\\lambda_L\\)"
  },
  {
    "objectID": "chap2.html#sample-size-formula",
    "href": "chap2.html#sample-size-formula",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Sample Size Formula",
    "text": "Sample Size Formula\n\n\nTotal sample size needed \\[\nn = \\frac{\\zeta_0^2(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)(z_{1-\\alpha/2} + z_\\gamma)^2}\n{q(1-q)\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)^\\T\\xi}\n\\]\n\n\\(\\alpha =0.05\\): type I error; \\(\\gamma = 0.8, 0.9\\): desired power (\\(z_\\gamma=\\Phi^{-1}(\\gamma)\\))\n\\(\\xi=(\\xi_D,\\xi_H)^\\T\\): component-wise log-HRs (effect sizes)\n\\(q=N_1/n\\): proportion assigned to treatment\nNuisance parameters\n\n\\(\\zeta_0(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)\\): individual-level noise parameter (cf. SD) in WR\n\\(\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)\\): differential vector for log-WR \\(\\to\\) log-HRs\nCalculable by WR::base(lambda_D,lambda_H,kappa,tau_c,tau,lambda_L)"
  },
  {
    "objectID": "chap2.html#parameter-specification",
    "href": "chap2.html#parameter-specification",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Parameter Specification",
    "text": "Parameter Specification\n\n\nBaseline outcome parameters \\((\\lambda_D,\\lambda_H,\\kappa)\\)\n\nEstimable from pilot/historical data\n\nWR::gumbel.est(id, time, status)\n\n\n\n\n\n\n\n\nExercise: Under Gumbel-Hougaard copula\n\n\n\n\\(D^\\c\\sim\\mbox{exponential}(\\lambda_D)\\)\n\\(\\tilde T^\\c = D^\\c\\wedge T_1^\\c\\sim\\mbox{exponential}\\left(\\lambda_{CE}\\right)\\), where \\(\\lambda_{CE} = (\\lambda_D^\\kappa +\n\\lambda_H^\\kappa)^{1/\\kappa}\\)\nCause-specific hazard for \\(T_1^\\c\\): \\(\\lambda_H^\\#=\\lambda_H^\\kappa\\lambda_{CE}^{1-\\kappa}\\)\nThree parameters \\(\\to\\) three estimable quantities\n\n\n\n\nDesign parameters \\((\\tau_c,\\tau,\\lambda_L)\\)\n\nSelf-specify"
  },
  {
    "objectID": "chap2.html#software-wrwrss",
    "href": "chap2.html#software-wrwrss",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WR::WRSS()",
    "text": "Software: WR::WRSS()\n\n\nBasic steps\n\nxi: log-HRs \\(\\xi=(\\xi_D, \\xi_H)^T\\) (e.g., \\(\\log (0.8, 0.9)^\\T\\))\n\n\n# Step 1: estimate (lambda_D, lambda_H, kappa) from pilot data\noutcome_base &lt;- gumbel.est(id, time, status)\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- obj_base$kappa\n\n\n# Step 2: calculate zeta2 and delta from\n# (lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\nbparam &lt;- base(lambda_D,lambda_H,kappa,tau_c,tau,lambda_L)\n## a list of zeta2 and delta \n\n\n# Step 3: calculate sample size using bparam\nobj &lt;- WRSS(xi, bparam, q = 0.5, alpha = 0.05, side = 2, power = 0.8)\nobj$n"
  },
  {
    "objectID": "chap2.html#a-new-training-trial",
    "href": "chap2.html#a-new-training-trial",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A New Training Trial",
    "text": "A New Training Trial\n\n\nBackground\n\nWR demonstrated beneficial effect of training on (death &gt; hosp) in HF patients with CPX \\(\\leq 9\\) min\n\n\n\n\n\nDesign of new trial\n\nPurpose: test a new training program with existing one as standard care\nDesign: \\(\\tau_b = 3\\) yrs patient accrual, follow until \\(\\tau = 4\\) yrs\n\nAssume minimal LTFU \\(\\lambda_L = 0.01\\) per person-year\n\nBaseline event rates/correlation: estimable from \\(n=205\\) patients in HF-ACTION training arm"
  },
  {
    "objectID": "chap2.html#hf-action-historical-data",
    "href": "chap2.html#hf-action-historical-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Historical Data",
    "text": "HF-ACTION: Historical Data\n\n\nExtract data from hfaction\n\n\n# get training arm data\npilot &lt;- hfaction |&gt; \n  filter(trt_ab == 1)\nhead(pilot)\n#&gt;     patid      time status trt_ab age60\n#&gt; HFACT00007  3.47541      2      1     1\n#&gt; HFACT00007 21.60656      2      1     1\n#&gt; HFACT00007 29.04918      2      1     1\n#&gt; HFACT00007 32.16393      2      1     1\n#&gt; HFACT00007 34.88525      1      1     1\n#&gt; HFACT00035 48.88525      0      1     1\n# number of subjects\npilot |&gt; distinct(patid) |&gt; \n  count()\n#&gt;   n\n#&gt; 205"
  },
  {
    "objectID": "chap2.html#hf-action-baseline-outcome",
    "href": "chap2.html#hf-action-baseline-outcome",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Baseline Outcome",
    "text": "HF-ACTION: Baseline Outcome\n\n\nParameter estimates\n\n\\(\\lambda_D=0.07\\) year\\(^{-1}\\), \\(\\lambda_H=0.56\\) year\\(^{-1}\\), Kendall’s corr \\(=36.1\\%\\)\n\n\n\n# Step 1: estimate (lambda_D, lambda_H, kappa) from HF-ACTION data\noutcome_base &lt;- gumbel.est(pilot$patid, pilot$time / 12, pilot$status)\nlambda_D &lt;- outcome_base$lambda_D\nlambda_H &lt;- outcome_base$lambda_H\nkappa &lt;- outcome_base$kappa\nlambda_D\n#&gt; [1] 0.07307293\nlambda_H\n#&gt; 1] 0.5596186\nkappa\n#&gt; [1] 1.564485\n## Kendall's rank correlation\n1 - 1/kappa\n#&gt; [1] 0.360812"
  },
  {
    "objectID": "chap2.html#sample-size-example",
    "href": "chap2.html#sample-size-example",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Sample Size: Example",
    "text": "Sample Size: Example\n\n\nOne scenario\n\nHRs on death & hospitalization: 0.9, 0.8\nSample size needed for power 80%: \\(n=1241\\)\n\n\n\n# set design parameters\ntau_b &lt;- 3\ntau &lt;- 4\nlambda_L &lt;- 0.001\n# Step 2: use base() function to compute zeta2 and delta\nset.seed(1234) # Monte-Carlo integration in base()\nbparam &lt;- base(lambda_D, lambda_H, kappa, tau_b, tau, lambda_L)\n# Step 3: compute sample size under HRs 0.8 and 0.9\nobj &lt;- WRSS(xi = log(c(0.9, 0.8)), bparam = bparam, q =  0.5, alpha = 0.05,\n          power = 0.8)\nobj$n\n#&gt; [1] 1240.958"
  },
  {
    "objectID": "chap2.html#a-range-of-effect-sizes",
    "href": "chap2.html#a-range-of-effect-sizes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A Range of Effect Sizes",
    "text": "A Range of Effect Sizes\n\n\nDifferent HRs: \\(\\exp(\\xi)\\in [0.6, 0.95]^{\\otimes 2}\\)"
  },
  {
    "objectID": "chap2.html#notes",
    "href": "chap2.html#notes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Notes",
    "text": "Notes\n\nEvent-specific win ratio\n\nWin/loss on which component (Yang et al., 2022; Yang & Troendle, 2020)\n\nMore on sample size\n\nCalculatation based on win/loss proproportions (Yu & Ganju, 2022)\nSimplified/approximate approaches in various scenarios (Gasparyan et al., 2021; Seifu et al., 2022, etc.; Wang et al., 2023; Zhou et al., 2022)"
  },
  {
    "objectID": "chap2.html#summary",
    "href": "chap2.html#summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Summary",
    "text": "Summary\n\nWin ratio test\n\nStandard: death &gt; one nonfatal event\nRecurrent events: death &gt; frequency &gt; time to last/first event\n\nWR::WRrec(ID, time, status, trt, strata)\n\n\nSample size calculations\n\nGumbel-Hougaard copula for death & nonfatal event \\[\\pr(D^\\a&gt;s, T_1^\\a&gt;t) = \\exp\\left(-\\left[\\{\\exp(a\\xi_D)\\lambda_Ds\\}^\\kappa + \\{\\exp(a\\xi_H)\\lambda_Ht\\}^\\kappa \\right]^{1/\\kappa}\\right)\n\\]\n\nStep 1: estimate \\((\\lambda_D,\\lambda_H,\\kappa)\\) WR::gumbel.est(id, time, status)\nStep 2: calculate \\(\\zeta^2_0(\\lambda_D,\\lambda_H,\\kappa,\\tau_b,\\tau,\\lambda_L)\\) and \\(\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_b,\\tau,\\lambda_L)\\) WR::base()\nStep 3: \\(n=\\frac{\\zeta_0^2(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)(z_{1-\\alpha/2} + z_\\gamma)^2}{q(1-q)\\delta(\\lambda_D,\\lambda_H,\\kappa,\\tau_c,\\tau,\\lambda_L)^\\T\\xi}\\) WR::WRSS()"
  },
  {
    "objectID": "chap2.html#references",
    "href": "chap2.html#references",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "References",
    "text": "References\n\n\n\n\nBebu, I., & Lachin, J. M. (2016). Large sample inference for a win ratio analysis of a composite outcome based on prioritized components. Biostatistics, 17(1), 178–187. https://doi.org/10.1093/biostatistics/kxv032\n\n\nBuyse, M. (2010). Generalized pairwise comparisons of prioritized outcomes in the two-sample problem. Statistics in Medicine, 29(30), 3245–3257. https://doi.org/10.1002/sim.3923\n\n\nDong, G., Hoaglin, D. C., Huang, B., Cui, Y., Wang, D., Cheng, Y., & Gamalo-Siebers, M. (2023). The stratified win statistics (win ratio, win odds, and net benefit). Pharmaceutical Statistics, 22(4), 748–756. https://doi.org/10.1002/pst.2293\n\n\nDong, G., Hoaglin, D. C., Qiu, J., Matsouaka, R. A., Chang, Y.-W., Wang, J., & Vandemeulebroecke, M. (2020). The Win Ratio: On Interpretation and Handling of Ties. Statistics in Biopharmaceutical Research, 12(1), 99–106. https://doi.org/10.1080/19466315.2019.1575279\n\n\nDong, G., Li, D., Ballerstedt, S., & Vandemeulebroecke, M. (2016). A generalized analytic solution to the win ratio to analyze a composite endpoint considering the clinical importance order among components. Pharmaceutical Statistics, 15(5), 430–437. https://doi.org/10.1002/pst.1763\n\n\nDong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2017). The stratified win ratio. Journal of Biopharmaceutical Statistics, 28(4), 778–796. https://doi.org/10.1080/10543406.2017.1397007\n\n\nFinkelstein, D. M., & Schoenfeld, D. A. (1999). Combining mortality and longitudinal measures in clinical trials. Statistics in Medicine, 18(11), 1341–1354. https://doi.org/10.1002/(sici)1097-0258(19990615)18:11&lt;1341::aid-sim129&gt;3.0.co;2-7\n\n\nGasparyan, S. B., Folkvaljon, F., Bengtsson, O., Buenconsejo, J., & Koch, G. G. (2020). Adjusted win ratio with stratification: Calculation methods and interpretation. Statistical Methods in Medical Research, 30(2), 580–611. https://doi.org/10.1177/0962280220942558\n\n\nGasparyan, S. B., Kowalewski, E. K., Folkvaljon, F., Bengtsson, O., Buenconsejo, J., Adler, J., & Koch, G. G. (2021). Power and sample size calculation for the win odds test: application to an ordinal endpoint in COVID-19 trials. Journal of Biopharmaceutical Statistics, 31(6), 765–787. https://doi.org/10.1080/10543406.2021.1968893\n\n\nGehan, E. A. (1965). A generalized Wilcoxon test for comparing arbitrarily singly-censored samples. Biometrika, 52(1-2), 203–224. https://doi.org/10.1093/biomet/52.1-2.203\n\n\nLuo, X., Qiu, J., Bai, S., & Tian, H. (2017). Weighted win loss approach for analyzing prioritized outcomes. Statistics in Medicine, 36(15), 2452–2465. https://doi.org/10.1002/sim.7284\n\n\nLuo, X., Tian, H., Mohanty, S., & Tsai, W. Y. (2015). An Alternative Approach to Confidence Interval Estimation for the Win Ratio Statistic. Biometrics, 71(1), 139–145. https://doi.org/10.1111/biom.12225\n\n\nMao, L. (2019). On the Alternative Hypotheses for the Win Ratio. Biometrics, 75(1), 347–351. https://doi.org/10.1111/biom.12954\n\n\nMao, L., Kim, K., & Li, Y. (2022). On recurrent-event win ratio. Statistical Methods in Medical Research, 31(6), 1120–1134. https://doi.org/10.1177/09622802221084134\n\n\nOakes, D. (1989). Bivariate Survival Models Induced by Frailties. Journal of the American Statistical Association, 84(406), 487–493. https://doi.org/10.1080/01621459.1989.10478795\n\n\nOakes, D. (2016). On the win-ratio statistic in clinical trials with multiple types of event. Biometrika, 103(3), 742–745. https://doi.org/10.1093/biomet/asw026\n\n\nPocock, S. J., Ariti, C. A., Collier, T. J., & Wang, D. (2012). The win ratio: a new approach to the analysis of composite endpoints in clinical trials based on clinical priorities. European Heart Journal, 33(2), 176–182. https://doi.org/10.1093/eurheartj/ehr352\n\n\nSeifu, Y., Mt-Isa, S., Duke, K., Gamalo-Siebers, M., Wang, W., Dong, G., & Kolassa, J. (2022). Design of paediatric trials with benefit-risk endpoints using a composite score of adverse events of interest (AEI) and win-statistics. Journal of Biopharmaceutical Statistics, 33(6), 696–707. https://doi.org/10.1080/10543406.2022.2153202\n\n\nWang, B., Zhou, D., Zhang, J., Kim, Y., Chen, L.-W., Dunnmon, P., Bai, S., Liu, Q., & Ishida, E. (2023). Statistical power considerations in the use of win ratio in cardiovascular outcome trials. Contemporary Clinical Trials, 124, 107040. https://doi.org/10.1016/j.cct.2022.107040\n\n\nYang, S., & Troendle, J. (2020). Event-specific win ratios and testing with terminal and non-terminal events. Clinical Trials, 18(2), 180–187. https://doi.org/10.1177/1740774520972408\n\n\nYang, S., Troendle, J., Pak, D., & Leifer, E. (2022). Event-specific win ratios for inference with terminal and non-terminal events. Statistics in Medicine, 41(7), 1225–1241. https://doi.org/10.1002/sim.9266\n\n\nYu, R. X., & Ganju, J. (2022). Sample size formula for a win ratio endpoint. Statistics in Medicine, 41(6), 950–963. https://doi.org/10.1002/sim.9297\n\n\nZhou, T. J., LaValley, M. P., Nelson, K. P., Cabral, H. J., & Massaro, J. M. (2022). Calculating power for the Finkelstein and Schoenfeld test statistic for a composite endpoint with two components. Statistics in Medicine, 41(17), 3321–3335. https://doi.org/10.1002/sim.9419"
  },
  {
    "objectID": "chap2.html#estimand",
    "href": "chap2.html#estimand",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Estimand",
    "text": "Estimand\n\n\nWhat is estimand of WR?\n\nCensoring-weighted average of time-dependent WRs (Oakes, 2016) \\[\n\\frac{\\hat w_{1,0}}{\\hat w_{0,1}}\\to\n\\frac{\\int_0^\\infty\\pr(\\mbox{Treatment wins by } t)\\dd G(t)}\n{\\int_0^\\infty\\pr(\\mbox{Control wins by } t)\\dd G(t)}\n\\]\n\n\\(G(t)\\): Distribution function of \\(C^\\t\\wedge C^\\c\\)"
  },
  {
    "objectID": "testing.html#win-ratio-definitions-and-properties",
    "href": "testing.html#win-ratio-definitions-and-properties",
    "title": "2  Hypothesis Testing",
    "section": "2.1 Win Ratio: Definitions and Properties",
    "text": "2.1 Win Ratio: Definitions and Properties\nThe win ratio (WR) is a pairwise, nonparametric method for comparing composite outcomes in a prioritized manner. Each subject in the treatment arm is compared to each subject in the control arm over a shared follow-up window. A win is declared if the treated subject experiences a better outcome—typically defined as longer survival or, if tied on survival, fewer or later nonfatal events.\nFormally, let \\(D_i^{(a)}, T_i^{(a)}, C_i^{(a)}\\) denote survival, hospitalization, censoring times on \\(i\\)th subject in group \\(a\\) \\((i=1,\\ldots, N_a; a= 1, 0)\\). Then the win fraction for group \\(a\\) versus \\(1-a\\) is \\[\n\\hat w^{(a, 1-a)} = \\frac{1}{N_1N_0} \\sum_{i=1}^{N_a} \\sum_{j=1}^{N_{1-a}} \\hat w^{(a, 1-a)}_{ij},\n\\] where \\[\\begin{align}\n            \\hat w^{(a, 1-a)}_{ij}&= \\underbrace{I(D_j^{(1-a)}&lt; D_i^{(a)}\\wedge C_i^{(a)}\\wedge C_j^{(1-a)})}_{\\mbox{win on survival}}\\\\\n            & + \\underbrace{I(\\min(D_i^{(a)}, D_j^{(1-a)}) &gt; C_i^{(a)}\\wedge C_j^{(1-a)}, T_j^{(1-a)}&lt; T_i^{(a)}\\wedge C_i^{(1)}\\wedge C_j^{(0)})}_{\\mbox{tie on survival, win on hospitalization}}\n    \\end{align}\\]\nThe win ratio statistic is defined as \\[\n\\text{WR} = \\frac{\\hat w^{(1, 0)}}{\\hat w^{(0, 1)}}.\n\\]\nAlternative summaries include the net benefit (proportion in favor) and the win odds, which account for ties and interpret the WR on a log-odds scale. In the special case of binary outcomes, the WR reduces to the odds ratio, and the net benefit corresponds to the risk difference.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#hypothesis-testing-and-interpretation",
    "href": "testing.html#hypothesis-testing-and-interpretation",
    "title": "2  Hypothesis Testing",
    "section": "2.2 Hypothesis Testing and Interpretation",
    "text": "2.2 Hypothesis Testing and Interpretation\nStatistical inference for the WR is based on the asymptotic normality of the log win ratio: \\[\nS_n = \\frac{\\sqrt{n} \\log(\\hat w_{1,0} / \\hat w_{0,1})}{\\hat{\\rm SE}} \\sim N(0, 1),\n\\] under the null hypothesis that treatment and control are equally effective. The standard error \\(\\hat{\\rm SE}\\) is calculated via \\(U\\)-statistics, and the null corresponds to equal bivariate survival functions \\(H^{(1)}(s, t) = H^{(0)}(s, t)\\) for all \\(t \\le s\\).\nThe alternative hypothesis assumes that the probability of a treatment win exceeds that of a control win at all times. A sufficient condition is that the joint distribution of death and nonfatal events under treatment is stochastically larger than under control.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#extensions-and-variants",
    "href": "testing.html#extensions-and-variants",
    "title": "2  Hypothesis Testing",
    "section": "2.3 Extensions and Variants",
    "text": "2.3 Extensions and Variants\nSeveral extensions of the WR improve its flexibility and robustness. Weighted comparisons allow later follow-up times to contribute more to the test statistic, leading to log-rank-type weights. Stratified WR methods compare subjects within strata to adjust for confounding and increase efficiency.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#generalization-to-recurrent-events",
    "href": "testing.html#generalization-to-recurrent-events",
    "title": "2  Hypothesis Testing",
    "section": "2.4 Generalization to Recurrent Events",
    "text": "2.4 Generalization to Recurrent Events\nWhen subjects experience multiple nonfatal events, a generalized WR can be defined using a win function \\(\\mathcal{W}(\\cdot, \\cdot)(t)\\) that compares event histories up to time \\(t\\). The generalized win ratio statistic becomes \\[\n\\hat{\\mathcal E}_n(\\mathcal W) = \\frac{\\sum \\mathcal W(\\mathcal H^{*(1)}_i, \\mathcal H^{*(0)}_j)}\n     {\\sum \\mathcal W(\\mathcal H^{*(0)}_j, \\mathcal H^{*(1)}_i)},\n\\] where comparisons are made up to the minimum of each pair’s observed follow-up time.\nThree versions of recurrent-event win functions are commonly used:\n\nNaive WR: prioritize death, then total number of events\nFirst-event WR: further prioritize time to first event\nLast-event WR: further prioritize time to last event\n\nAll versions enforce a win/loss/tie rule based on observable history, and guarantee that win status is unchanged after death. Among them, the last-event WR (LWR) has shown superior power in simulation studies due to fewer ties and better separation between subjects.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#hf-action-example",
    "href": "testing.html#hf-action-example",
    "title": "2  Hypothesis Testing",
    "section": "2.5 HF-ACTION Example",
    "text": "2.5 HF-ACTION Example\nIn the HF-ACTION trial, recurrent-event WR methods were applied to a high-risk subgroup of 426 patients. Compared to usual care, exercise training reduced both mortality and hospitalizations. The last-event WR was estimated as 1.32 (95% CI: 1.05–1.66, p = 0.019), with similar results from first-event and naive WRs.\n\n\n\n\n\nThese results illustrate that recurrent-event WRs detect benefits more effectively than traditional time-to-first-event WRs, especially when the number and timing of nonfatal events vary widely across subjects.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#sample-size-calculation",
    "href": "testing.html#sample-size-calculation",
    "title": "2  Hypothesis Testing",
    "section": "2.6 Sample Size Calculation",
    "text": "2.6 Sample Size Calculation\nSample size calculation for WR is based on a joint model for death and nonfatal events. Under a Gumbel–Hougaard copula model, the joint survival function is \\[\n        \\pr(D^\\a&gt;s, T_1^\\a&gt;t) = \\exp\\left(-\\left[\\{\\exp(a\\xi_D)\\lambda_Ds\\}^\\kappa + \\{\\exp(a\\xi_H)\\lambda_Ht\\}^\\kappa \\right]^{1/\\kappa}\\right)\n\\] where \\(\\lambda_D^a\\) and \\(\\lambda_H^a\\) are arm-specific baseline hazard rates and \\(\\kappa\\) controls the dependence between outcomes.\nThe required sample size is \\[\nn = \\frac{\\zeta_0^2(z_{1-\\alpha/2} + z_\\gamma)^2}{q(1-q)\\delta^\\top \\xi},\n\\] where:\n\n\\(\\zeta_0^2\\) is the variance of the test statistic under the null,\n\\(\\delta\\) is the sensitivity of the log-WR to changes in log-HRs \\(\\xi\\),\n\\(q\\) is the treatment allocation proportion.\n\nDesign parameters include the accrual duration \\(\\tau_b\\), total follow-up time \\(\\tau\\), and a random loss-to-follow-up rate \\(\\lambda_L\\).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#hf-action-planning-a-new-trial",
    "href": "testing.html#hf-action-planning-a-new-trial",
    "title": "2  Hypothesis Testing",
    "section": "2.7 HF-ACTION: Planning a New Trial",
    "text": "2.7 HF-ACTION: Planning a New Trial\nUsing HF-ACTION training arm data as historical reference, the estimated baseline rates were:\n\n\\(\\lambda_D = 0.073\\) deaths/year\n\\(\\lambda_H = 0.56\\) hospitalizations/year\nKendall’s correlation = 36.1%\n\nAssuming HRs of 0.9 (death) and 0.8 (hospitalization), and minimal loss to follow-up, the sample size required for 80% power is approximately \\(n = 1241\\).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#example-r-code",
    "href": "testing.html#example-r-code",
    "title": "2  Hypothesis Testing",
    "section": "2.8 Example R code",
    "text": "2.8 Example R code\nThe following example uses a data frame df in long format with columns:\n\nid: subject identifier\n\ntime: event or censoring time\n\nstatus: event type (0 = censoring, 1 = death, 2 = nonfatal)\n\ntrt: treatment group (0 = control, 1 = treatment)\n\nstrata: optional stratification variable\n\n\n########################################\n# 1. WR test for recurrent events\n########################################\nlibrary(WR)\n\nobj &lt;- WRrec(ID = df$id, time = df$time, status = df$status, \n             trt = df$trt, strata = df$strata, naive = TRUE)\n\n# Extract log win ratio and standard error\nobj$log.WR\nobj$se\nprint(obj)\n\n\n########################################\n# 2. Sample size calculation\n########################################\n# Step 1: Estimate baseline outcome parameters\nbase_est &lt;- gumbel.est(id = df$id, time = df$time, status = df$status)\n\n# Step 2: Design-specific noise and signal\nbparam &lt;- base(lambda_D = base_est$lambda_D,\n               lambda_H = base_est$lambda_H,\n               kappa = base_est$kappa,\n               tau_c = 3, tau = 4, lambda_L = 0.001)\n\n# Step 3: Required sample size for given effect sizes\nWRSS(xi = log(c(0.9, 0.8)), bparam = bparam, q = 0.5, power = 0.8)$n",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "testing.html#conclusion",
    "href": "testing.html#conclusion",
    "title": "2  Hypothesis Testing",
    "section": "2.9 Conclusion",
    "text": "2.9 Conclusion\nThe win ratio test provides a clinically meaningful and statistically valid method for analyzing prioritized composite outcomes. By extending to recurrent events and general win functions, the WR accommodates complex patient trajectories while preserving interpretability. Among several extensions, the last-event WR offers strong separation and improved power in trials with repeated nonfatal events.\nSample size formulas grounded in copula models enable principled trial design. The WR package supports both estimation and power analysis, facilitating the broader adoption of win-based strategies in modern clinical research.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Hypothesis Testing</span>"
    ]
  },
  {
    "objectID": "chap3.html#outline",
    "href": "chap3.html#outline",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Outline",
    "text": "Outline\n\nRestricted win ratio\n\nWR estimand under fixed time frame (WINS package)\n\nRestricted mean time in favor of treatment\n\nAn extension of RMST\nHF-ACTION example (rmt package)\n\nWhile alive analysis of weighted total events\n\nAdjusts for duration of survival\nHF-ACTION example (WA package)\n\n\\[\\newcommand{\\d}{{\\rm d}}\\] \\[\\newcommand{\\T}{{\\rm T}}\\] \\[\\newcommand{\\dd}{{\\rm d}}\\] \\[\\newcommand{\\cc}{{\\rm c}}\\] \\[\\newcommand{\\pr}{{\\rm pr}}\\] \\[\\newcommand{\\var}{{\\rm var}}\\] \\[\\newcommand{\\se}{{\\rm se}}\\] \\[\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\\] \\[\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\\] \\[\n    \\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n    \\] \\[\n    \\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n    \\] \\[ \\def\\a{{(a)}} \\def\\b{{(1-a)}} \\def\\t{{(1)}} \\def\\c{{(0)}} \\def\\d{{\\rm d}} \\def\\T{{\\rm T}} \\def\\bs{\\boldsymbol}\n    \\]"
  },
  {
    "objectID": "chap3.html#the-estimand-issue",
    "href": "chap3.html#the-estimand-issue",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "The Estimand Issue",
    "text": "The Estimand Issue\n\nWR estimand depends on censoring\n\nMixing different time frames \\([0, C_i^\\t\\wedge C_j^\\c]\\) in win-loss calculations\nCensoring-weighted average of time-dependent win-loss (Ch 2) \\[\n\\frac{\\hat w_{1,0}}{\\hat w_{0,1}}\\to\n\\frac{\\int_0^\\infty\\pr(\\mbox{Treatment wins by } t)\\dd G(t)}\n{\\int_0^\\infty\\pr(\\mbox{Control wins by } t)\\dd G(t)}\n\\]\n\n\\(G(t)\\): Distribution function of \\(C^\\t\\wedge C^\\c\\)\n\nTrial-dependent; lacks generalizability\n\nTwo ways to construct estimand (Ch 1)\n\nPre-define restriction time\nSpecify a time-constant WR model (Ch 4)"
  },
  {
    "objectID": "chap3.html#time-restriction---univariate",
    "href": "chap3.html#time-restriction---univariate",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Time Restriction - Univariate",
    "text": "Time Restriction - Univariate\n\nOutcome data\n\n\\(D^\\a\\): survival time for a patient in group \\(a = 1, 0\\)\n\n\\(S^\\a(t) = P(D^\\a&gt;t)\\)\n\n\nTime restriction: a familiar concept\n\nFive-year survival rate of breast cancer patients\n\nEstimand: \\(S^\\t(\\tau) - S^\\c(\\tau)\\)\n\nFive-year average survival time\n\nEstimand: \\(E\\{\\min(D^\\t, \\tau)\\} - E\\{\\min(D^\\c, \\tau)\\}\\)\nRestricted mean survival time (RMST) (Tian et al., 2020)\n\nRestriction time \\(\\tau=5\\) years (pre-specify)"
  },
  {
    "objectID": "chap3.html#time-restriction---wr",
    "href": "chap3.html#time-restriction---wr",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Time Restriction - WR",
    "text": "Time Restriction - WR\n\nTwo-tiered composite\n\n\\(D^\\a\\): survival time; \\(T_1^\\a\\): time to first nonfatal event\n\nRestricted win/loss probability\n\nImage all patients followed up to \\(\\tau\\) \\[\\begin{align}\\label{eq:wl_2comp}\nw_{a, 1-a}(\\tau) &=  \\underbrace{\\pr\\{D^\\b &lt; \\min(D^\\a, \\tau)\\}}_{\\mbox{win on survival}}\\\\\n& +\n\\underbrace{\\pr\\{\\min(D^\\t, D^\\c) &gt; \\tau, T^\\b &lt; \\min(T^\\a, \\tau)\\}}_{\\mbox{tie on survival, win on nonfatal event}}\n\\end{align}\\]\nRestricted (Pocock) WR: \\({\\rm WR}(\\tau)=w_{1, 0}(\\tau)/w_{0, 1}(\\tau)\\)"
  },
  {
    "objectID": "chap3.html#estimation-ipcw-or-mi",
    "href": "chap3.html#estimation-ipcw-or-mi",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Estimation: IPCW or MI",
    "text": "Estimation: IPCW or MI\n\nGeneral win function\n\nWin/loss probability by \\(t\\) \\[\nw_{a, 1-a}(\\tau)=\\pr\\left\\{\\mathcal W(\\mathcal H^{*{(a)}}, \\mathcal H^{*{(1-a)}})(\\tau)=1\\right\\}\n\\]\n\nEstimation: deal with data censored before \\(\\tau\\)\n\nInverse probability censoring weighting (IPCW, Dong et al., 2020b, 2021)\n\nR-package: WINS (Cui & Huang, 2023)\n\nMultiple imputations (MI) for censored/missing data (Wang et al., 2023, 2024)"
  },
  {
    "objectID": "chap3.html#a-variation-of-rwr",
    "href": "chap3.html#a-variation-of-rwr",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "A Variation of RWR",
    "text": "A Variation of RWR\n\nTake time difference into account\n\n\\(w_{a, 1-a}(\\tau)\\): win probability by \\(\\tau\\) \\[\n   w_{1, 0}(\\tau) - w_{0, 1}(\\tau) =  \\mbox{Restricted proportional in favor (net benefit)}\n\\]\n\\(w_{a, 1-a}(\\tau)\\): re-define as average win time by \\(\\tau\\) \\[\nw_{1, 0}(\\tau) - w_{0, 1}(\\tau) = \\mbox{Restricted mean time in favor (RMT-IF)}\n\\]\n\nRMT-IF\n\nMeasures net average time treatment wins against control\nConvenient with multistate outcomes"
  },
  {
    "objectID": "chap3.html#multistate-outcomes",
    "href": "chap3.html#multistate-outcomes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Multistate Outcomes",
    "text": "Multistate Outcomes\n\nReformulate outcomes\n\nMultistate process: \\(Y(t) \\in \\{0, 1,\\ldots, K, \\infty\\}\\)\n\n\\(0\\): initial state (e.g., remission, event-free)\n\\(1, \\ldots, K\\): a series of progressively worse states\n\\(\\infty\\): death\n\nExamples\n\n\\(1\\): relapse; \\(2\\): metastasis\n\\(1, 2, \\ldots\\): cumulative number of hospitalizations"
  },
  {
    "objectID": "chap3.html#time-on-a-win-or-loss",
    "href": "chap3.html#time-on-a-win-or-loss",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Time on a Win or Loss",
    "text": "Time on a Win or Loss\n\nPairwise win-loss time\n\n\\(Y^\\t(t)\\) vs \\(Y^\\c(t)\\) over \\([0, \\tau]\\)\nWin time \\(=\\) time residing in a lower-tiered state \\[\nW^{(a, 1-a)}(\\tau)=\\int_0^\\tau I\\{Y^\\a(t)&lt;Y^\\b(t)\\}\\d t\n\\]"
  },
  {
    "objectID": "chap3.html#net-average-win-time",
    "href": "chap3.html#net-average-win-time",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Net Average Win Time",
    "text": "Net Average Win Time\n\nEtimand of treatment effect\n\nRMT-IF of treatment (Mao, 2023b) \\[\n\\mu(\\tau) = w_{1, 0}(\\tau) - w_{0, 1}(\\tau)\n\\]\n\nAverage win time: \\(w_{a, 1-a}(\\tau) = E\\{W^{(a, 1-a)}(\\tau)\\}\\)\n\n\\(\\mu(\\tau)\\): net average win time by treatment vs control\n\nReduces to difference in RMST in life-death model\n\nDecomposition: Time won on which component?\n\nExtra survival time + extra relapse-free time + …"
  },
  {
    "objectID": "chap3.html#decomposition",
    "href": "chap3.html#decomposition",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Decomposition",
    "text": "Decomposition\n\nStage-wise effects \\(\\mu(\\tau) = \\sum_{k=1}^{K,\\infty} \\mu_k(\\tau)\\)\n\nAverage win time on state \\(k\\) (being in a better state) \\[w_{a, 1-a, k}(\\tau)=E\\left\\{\\int_0^\\tau I\\{Y^{(a)}(t)&lt;Y^{(1-a)}(t) = k\\}{\\rm d}t\\right\\}\\]\nNet average win time on state \\(k\\) \\[\n\\mu_k(\\tau)=w_{1, 0, k}(\\tau) - w_{0, 1, k}(\\tau)\n  \\]\n\n\\(\\mu_\\infty(\\tau)\\): net win time on survival \\(=\\) difference in \\(\\tau\\)-RMST\n\\(\\mu_2(\\tau)\\): extra metastasis-free time; \\(\\mu_1(\\tau)\\): extra relapse-free time\n\nFurther decomposition (Mao & Wang, 2024)\n\n\\(\\mu_k(\\tau)=\\sum_{j &lt; k}\\mu_{jk}(\\tau)\\): net average time improved from state \\(k\\) to state \\(j\\)\n\\(\\mu_\\infty(\\tau)=\\mu_{0,\\infty}(\\tau)+ \\mu_{1,\\infty}(\\tau)+\\mu_{2,\\infty}(\\tau)\\): net survival time in different states"
  },
  {
    "objectID": "chap3.html#simplify-for-progressive-processes",
    "href": "chap3.html#simplify-for-progressive-processes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Simplify for Progressive Processes",
    "text": "Simplify for Progressive Processes\n\nProgressive process\n\nDefinition: \\(Y^{(a)}(t)\\leq Y^{(a)}(s)\\) for all \\(0\\leq t\\leq s\\)\n\nOnly marching forward (all earlier examples)\n\nTransition time \\(T_k^{(a)}\\): time to transition to a state \\(\\geq k\\)\n\n\\(T_1^{(a)}\\): time to relapse/metastasis/death\n\\(T_2^{(a)}\\): time to metastasis/death\n\\(T_\\infty^{(a)}=D^{(a)}\\): time to death\n\nReformulation: \\(Y^{(a)}(\\cdot)\\equiv \\big\\{0\\leq T_1^{(a)}\\leq\\cdots\\leq T_K^{(a)}\\leq T_\\infty^{(a)}\\big\\}\\)\n\nA progressive process \\(\\Longleftrightarrow\\) a sequence of transition events"
  },
  {
    "objectID": "chap3.html#delve-into-estimand",
    "href": "chap3.html#delve-into-estimand",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Delve into Estimand",
    "text": "Delve into Estimand\n\nAverage win time on state \\(k\\)\n\nRe-expression with \\(S_k^{(a)}(t)=\\pr\\{T_k^{(a)}&gt; t\\}\\) \\[\\begin{align}\nw_{a, 1-a, k}(\\tau)&=\\int_0^\\tau \\pr\\{Y^{(a)}(t)&lt; k\\}\\pr\\{Y^{(1-a)}(t) = k\\}{\\rm d}t\\\\\n&=\\int_0^\\tau \\pr\\{T_k^{(a)}&gt; t\\}\\pr\\{T_k^{(1-a)}\\leq t &lt; T_{k+1}^{(1-a)}\\}{\\rm d}t\\\\\n&=\\int_0^\\tau S_k^{(a)}(t)\\left\\{S_{k+1}^{(1-a)}(t) - S_k^{(1-a)}(t)\\right\\}{\\rm d}t\\\\\n\\end{align}\\]\nNet average win time \\[\\mu_k(\\tau)=w_{1, 0, k}(\\tau)-w_{0, 1, k}(\\tau)=\n  \\int_0^\\tau \\left\\{S_k^{(1)}(t)S_{k+1}^{(0)}(t) - S_k^{(0)}(t)S_{k+1}^{(1)}(t)\\right\\}{\\rm d}t\\]"
  },
  {
    "objectID": "chap3.html#observed-data-estimation",
    "href": "chap3.html#observed-data-estimation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Observed Data & Estimation",
    "text": "Observed Data & Estimation\n\nCensored observations\n\n\\(Y(t\\wedge C)\\), or \\[\n  (X_k^{(a)}, \\delta_k^{(a)}),\\,\\,\\, k =1,\\ldots, K, \\infty\n  \\]\n\n\\(X_k^{(a)}= \\min(T_k^{(a)}, C^{(a)})\\); \\(\\delta_k^{(a)}= I(T_k^{(a)}\\leq C^{(a)})\\); \\(C^{(a)}=\\) censoring time\n\n\nEstimation\n\nPlug-in KM estimator \\(\\hat S_k^{(a)}(t)\\) \\[\n\\hat\\mu_k(\\tau)=\n  \\int_0^\\tau \\left\\{\\hat S_k^{(1)}(t)\\hat S_{k+1}^{(0)}(t) - \\hat S_k^{(0)}(t)\\hat S_{k+1}^{(1)}(t)\\right\\}{\\rm d}t\n\\]\nRobust variance estimator for \\(\\hat\\mu_k(\\tau)\\)"
  },
  {
    "objectID": "chap3.html#hypothesis-testing",
    "href": "chap3.html#hypothesis-testing",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Hypothesis Testing",
    "text": "Hypothesis Testing\n\nTest of overall effect\n\n\\(\\chi_1^2\\) test based on \\(\\hat\\mu(\\tau)=\\sum_{k=1}^{K,\\infty}\\hat\\mu_k(\\tau)\\) for \\[\nH_0: \\mu(\\tau)= 0\n\\]\n\nJoint test on components\n\n\\(\\chi_{K+1}^2\\) test based on \\(\\hat\\mu_1(\\tau),\\ldots,\\hat\\mu_K(\\tau),\\hat\\mu_\\infty(\\tau)\\) \\[\nH_0: \\mu_1(\\tau)=\\cdots=\\mu_K(\\tau)=\\mu_\\infty(\\tau)\n\\]\n\nMay be more powerful under differential component-wise effects\nTest individual components for secondary analyses"
  },
  {
    "objectID": "chap3.html#sample-size-calculation",
    "href": "chap3.html#sample-size-calculation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Sample Size Calculation",
    "text": "Sample Size Calculation\n\nBivariate illness-death\n\nGumbel–Hougaard copula (Mao, 2023c)\n\nSame model used for sample size calculation for WR\n\nInput parameters\n\nBaseline: Hazards for death & relapse, association parameter\nEffect sizes: Component-wise hazard ratios\n\n\nRecurrent events with death\n\nHomogeneous Markov model (Mao, 2023d)\nInput parameters\n\nBaseline: Intensities for another hospitalization or death, having had \\(k-1\\) hospitalizations \\((k=1,2,\\ldots)\\)\nEffect sizes: Intensity (risk) ratios for all transitions"
  },
  {
    "objectID": "chap3.html#software-rmtrmtfit-i",
    "href": "chap3.html#software-rmtrmtfit-i",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: rmt::rmtfit() (I)",
    "text": "Software: rmt::rmtfit() (I)\n\nInput data format (long)\n\nStandard multistate\n\nstatus = k for entry into state \\(k\\), K+1 for death, 0 for censoring\n\nRecurrent events with death\n\nstatus = 1 for nonfatal event, 2 for death, 0 for censoring\n\n\n\n\ndata(hfaction)\nhead(hfaction) # right coding for status\n#&gt;       patid       time status trt_ab age60\n#&gt;  HFACT00001 0.60506502      1      0     1\n#&gt;  HFACT00001 1.04859685      0      0     1\n#&gt;  HFACT00002 0.06297057      1      0     1\n#&gt;  HFACT00002 0.35865845      1      0     1\n#&gt;  HFACT00002 0.39698836      1      0     1\n#&gt;  HFACT00002 3.83299110      0      0     1\n#&gt;  ..."
  },
  {
    "objectID": "chap3.html#software-rmtrmtfit-ii",
    "href": "chap3.html#software-rmtrmtfit-ii",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: rmt::rmtfit() (II)",
    "text": "Software: rmt::rmtfit() (II)\n\nBasic syntax\n\n\n\nlibrary(rmt)\n# trt: binary treatment\nobj &lt;- rmtfit(id, time, status, trt, \n              type = c(\"multistate\", \"recurrent\"))\n\n\n\nOutput: a list of class rmtfit\n\nobj$t: \\(t\\); obj$mu: a matrix of \\((K+2)\\) rows, \\(\\hat\\mu_k(t)\\) in \\(k\\)th row, \\(\\hat\\mu(t)\\) in last; obj$var: variances of point estimates in mu\nsummary(obj, tau) for summary results on \\(\\mu(\\tau)\\), including the \\(\\mu_k(\\tau)\\)\n\nRecurrent events: specify Kmax = k to merge \\(\\mu_{k+}(\\tau)\\sum_{k'=k}^K=\\mu_{k'}(\\tau)\\)\n\nplot(obj) to plot \\(\\hat\\mu(t)\\) against \\(t\\)"
  },
  {
    "objectID": "chap3.html#hf-action-standard-analyses",
    "href": "chap3.html#hf-action-standard-analyses",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Standard Analyses",
    "text": "HF-ACTION: Standard Analyses\n\nTraditional composite and overall survival"
  },
  {
    "objectID": "chap3.html#r-code",
    "href": "chap3.html#r-code",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "R-Code",
    "text": "R-Code\n\nFit 4y-RMT-IF\n\n\nobj &lt;- rmtfit(hfaction$patid, hfaction$time, hfaction$status, hfaction$trt_ab, \n              type = \"recurrent\")\nsummary(obj, Kmax = 4, tau = 3.97) ## combine recurrent events &gt;= 4\n# Restricted mean time in favor of group \"1\" by time tau = 3.97:\n#   Estimate    Std.Err Z value Pr(&gt;|z|)    \n# Event 1   0.0140515  0.0498836  0.2817 0.778184    \n# Event 2   0.0358028  0.0499618  0.7166 0.473619    \n# Event 3   0.1385287  0.0409533  3.3826 0.000718 ***\n# Event 4+ -0.0064731  0.0600813 -0.1077 0.914203    \n# Survival  0.2384169  0.1143484  2.0850 0.037069 *  \n# Overall   0.4203268  0.1777363  2.3649 0.018035 *"
  },
  {
    "objectID": "chap3.html#graphics",
    "href": "chap3.html#graphics",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Graphics",
    "text": "Graphics\n\n\\(\\hat\\mu(t)\\) as a function of \\(t\\)\n\nOverall RMT-IF becomes significant after 1 year (see lower CL)\n\n\nplot(obj, conf = TRUE, conf.col = \"gray\", lwd = 2, xlab=\"t (years)\",\n     ylab = \"expression(mu(t))\")"
  },
  {
    "objectID": "chap3.html#inference-results",
    "href": "chap3.html#inference-results",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Inference Results",
    "text": "Inference Results\n\n4-year RMT-IF of exercise training\n\nTraining on average gains 5.1 months (\\(P\\)=0.018) in favorable state\n\n2.9 months net survival \\(+\\) 2.2 months net time with fewer hosps (little effect on 1st)\n\n\n\n\n\n\n\nTable 1: Analysis of 4-year RMT-IF of exercise training in HF-ACTION trial.\n\n\n\n\n\n\n\n\nEstimate\nSE\nP-value\n\n\n\n\nHopitalization\n\n2.18\n1.22\n0.073\n\n\n\n1\n0.17\n0.60\n0.778\n\n\n\n2\n0.43\n0.60\n0.474\n\n\n\n3\n1.66\n0.49\n&lt;0.001\n\n\n\n4+\n-0.08\n0.72\n0.914\n\n\nDeath\n\n2.86\n1.37\n0.037\n\n\nOverall\n\n5.04\n2.13\n0.018"
  },
  {
    "objectID": "chap3.html#length-of-exposure",
    "href": "chap3.html#length-of-exposure",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Length of Exposure",
    "text": "Length of Exposure\n\nHF-ACTION\n\nTrained survive longer \\(\\to\\) more hospitalizations\n\n\n\n\n\n\n\n\n\n\n\nUsual care (N = 221)\nExercise training (N = 205)\n\n\n\n\nDeath\n57 (25.8%)\n36 (17.6%)\n\n\nAvg # hospitalization (SD)\n2.6 (3.1)\n2.2 (3.1)\n\n\n\n\nImpact of differential survival time\n\nHierarchical: WR, RMT-IF (death &gt; nonfatal)\n\nHospitalizations considered only with tied (equal) survival\n\nQuantitative weighting: cumulative mean (death = \\(w_D\\times\\) nonfatal; Ch 1)\n\nNeed to adjust for length of exposure (survival)"
  },
  {
    "objectID": "chap3.html#weighted-endpoints",
    "href": "chap3.html#weighted-endpoints",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Weighted Endpoints",
    "text": "Weighted Endpoints\n\nWeighted composite event process (Ch 1)\n\n\\(N^{*\\a}_{\\rm R}(t)=w_DN^{*\\a}_D(t)+\\sum_{k=1}^Kw_kN^{*\\a}_k(t)\\)\n\n\\({\\rm d}N_{\\rm R}^{*(a)}(t)=0\\) for \\(t&gt;D^{(a)}\\): no event after death \n\n\nTraditional methods\n\nCause-specific rate (death as censoring): \\(E\\left\\{{\\rm d}N_{\\rm R}^{*(a)}(t)\\mid D^{(a)}\\geq t\\right\\}\\)\n\nLacking in causal interpretation: \\(\\left\\{\\cdot\\mid D^\\t\\geq t\\right\\}\\) vs \\(\\left\\{\\cdot\\mid D^\\c\\geq t\\right\\}\\) at post-randomization \\(t\\)\n\nCumulative mean: \\(E\\left\\{N_{\\rm R}^{*(a)}(t)\\right\\}\\) (Ghosh & Lin, 2000; Mao & Lin, 2016)\n\nIgnores length of exposure"
  },
  {
    "objectID": "chap3.html#exposure-adjusted-rate",
    "href": "chap3.html#exposure-adjusted-rate",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Exposure-Adjusted Rate",
    "text": "Exposure-Adjusted Rate\n\nWhile-alive event rate\n\nEstimand \\[\\ell^{(a)}(\\tau) = \\frac{E\\left\\{N_{\\rm R}^{*(a)}(\\tau)\\right\\}}{E\\left(D^{(a)}\\wedge\\tau\\right)}\n=\\frac{\\mbox{Mean # of weighted events by $\\tau$}}{\\mbox{Mean survival time by $\\tau$}}\n\\]\nAverage (weighted) event rate in \\([0, \\tau]\\) per person-time alive\nProposed as a clinically interpretable measure to Committee for Medicinal Products for Human Use (CHMP) of European Medicines Agency (Akacha et al., 2018; CHMP, 2020)\n\nAlso called “exposure-weighted” event rate"
  },
  {
    "objectID": "chap3.html#general-estimands-definition",
    "href": "chap3.html#general-estimands-definition",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "General Estimands: Definition",
    "text": "General Estimands: Definition\n\nWhile-alive loss rate\n\nEstimand (Mao, 2023a) \\[\\ell^{(a)}(\\tau) = \\frac{E\\left\\{\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(\\tau)\\right\\}}{E\\left(D^{(a)}\\wedge\\tau\\right)}\\]\n\n\\(\\mathcal H^{*{(a)}}(t)=\\left\\{N^{*{(a)}}_D(u), N^{*{(a)}}_1(u), \\ldots, N^{*{(a)}}_K(u):0\\leq u\\leq t\\right\\}\\)\n\n\\(\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(t)\\): user-specified loss function satisfying\n\nA function only of \\(\\mathcal H^{(a)}(t)\\)\n\\(\\mathcal L\\left(\\mathcal H^{*(a)}\\right)({\\rm d}t)\\equiv 0\\) for \\(t&gt;D^{(a)}\\) (accrue loss only when alive)\n\nAverage loss rate in \\([0, \\tau]\\) per person-time alive"
  },
  {
    "objectID": "chap3.html#general-estimands-examples",
    "href": "chap3.html#general-estimands-examples",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "General Estimands: Examples",
    "text": "General Estimands: Examples\n\nDifference choices of loss function\n\nOriginal while-alive event rate \\[\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(t) = N_{\\rm R}^{*(a)}(t)\\]\nPer-person-time mortality rate (Uno & Horiguchi, 2023) \\[\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(t) = N_D^{*(a)}(t)\\]\nMore generally… \\[\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(t)\n    = \\int_0^t \\left\\{w_{D, N^{*(a)}(u-)}(u)\\dd N^{*\\a}_D(t)+\\sum_{k=1}^Kw_{k, N^{*(a)}(u-)}(u)\\dd N^{*\\a}_k(t)\\right\\}\\]\n\n\\(w_{D,m}(u), w_{k,m}(u)\\): weights for incident death/nonfatal events at \\(u\\) with \\(m\\) existing events"
  },
  {
    "objectID": "chap3.html#cumulative-and-differentials",
    "href": "chap3.html#cumulative-and-differentials",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Cumulative and Differentials",
    "text": "Cumulative and Differentials\n\nCumulative version\n\nSurvival-completed cumulative loss \\[L^{(a)}(\\tau)=\\ell^{(a)}(\\tau)\\tau\\]\n\nBetter graphics: \\(\\ell^{(a)}(\\tau)\\approx 0/0\\) unstable for \\(\\tau\\approx 0\\)\nProperties: \\(L^{(a)}(0)=0\\), \\(L^{(a)}(t)\\uparrow\\) with \\(t\\), and \\(L^{(a)}(t)\\geq E\\{\\mathcal L(\\mathcal H^{(a)})(t)\\}\\)\n\n\nMeasuring treatment effect\n\nRisk (loss rate) ratio (RR): \\(r(\\tau)=\\ell^{(1)}(\\tau)/\\ell^{(0)}(\\tau)\\)\n\nTreatment reduces average loss rate by \\(100\\{1-r(\\tau)\\}\\%\\)\n\nAbsolute risk reduction: \\(d(\\tau)=\\ell^{(1)}(\\tau)-\\ell^{(0)}(\\tau)\\)\n\nTreatment reduces average loss rate by \\(-d(\\tau)\\) (per person-time alive)"
  },
  {
    "objectID": "chap3.html#nonparametric-estimation",
    "href": "chap3.html#nonparametric-estimation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Nonparametric Estimation",
    "text": "Nonparametric Estimation\n\nWith patients censored before \\(\\tau\\)\n\nSample averages for numerator/denominator \\[\\ell^{(a)}(\\tau) = \\frac{E\\left\\{\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(\\tau)\\right\\}}{E\\left(D^{(a)}\\wedge\\tau\\right)}\\]\nDenominator (easy): RMST \\(=\\int_0^\\tau S^{(a)}(t){\\rm d}t\\) (Royston & Parmar, 2011)\n\nPlug-in KM estimator\n\nNumerator (moderate) \\(=\\int_0^\\tau S^{(a)}(t-)E\\{\\mathcal L(\\mathcal H^{(a)})({\\rm d}t)\\mid D^{(a)}\\geq t\\}\\)\n\nNelsen-Aalen-type estimator for \\(E\\{\\mathcal L(\\mathcal H^{(a)})({\\rm d}t)\\mid D^{(a)}\\geq t\\}\\)\n\nRobust variance estimation\nImplementation in WA package"
  },
  {
    "objectID": "chap3.html#software-walrfit",
    "href": "chap3.html#software-walrfit",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WA::LRfit()",
    "text": "Software: WA::LRfit()\n\nBasic syntax\n\nid: unique patient identifier; time: event times; status: event types (1: recurrent event, 2: death, 0: censoring)\nDweight: weight for death relative to nonfatal\n\n\n\n\nlibrary(WA)\n# trt: categorical treatment\nobj &lt;- LRfit(id, time, status, trt, Dweight = 0)\n\n\n\nOutput: a list of class LRfit\n\nsummary(obj, tau) to summarize results for \\(r(\\tau)=\\ell^{(1)}(\\tau)/\\ell^{(0)}(\\tau)\\)\n\nAdd joint.test = TRUE to include joint test with RMST\n\nplot(obj) to plot the cumulative (WA) loss \\(L^\\a(t)\\) (\\(a= 1, 0\\))"
  },
  {
    "objectID": "chap3.html#hf-action-weighted-composite",
    "href": "chap3.html#hf-action-weighted-composite",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Weighted Composite",
    "text": "HF-ACTION: Weighted Composite\n\n4y-loss rate (death = \\(2\\times\\) hosp)\n\nRisk ratio: \\(79.8\\%\\) (\\(P=0.102\\)) reduction in risk\n\ncf. Cumulative mean ratio (unadjusted): 85.7% (\\(P=0.170\\)) (Ch 1)\n\n\n\n\nobj &lt;- LRfit(hfaction$patid, hfaction$time, hfaction$status, \n              hfaction$trt_ab, Dweight = 2)\nsummary(obj, tau = 3.97)\n# Analysis of log loss rate (LR) by tau = 3.97:\n#                Estimate   Std.Err Z value Pr(&gt;|z|)   \n# Ref (Group 0)  0.262765  0.086018  3.0548 0.002252 **\n# Group 1 vs 0  -0.226116  0.138131 -1.6370 0.101637 \n# ---\n# Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1\n\n# Point and interval estimates for the LR ratio:\n#               LR ratio 95% lower CL 95% higher CL\n# Group 1 vs 0 0.7976253    0.6084453      1.045626"
  },
  {
    "objectID": "chap3.html#hf-action-survival-adjustment",
    "href": "chap3.html#hf-action-survival-adjustment",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Survival Adjustment",
    "text": "HF-ACTION: Survival Adjustment\n\nSurvival-adjusted vs unadjusted cumulative loss\n\nUnadjusted shows attenuated effect"
  },
  {
    "objectID": "chap3.html#notes",
    "href": "chap3.html#notes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Notes",
    "text": "Notes\n\nAnalysis of win-loss times\n\nVariations including RMT-IF in comparison with WR (Troendle et al., 2024)\n\nWhile-alive estimands\n\nPapers following CHMP discussion (Fritsch et al., 2023; Schmidli et al., 2023a, 2023b; Wei et al., 2023)…\n\nRMT-IF vs WA in HF-ACTION\n\nRMT-IF appears more powerful \\(\\to\\) adds significance to mortality alone\n\n\\(P=0.037 \\to 0.018\\)\n\nWA still sees a dilution of effect\n\n\\(P=0.033 \\to 0.102\\)"
  },
  {
    "objectID": "chap3.html#summary",
    "href": "chap3.html#summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Summary",
    "text": "Summary\nNonparametric estimands by time restriction\n\nRestricted WR\n\nWR on all patients followed to \\(\\tau\\)\n\nIPCW (WINS) or MI\n\n\nRMT-IF\n\nNet average win time on hierarchical states by \\(\\tau\\)\n\nrmt::rmtfit(id, time, status, trt)\n\n\nWhile-alive weighted events\n\nCompensate for differential survival by \\(\\tau\\)\n\nWA::LRfit(id, time, status, trt, Dweight)"
  },
  {
    "objectID": "chap3.html#references",
    "href": "chap3.html#references",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "References",
    "text": "References\n\n\n\n\nAkacha, M., Binkowitz, B., Bretz, F., Fritsch, A., Hougaard, P., Jahn-Eimermacher, A., & al., et. (2018). Request for CHMP qualification opinion: Clinically interpretable treatment effect measures based on recurrent event endpoints that allow for efficient statistical analyses. http://www.ema.europa.eu/documents/other/qualification-opinion-treatment-effect-measures-when-using-recurrent-event-endpoints-applicants_en.pdf.\n\n\nCHMP. (2020). Qualification opinion of clinically interpretable treatment effect measures based on recurrent event endpoints that allow for efficient statistical analyses. https://www.ema.europa.eu/en/documents/other/qualification-opinion-clinically-interpretable-treatment-effect-measures-based-recurrent-event_en.pdf.\n\n\nCui, Y., & Huang, B. (2023). WINS: The r WINS package. https://CRAN.R-project.org/package=WINS\n\n\nDong, G., Huang, B., Wang, D., Verbeeck, J., Wang, J., & Hoaglin, D. C. (2021). Adjusting win statistics for dependent censoring. Pharmaceutical Statistics, 20(3), 440–450. https://doi.org/10.1002/pst.2086\n\n\nDong, G., Mao, L., Huang, B., Gamalo-Siebers, M., Wang, J., Yu, G., & Hoaglin, D. C. (2020b). The inverse-probability-of-censoring weighting (IPCW) adjusted win ratio statistic: an unbiased estimator in the presence of independent censoring. Journal of Biopharmaceutical Statistics, 30(5), 882–899. https://doi.org/10.1080/10543406.2020.1757692\n\n\nFritsch, A., Schlömer, P., Mendolia, F., Mütze, T., & Jahn-Eimermacher, A. (2023). Efficiency Comparison of Analysis Methods for Recurrent Event and Time-to-First Event Endpoints in the Presence of Terminal EventsApplication to Clinical Trials in Chronic Heart Failure. Statistics in Biopharmaceutical Research, 15(2), 268–279. https://doi.org/10.1080/19466315.2021.1945488\n\n\nGhosh, D., & Lin, D. Y. (2000). Nonparametric Analysis of Recurrent Events and Death. Biometrics, 56(2), 554–562. https://doi.org/10.1111/j.0006-341x.2000.00554.x\n\n\nMao, L. (2023a). Nonparametric Inference of General While-Alive Estimands for Recurrent Events. Biometrics, 79(3), 1749–1760. https://doi.org/10.1111/biom.13709\n\n\nMao, L. (2023b). On restricted mean time in favor of treatment. Biometrics, 79(1), 61–72. https://doi.org/10.1111/biom.13570\n\n\nMao, L. (2023c). Power and Sample Size Calculations for the Restricted Mean Time Analysis of Prioritized Composite Endpoints. Statistics in Biopharmaceutical Research, 15(3), 540–548. https://doi.org/10.1080/19466315.2022.2110936\n\n\nMao, L. (2023d). Study Design for Restricted Mean Time Analysis of Recurrent Events and Death. Biometrics, 79(4), 3701–3714. https://doi.org/10.1111/biom.13923\n\n\nMao, L., & Lin, D. Y. (2016). Semiparametric regression for the weighted composite endpoint of recurrent and terminal events. Biostatistics, 17(2), 390–403. https://doi.org/10.1093/biostatistics/kxv050\n\n\nMao, L., & Wang, T. (2024). Dissecting the restricted mean time in favor of treatment. Journal of Biopharmaceutical Statistics, 34(1), 111–126. https://doi.org/10.1080/10543406.2023.2210658\n\n\nRoyston, P., & Parmar, M. K. B. (2011). The use of restricted mean survival time to estimate the treatment effect in randomized clinical trials when the proportional hazards assumption is in doubt. Statistics in Medicine, 30(19), 2409–2421. https://doi.org/10.1002/sim.4274\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023a). Estimands for Recurrent Event Endpoints in the Presence of a Terminal Event. Statistics in Biopharmaceutical Research, 15(2), 238–248. https://doi.org/10.1080/19466315.2021.1895883\n\n\nSchmidli, H., Roger, J. H., & Akacha, M. (2023b). Rejoinder to Commentaries on “Estimands for Recurrent Event Endpoints in the Presence of a Terminal Event”. Statistics in Biopharmaceutical Research, 15(2), 255–256. https://doi.org/10.1080/19466315.2023.2166098\n\n\nTian, L., Jin, H., Uno, H., Lu, Y., Huang, B., Anderson, K. M., & Wei, L. (2020). On the empirical choice of the time window for restricted mean survival time. Biometrics, 76(4), 1157–1166. https://doi.org/10.1111/biom.13237\n\n\nTroendle, J. F., Leifer, E. S., Yang, S., Jeffries, N., Kim, D.-Y., Joo, J., & O’Connor, C. M. (2024). Use of win time for ordered composite endpoints in clinical trials. Statistics in Medicine, 43(10), 1920–1932. https://doi.org/10.1002/sim.10045\n\n\nUno, H., & Horiguchi, M. (2023). Ratio and difference of average hazard with survival weight: New measures to quantify survival benefit of new therapy. Statistics in Medicine, 42(7), 936–952. https://doi.org/10.1002/sim.9651\n\n\nWang, T., Li, Y., & Qu, Y. (2024). Restricted time win ratio: from estimands to estimation. Statistics in Biopharmaceutical Research, 1–18. https://doi.org/10.1080/19466315.2024.2332675\n\n\nWang, T., Zilinskas, R., Li, Y., & Qu, Y. (2023). Missing Data Imputation for a Multivariate Outcome of Mixed Variable Types. Statistics in Biopharmaceutical Research, 15(4), 826–837. https://doi.org/10.1080/19466315.2023.2169753\n\n\nWei, J., Mütze, T., Jahn-Eimermacher, A., & Roger, J. (2023). Properties of Two While-Alive Estimands for Recurrent Events and Their Potential Estimators. Statistics in Biopharmaceutical Research, 15(2), 257–267. https://doi.org/10.1080/19466315.2021.1994457"
  },
  {
    "objectID": "estimation.html",
    "href": "estimation.html",
    "title": "3  Nonparametric Estimation",
    "section": "",
    "text": "Slides\nChapter slides here. (To convert html to pdf, press E \\(\\to\\) Print \\(\\to\\) Destination: Save to pdf)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "estimation.html#restricted-win-ratio",
    "href": "estimation.html#restricted-win-ratio",
    "title": "3  Nonparametric Estimation",
    "section": "3.1 Restricted Win Ratio",
    "text": "3.1 Restricted Win Ratio\nThe win ratio estimand depends on the censoring distribution, as each pairwise comparison is limited to the observed follow-up \\([0, C_i^\\t \\wedge C_j^\\c]\\). This leads to a censoring-weighted average of time-specific win probabilities, which is trial-dependent and lacks generalizability. One solution is to pre-specify a restriction time \\(\\tau\\) so all comparisons are evaluated over the same window.\nFor a two-tiered composite of death and a nonfatal event, the restricted win/loss probability is defined by \\[\\begin{align}\nw_{a, 1-a}(\\tau) &= \\pr\\{D^\\b &lt; \\min(D^\\a, \\tau)\\} \\\\\n&\\quad + \\pr\\{\\min(D^\\t, D^\\c) &gt; \\tau, T^\\b &lt; \\min(T^\\a, \\tau)\\},\n\\end{align}\\] with the restricted win ratio defined as \\(\\text{WR}(\\tau) = w_{1,0}(\\tau) / w_{0,1}(\\tau)\\). Estimation methods include inverse probability of censoring weighting (IPCW) and multiple imputation (MI), as implemented in the WINS package.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "estimation.html#restricted-mean-time-in-favor-rmt-if",
    "href": "estimation.html#restricted-mean-time-in-favor-rmt-if",
    "title": "3  Nonparametric Estimation",
    "section": "3.2 Restricted Mean Time in Favor (RMT-IF)",
    "text": "3.2 Restricted Mean Time in Favor (RMT-IF)\nThe restricted mean time in favor (RMT-IF) redefines the win-loss comparison in terms of time spent in more favorable states. For a multistate outcome \\(Y(t)\\), RMT-IF measures the net average time one subject remains in a better state than another: \\[\n\\mu(\\tau) = E\\left[ \\int_0^\\tau I\\{Y^{(1)}(t) &lt; Y^{(0)}(t)\\} \\, \\dd t \\right]\n- E\\left[ \\int_0^\\tau I\\{Y^{(0)}(t) &lt; Y^{(1)}(t)\\} \\, \\dd t \\right].\n\\]\nThe process \\(Y(t)\\) is assumed progressive and represents a hierarchy of worsening states, terminating in death. The estimand \\(\\mu(\\tau)\\) admits a decomposition into component-specific effects: \\[\n\\mu(\\tau) = \\sum_{k=1}^K \\mu_k(\\tau) + \\mu_\\infty(\\tau),\n\\] where each \\(\\mu_k(\\tau)\\) captures net time gained in a specific nonfatal state and \\(\\mu_\\infty(\\tau)\\) captures the difference in restricted mean survival time. Estimation proceeds by plugging in Kaplan–Meier estimators for transition times. The rmt::rmtfit() function provides estimation, inference, and graphics.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "estimation.html#while-alive-weighted-loss",
    "href": "estimation.html#while-alive-weighted-loss",
    "title": "3  Nonparametric Estimation",
    "section": "3.3 While-Alive Weighted Loss",
    "text": "3.3 While-Alive Weighted Loss\nStandard analyses of weighted total events may misrepresent treatment effects if survival time differs between groups. The while-alive loss framework defines a normalized event rate over time alive: \\[\n\\ell^{(a)}(\\tau) = \\frac{E\\left\\{N_{\\rm R}^{*(a)}(\\tau)\\right\\}}{E\\left(D^{(a)} \\wedge \\tau\\right)}.\n\\]\nMore generally, the loss can be specified by a function \\(\\mathcal{L}(\\mathcal{H}^*(t))\\) that accumulates only during time alive. This leads to a class of estimands: \\[\n\\ell^{(a)}(\\tau) = \\frac{E\\left\\{\\mathcal L\\left(\\mathcal H^{*(a)}\\right)(\\tau)\\right\\}}{E\\left(D^{(a)} \\wedge \\tau\\right)},\n\\] which includes total events, mortality, and flexible weighted combinations. Estimation uses survival-weighted Aalen-type integrals and is implemented in the WA::LRfit() function.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "estimation.html#hf-action-illustrations",
    "href": "estimation.html#hf-action-illustrations",
    "title": "3  Nonparametric Estimation",
    "section": "3.4 HF-ACTION Illustrations",
    "text": "3.4 HF-ACTION Illustrations\nAll three approaches were applied to the HF-ACTION dataset:\n\nRestricted WR showed better interpretability than the original WR by standardizing follow-up to 4 years.\nRMT-IF detected a significant average gain of 5.1 months in the training group, driven by both survival and reduced hospitalizations.\nWhile-alive loss adjusted for differential follow-up and showed a 20% reduction in the average event rate, though the effect was attenuated compared to RMT-IF.\n\nEach method offers a distinct perspective:\n\nRMT-IF summarizes net benefit in time.\nWA analyses account for differential exposure.\nRestricted WR retains the pairwise framework but standardizes follow-up.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "estimation.html#example-r-code",
    "href": "estimation.html#example-r-code",
    "title": "3  Nonparametric Estimation",
    "section": "3.5 Example R code",
    "text": "3.5 Example R code\n\n# RMT-IF\nlibrary(rmt)\nobj &lt;- rmtfit(id, time, status, trt, type = \"recurrent\")\nsummary(obj, tau = 4)\n\n# While-alive loss (death = 2 × nonfatal)\nlibrary(WA)\nobj &lt;- LRfit(id, time, status, trt, Dweight = 2)\nsummary(obj, tau = 4)",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "estimation.html#conclusion",
    "href": "estimation.html#conclusion",
    "title": "3  Nonparametric Estimation",
    "section": "3.6 Conclusion",
    "text": "3.6 Conclusion\nRestricting follow-up time resolves many of the interpretability issues in standard composite endpoint analysis. The restricted win ratio, restricted mean time in favor, and while-alive loss rate each target clinically interpretable, time-standardized estimands. These tools are particularly helpful when survival times vary across groups, and should be considered complementary strategies in the analysis of composite outcomes.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Nonparametric Estimation</span>"
    ]
  },
  {
    "objectID": "chap4.html#outline",
    "href": "chap4.html#outline",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Outline",
    "text": "Outline\n\nProportional win-fractions (PW) model\n\nModel specification\n\nAn extension of Cox PH model and two-sample WR\n\nEstimation and residual analysis\nHF-ACTION example (WR package)\n\nHigh-dimensional data\n\nRegularization by elastic net\nHF-ACTION example (WRNet package)\n\n\n\\[\\newcommand{\\d}{{\\rm d}}\n\\newcommand{\\T}{{\\rm T}}\n\\newcommand{\\dd}{{\\rm d}}\n\\newcommand{\\cc}{{\\rm c}}\n\\newcommand{\\pr}{{\\rm pr}}\n\\newcommand{\\var}{{\\rm var}}\n\\newcommand{\\se}{{\\rm se}}\n\\newcommand{\\indep}{\\perp \\!\\!\\! \\perp}\n\\newcommand{\\Pn}{n^{-1}\\sum_{i=1}^n}\n\\newcommand\\mymathop[1]{\\mathop{\\operatorname{#1}}}\n\\newcommand{\\Ut}{{n \\choose 2}^{-1}\\sum_{i&lt;j}\\sum}\n\\def\\a{{(a)}}\n\\def\\b{{(1-a)}}\n\\def\\t{{(1)}}\n\\def\\c{{(0)}}\n\\def\\d{{\\rm d}}\n\\def\\T{{\\rm T}}\n\\def\\bs{\\boldsymbol}\n\\def\\C{{\\mathcal C}}\n\\def\\S{{\\mathcal S}}\n\\def\\Sk{{\\mathcal S}^{(k)}}\n\\newcommand{\\wh}{\\widehat}\n\\]"
  },
  {
    "objectID": "chap4.html#regression-framework",
    "href": "chap4.html#regression-framework",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Regression Framework",
    "text": "Regression Framework\n\nRegression vs two-sample\n\nAdjustment for confounding\nQuantitative predictors\nStatistical efficiency\nScreening of prognostic factors\n\nTreatment, demographics (e.g., age, race, sex), medical history (e.g., diabetes, prior CVD), current medication (e.g., \\(\\beta\\)-blocker, ACE inhibitor)\n\n\n\n\n\n\n\nUnivariate\nHierarchical composite\n\n\n\n\nHypothesis testing\nGehan, log-rank\nWin ratio/odds, net benefit (Ch 2)\n\n\nNonparametric estimation\nRMST\nRMT-IF (Ch 3)\n\n\nSemiparametric regression\nCox PH model\n?"
  },
  {
    "objectID": "chap4.html#win-ratio-regression",
    "href": "chap4.html#win-ratio-regression",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win Ratio Regression",
    "text": "Win Ratio Regression\n\nModeling target\n\nTwo independent subjects \\((\\mathcal H^*_i, Z_i)\\) and \\((\\mathcal H^*_j, Z_j)\\)\n\n\\(E\\{\\mathcal W(\\mathcal H^*_i,\\mathcal H^*_j)(t)\\mid Z_i, Z_j\\}\\): Conditional win fraction (probability) for \\(i\\) against \\(j\\) at \\(t\\)\n\\(E\\{\\mathcal W(\\mathcal H^*_j,\\mathcal H^*_i)(t)\\mid Z_i, Z_j\\}\\): Conditional win fraction (probability) for \\(j\\) against \\(i\\) at \\(t\\)\n\nCovariate-specific win ratio \\[\\begin{equation}\\label{eq:cov_spec_curtail_wr}\nWR(t; Z_i, Z_j;\\mathcal W):= \\frac{E\\{\\mathcal W(\\mathcal H^*_i,\\mathcal H^*_j)(t)\\mid Z_i,Z_j\\}}{E\\{\\mathcal W(\\mathcal H^*_j,\\mathcal H^*_i)(t)\\mid Z_i, Z_j\\}}\n\\end{equation}\\]\nRegress \\(WR(t; Z_i, Z_j;\\mathcal W)\\) vs \\((Z_i, Z_j)\\)\n\n\\(WR(t; Z_i, Z_j;\\mathcal W) \\geq 0\\)\n\\(WR(t; Z_i, Z_j;\\mathcal W) = WR(t; Z_j, Z_i;\\mathcal W)^{-1}\\)"
  },
  {
    "objectID": "chap4.html#model-specification",
    "href": "chap4.html#model-specification",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Model Specification",
    "text": "Model Specification\n\nProportional win-fractions (PW) model\n\nMultiplicative effects (Mao & Wang, 2021) \\[\\begin{equation}\\label{eq:wr_reg}\nWR(t\\mid Z_i, Z_j;\\mathcal W)=\\exp\\left\\{\\beta^{\\rm T}\\left(Z_i- Z_j\\right)\\right\\}\n\\end{equation}\\]\nPW: covariate-specific win/loss fractions proportional over time\n\nWR constant over time\n\n\\(\\beta\\): log-WR associated with unit increases in covariates (regardless of follow-up time)\nSemiparametric: Parametric covariate effects, nonparametric otherwise\nDenote model by PW(\\(\\mathcal W\\))\n\nStresses dependency on win function"
  },
  {
    "objectID": "chap4.html#special-cases",
    "href": "chap4.html#special-cases",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Special Cases",
    "text": "Special Cases\n\nTwo-sample WR\n\n\\(\\exp(\\beta)\\): WR comparing group \\(Z=1\\) with group \\(Z=0\\)\n\nCox PH model\n\nPW\\((\\mathcal W_{\\rm TFE})\\) \\(\\Leftrightarrow\\) Cox PH model on TFE \\(\\tilde T\\) \\[\n\\pr(t\\leq \\tilde T&lt;t+\\dd t\\mid \\tilde T\\geq t; Z) =\\exp(-\\beta^\\T Z)\\lambda_0(t)\\dd t\n\\]\n\nBivariate Lehmann model\n\nPW\\((\\mathcal W_{\\rm P})\\) \\(\\Leftarrow\\) Lehmann model on \\((D, T_1)\\) \\[\n\\pr(D&gt;s, T_1 &gt; t\\mid Z) = H_0(s, t)^{\\exp(-\\beta^\\T Z)}\n\\]\n\nPH on both \\(D\\) and \\(\\{T_1\\mid D\\}\\) with same HRs \\(\\exp(-\\beta)\\)"
  },
  {
    "objectID": "chap4.html#censored-data-and-win-residual",
    "href": "chap4.html#censored-data-and-win-residual",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Censored Data and Win Residual",
    "text": "Censored Data and Win Residual\n\nObserved outcomes\n\n\\(\\mathcal H^*(X_i)\\): outcomes up to \\(X_i=D_i\\wedge C_i\\)\nObserved win process \\(\\delta_{ij}(t)=\\mathcal W(\\mathcal H^*_i,\\mathcal H^*_j)(X_i\\wedge X_j\\wedge t)\\)\nDeterminacy (win or loss) indicator: \\(R_{ij}(t)=\\delta_{ij}(t)+\\delta_{ji}(t)\\)\n\nWin residuals\n\nDefinition \\[\\begin{equation}\\label{eq:wr:resid}\nM_{ij}(t\\mid Z_i, Z_j;\\beta)=\\underbrace{\\delta_{ij}(t)}_{\\rm observed\\,\\,win} -\n\\underbrace{R_{ij}(t)\\frac{\\exp\\left\\{\\beta^{\\rm T}\\left( Z_i- Z_j\\right)\\right\\}}{\n1+\\exp\\left\\{\\beta^{\\rm T}\\left(Z_i- Z_j\\right)\\right\\}}}_{\\rm model-based\\,\\, prediction}\n\\end{equation}\\]\n\\(E\\{M_{ij}(t\\mid Z_i, Z_j;\\beta)\\mid Z_i, Z_j\\} =0\\) for all \\(t\\)"
  },
  {
    "objectID": "chap4.html#estimation-and-inference",
    "href": "chap4.html#estimation-and-inference",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Estimation and Inference",
    "text": "Estimation and Inference\n\nEstimating equation\n\nSum of all possible pairs of covariate-/time-weighted residuals \\[\\begin{equation}\\label{eq:wr:ee}\n\\Ut\\int_0^\\infty (Z_i - Z_j) h(t; Z_i, Z_j)\\dd M_{ij}(t \\mid Z_i, Z_j;\\beta)=0\n\\end{equation}\\]\nWeight function \\(h(t; Z_i, Z_j)\\equiv 1\\)\nNewton-Raphson to get root \\(\\hat\\beta\\)\n\\(\\hat\\var(\\hat\\beta)\\): \\(U\\)-statistic variance"
  },
  {
    "objectID": "chap4.html#checking-proportionality",
    "href": "chap4.html#checking-proportionality",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Checking Proportionality",
    "text": "Checking Proportionality\n\nCumulative residuals\n\nRescaled \\(\\hat U_n(t)=\\Ut(Z_i - Z_j)M_{ij}(t \\mid Z_i, Z_j;\\hat\\beta)\\)\nSimilar to score processes in Cox model (Lin et al., 1993)"
  },
  {
    "objectID": "chap4.html#stratified-model",
    "href": "chap4.html#stratified-model",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Stratified Model",
    "text": "Stratified Model\n\nAddress non-proportionality\n\nCategorical predictor \\(\\to\\) stratifier\n\nStratified PW model\n\nIdea: within-stratum comparisons (Dong et al., 2017, 2023)\nModel specification (Wang & Mao, 2022) \\[\n\\frac{E\\{\\mathcal W(\\mathcal H^*_{li},\\mathcal H^*_{lj})(t)\\mid Z_{li},Z_{lj}\\}}{E\\{\\mathcal W(\\mathcal H^*_{lj},\\mathcal H^*_{li})(t)\\mid Z_{li}, Z_{lj}\\}} = \\exp\\left\\{\\beta^{\\rm T}\\left(Z_{li}- Z_{lj}\\right)\\right\\}\n\\]\n\n\\((H^*_{li}, Z_{li}), (H^*_{lj}, Z_{lj})\\): \\(i\\)th and \\(j\\)th outcome-covariates in \\(l\\)th stratum \\((l= 1,\\ldots, L)\\)\nProportionality required only within stratum, not between"
  },
  {
    "objectID": "chap4.html#software-wrpwreg",
    "href": "chap4.html#software-wrpwreg",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WR::pwreg()",
    "text": "Software: WR::pwreg()\n\nBasic syntax for PW\\((\\mathcal W_{\\rm P})\\)\n\n(ID, time, status): same as WR::WRrec()\nZ: covariate matrix; strata: possible stratifier (categorical)\n\n\n\n\nlibrary(WR)\n# fit PW model (death &gt; nonfatal event)\nobj &lt;- pwreg(ID, time, status, Z, strata = NULL)\n\n\n\nOutput: an object of class pwreg\n\nobj$beta: \\(\\hat\\beta\\)\nobj$Var: \\(\\hat\\var(\\hat\\beta)\\)\nprint(obj) to summarize regression results"
  },
  {
    "objectID": "chap4.html#software-wrscore.proc",
    "href": "chap4.html#software-wrscore.proc",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Software: WR::score.proc()",
    "text": "Software: WR::score.proc()\n\nChecking proportionality\n\nobj: a pwreg object\n\n\n\n\n# compute covariate-specific cumulative residuals\nscore.obj &lt;- score.proc(obj)\n\n\n\nOutput: an object of class score.proc\n\nscore.obj$t: \\(t\\)\nscore.obj$score: a matrix with rescaled residual process for each covariate per row\nplot(score.obj, k): plot the rescaled residuals for \\(k\\)th covariate"
  },
  {
    "objectID": "chap4.html#hf-action-non-ischemic",
    "href": "chap4.html#hf-action-non-ischemic",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Non-Ischemic",
    "text": "HF-ACTION: Non-Ischemic\n\nStudy information\n\nPopulation: 451 non-ischemic HF patients in HF-ACTION\nOutcome: death &gt; (first) hospitalization\nCovariates: treatment, age, sex, race, BMI, LVEF, histories of hypertension, COPD, diabetes, current use of ACE inhibitor, \\(\\beta\\)-blocker, smoking status\n\n\n\nlibrary(WR)\nhead(non_ischemic)\n#&gt;   ID time status trt_ab age sex Black.vs.White Other.vs.White   bmi\n#&gt; 1  1  221      2      0  62   1              0              0 25.18\n#&gt; 2  1  383      0      0  62   1              0              0 25.18\n#&gt; 3  2   23      2      0  75   1              1              0 22.96\n#&gt; 4  2 1400      0      0  75   1              1              0 22.96\n#&gt; ..."
  },
  {
    "objectID": "chap4.html#hf-action-table-one",
    "href": "chap4.html#hf-action-table-one",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Table One",
    "text": "HF-ACTION: Table One\n\n\nTable 1. Patient characteristics in non-ischemic cohort of HF-ACTION\n\n\n\n\n\n\n\n\nUsual care (N=231)\nTraining (N=220)\n\n\n\n\nAge (years)\n56 (46, 65.5)\n54 (46, 62.2)\n\n\nSex - Female\n153 (66.2%)\n121 (55%)\n\n\nSex - Male\n78 (33.8%)\n99 (45%)\n\n\nRace - White\n117 (50.6%)\n111 (50.5%)\n\n\nRace - Black\n103 (44.6%)\n101 (45.9%)\n\n\nRace - Other\n11 (4.8%)\n8 (3.6%)\n\n\nBMI\n31.3 (26.3, 37.2)\n31 (25.8, 36.5)\n\n\nLVEF (%)\n25.1 (20.9, 31.3)\n25.1 (20.9, 31.2)\n\n\nHypertension\n129 (55.8%)\n129 (58.6%)\n\n\nCOPD\n21 (9.1%)\n15 (6.8%)\n\n\nDiabetes\n71 (30.7%)\n58 (26.4%)\n\n\nACE Inhibitor\n174 (75.3%)\n167 (75.9%)\n\n\nBeta Blocker\n223 (96.5%)\n211 (95.9%)"
  },
  {
    "objectID": "chap4.html#hf-action-pw-regression",
    "href": "chap4.html#hf-action-pw-regression",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: PW Regression",
    "text": "HF-ACTION: PW Regression\n\nFit PW(\\(\\mathcal W_{\\rm P}\\))\n\nDeath &gt; (first) hospitalization\n\n\n\n# number of covariates (-c(ID, time, status))\np &lt;- ncol(non_ischemic) - 3\n\n# extract ID, time, status and covariates matrix Z from the data.\n# note that: ID, time and status should be column vector\nID &lt;- non_ischemic[,\"ID\"]\ntime &lt;- non_ischemic[,\"time\"] / 30.5 # days to months\nstatus &lt;- non_ischemic[,\"status\"]\nZ &lt;- as.matrix(non_ischemic[, 4:(3+p)])\n\n# pass the parameters into the function\nobj &lt;- pwreg(ID, time, status, Z)"
  },
  {
    "objectID": "chap4.html#hf-action-results-i",
    "href": "chap4.html#hf-action-results-i",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Results (I)",
    "text": "HF-ACTION: Results (I)\n\nModel summary\n\n\nobj\n#&gt; Call:\n#&gt; pwreg(ID = ID, time = time, status = status, Z = Z)\n\n#&gt; Total number of pairs: 101475 \n#&gt; Wins-losses on death:  7644 (7.5%) \n#&gt; Wins-losses on non-fatal event:  78387 (77.2%) \n#&gt; Indeterminate pairs 15444 (15.2%) \n#&gt; \n#&gt; Newton-Raphson algorithm converged in 5 iterations.\n#&gt; \n#&gt; Overall test: chisq test with 13 degrees of freedom; \n#&gt;  Wald statistic 24.9 with p-value 0.02392931"
  },
  {
    "objectID": "chap4.html#hf-action-results-ii",
    "href": "chap4.html#hf-action-results-ii",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Results (II)",
    "text": "HF-ACTION: Results (II)\n\nInference table for \\(\\hat\\beta\\)\n\nAge, black vs white, LVEF significant\n\n\n\nobj\n#&gt;                     Estimate         se z.value p.value  \n#&gt; Training vs Usual  0.1906687  0.1264658  1.5077 0.13164  \n#&gt; Age (year)        -0.0128306  0.0057285 -2.2398 0.02510 *\n#&gt; Male vs Female    -0.1552923  0.1294198 -1.1999 0.23017  \n#&gt; Black vs White    -0.3026335  0.1461330 -2.0709 0.03836 *\n#&gt; Other vs White    -0.3565390  0.3424360 -1.0412 0.29779  \n#&gt; BMI               -0.0181310  0.0097582 -1.8580 0.06316 .\n#&gt; LVEF               0.0214905  0.0086449  2.4859 0.01292 *\n#&gt; Hypertension      -0.0318291  0.1456217 -0.2186 0.82698  \n#&gt; COPD              -0.4023069  0.2066821 -1.9465 0.05159 .\n#&gt; Diabetes           0.0703990  0.1419998  0.4958 0.62006  \n#&gt; ACE Inhibitor     -0.1068201  0.1571317 -0.6798 0.49662  \n#&gt; Beta Blocker      -0.5344979  0.3289319 -1.6250 0.10417  \n#&gt; Smoker            -0.0602350  0.1682826 -0.3579 0.72039"
  },
  {
    "objectID": "chap4.html#hf-action-race-effect",
    "href": "chap4.html#hf-action-race-effect",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Race Effect",
    "text": "HF-ACTION: Race Effect\n\nJoint test \\((\\chi_2^2)\\) on race categories\n\nBlack/African American, white, other\n\n\n\n# extract estimates of (beta_4, beta_5)\nbeta &lt;- matrix(obj$beta[4:5])\n# extract estimated covariance matrix for (beta_4, beta_5)\nSigma &lt;- obj$Var[4:5, 4:5]\n# compute chisq statistic in quadratic form\nchistats &lt;- t(beta) %*% solve(Sigma) %*% beta  \n\n# compare the Wald statistic with the reference\n# distribution of chisq(2) to obtain the p-value\n1 - pchisq(chistats, df = 2)\n#&gt;           [,1]\n#&gt; [1,] 0.1016988"
  },
  {
    "objectID": "chap4.html#hf-action-win-ratio-table",
    "href": "chap4.html#hf-action-win-ratio-table",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Win Ratio Table",
    "text": "HF-ACTION: Win Ratio Table\n\nCovariate-specific WRs \\(\\exp(\\hat\\beta)\\)\n\nTraining wins 21.0% more than usual care\n\n\n\n#&gt; Point and interval estimates for the win ratios:\n#&gt;                   Win Ratio 95% lower CL 95% higher CL\n#&gt; Training vs Usual 1.2100585    0.9444056     1.5504374\n#&gt; Age (year)        0.9872513    0.9762288     0.9983983\n#&gt; Male vs Female    0.8561648    0.6643471     1.1033663\n#&gt; Black vs White    0.7388699    0.5548548     0.9839127\n#&gt; Other vs White    0.7000951    0.3578286     1.3697431\n#&gt; BMI               0.9820323    0.9634287     1.0009952\n#&gt; LVEF              1.0217231    1.0045572     1.0391823\n#&gt; Hypertension      0.9686721    0.7281543     1.2886357\n#&gt; COPD              0.6687755    0.4460178     1.0027865\n#&gt; Diabetes          1.0729362    0.8122757     1.4172433\n#&gt; ACE Inhibitor     0.8986873    0.6604773     1.2228110\n#&gt; Beta Blocker      0.5859634    0.3075270     1.1164977\n#&gt; Smoker            0.9415433    0.6770144     1.3094312"
  },
  {
    "objectID": "chap4.html#hf-action-residual-analysis",
    "href": "chap4.html#hf-action-residual-analysis",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Residual Analysis",
    "text": "HF-ACTION: Residual Analysis\n\nCheck proportionality assumption on covariates\n\n\n# compute score processes\nscore_obj &lt;- score.proc(obj)\n# plot scores for first 8 covariates\npar(mfrow = c(2, 4))\nfor(i in c(1 : 8)){\n  plot(score_obj, k = i, xlab = \"Time (months)\")\n  # add reference lines\n  abline(a = 2, b = 0, lty = 3)\n  abline(a = 0, b = 0, lty = 3)\n  abline(a = - 2, b = 0, lty = 3)\n}"
  },
  {
    "objectID": "chap4.html#hf-action-residual-plot",
    "href": "chap4.html#hf-action-residual-plot",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "HF-ACTION: Residual Plot",
    "text": "HF-ACTION: Residual Plot\n\nMostly well-behaved \n\nExercise: Fit stratified PW model by sex"
  },
  {
    "objectID": "chap4.html#alternative-modeling",
    "href": "chap4.html#alternative-modeling",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Alternative Modeling",
    "text": "Alternative Modeling\n\nExtension of proportional odds (PO)?\n\nUnivariate PO model (Bennett, 1983) \\[\n\\log\\left\\{\\frac{\\pr(D\\leq t)}{\\pr(D &gt; t)}\\right\\}=h(t) + \\beta^\\T Z\n\\]\n\n\\(\\exp(\\beta)\\): Odds ratios (OR) of having early death (regardless of time cut-off)\n\n\n\n\n\n\n\nUnivariate\nHierarchical composite\n\n\n\n\nHypothesis testing\nGehan, log-rank\nWin ratio/odds, net benefit (Ch 2)\n\n\nNonparametric estimation\nRMST\nRMT-IF (Ch 3)\n\n\nSemiparametric regression\nCox PH model\nPO model\nPW model (Ch 4)\n?"
  },
  {
    "objectID": "chap4.html#model-specification-1",
    "href": "chap4.html#model-specification-1",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Model Specification",
    "text": "Model Specification\n\nOutcome formulation\n\nMultistate process \\(Y(0)=0, 1,\\ldots, K, \\infty\\) (hierarchically ordered)\n\nGeneralized PO model \\[\n\\log\\left[\\frac{\\pr\\{Y(t)&gt;k\\}}{\\pr\\{Y(t)\\leq k\\}}\\right]=h_k(t) + \\beta^\\T Z\n\\]\n\n\\(\\exp(\\beta)\\): ORs of having early and less favorable outcomes (regardless of time and favorability cut-off)\n\nTwo-way (time & order) proportionality\n\\(K=0\\) \\(\\to\\) Univariate PO"
  },
  {
    "objectID": "chap4.html#estimation-problem",
    "href": "chap4.html#estimation-problem",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Estimation Problem",
    "text": "Estimation Problem\n\nMain challenge\n\nNonparametric baseline log-odds \\(h_k(t)\\)\nModel does not determine likelihood \\(\\to\\) MLE\n\nUnlike univariate PO (Murphy et al., 1997)\n\n\nPossible solutions\n\nPosit a nuisance (Markov) model for \\(Y(t)\\) \\(\\to\\) MLE\nFind estimating functions under marginal model alone"
  },
  {
    "objectID": "chap4.html#notes",
    "href": "chap4.html#notes",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Notes",
    "text": "Notes\n\nMore on PW\n\nCheck functional form (linear, quadratic, grouped) of \\(Z\\) (Lin et al., 1993)\n\nE.g., is age effect linear?\n\n\\[\n    \\mbox{plot} \\sum_{i, j: Z_i - Z_j\\leq z}(Z_i - Z_j)M_{ij}(\\infty \\mid Z_i, Z_j;\\hat\\beta) \\mbox{ against } z\\in\\mathbb R\n    \\]\nCurrently WR::pwreg() implements only PW(\\(\\mathcal W_{\\rm P}\\))\n\nMore functionalities to be added\n\nVariations: regression of win ratio/odds (Follmann et al., 2019; Song et al., 2022)"
  },
  {
    "objectID": "chap4.html#summary",
    "href": "chap4.html#summary",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Summary",
    "text": "Summary\n\nPW: WR regression\n\nProportionality and multiplicativity \\[\nWR(t\\mid Z_i, Z_j;\\mathcal W)=\\exp\\left\\{\\beta^{\\rm T}\\left(Z_i- Z_j\\right)\\right\\}\n\\]\n\n\\(\\exp(\\beta)\\): WRs with unit increases in covariates\nWR::pwreg(ID, time, status, Z, strata)\n\n\nRegularized PW\n\nwrnet: https://lmaowisc.github.io/wrnet/\nEfficient implementation with glmnet() backend\nSupports CV, test evaluation, and variable importance"
  },
  {
    "objectID": "chap4.html#references",
    "href": "chap4.html#references",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "References",
    "text": "References\n\n\n\n\nCheung, L. C., Pan, Q., Hyun, N., & Katki, H. A. (2019). Prioritized concordance index for hierarchical survival outcomes. Statistics in Medicine, 38(15), 2868–2882.\n\n\nDong, G., Hoaglin, D. C., Huang, B., Cui, Y., Wang, D., Cheng, Y., & Gamalo-Siebers, M. (2023). The stratified win statistics (win ratio, win odds, and net benefit). Pharmaceutical Statistics, 22(4), 748–756. https://doi.org/10.1002/pst.2293\n\n\nDong, G., Qiu, J., Wang, D., & Vandemeulebroecke, M. (2017). The stratified win ratio. Journal of Biopharmaceutical Statistics, 28(4), 778–796. https://doi.org/10.1080/10543406.2017.1397007\n\n\nFollmann, D., Fay, M. P., Hamasaki, T., & Evans, S. (2019). Analysis of ordered composite endpoints. Statistics in Medicine, 39(5), 602–616. https://doi.org/10.1002/sim.8431\n\n\nFriedman, J., Hastie, T., & Tibshirani, R. (2010). Regularization paths for generalized linear models via coordinate descent. Journal of Statistical Software, 33(1), 1.\n\n\nHarrell, F. E., Califf, R. M., Pryor, D. B., Lee, K. L., & Rosati, R. A. (1982). Evaluating the yield of medical tests. JAMA, 247(18), 2543–2546.\n\n\nLin, D. Y., Wei, L. J., & Ying, Z. (1993). Checking the Cox model with cumulative sums of martingale-based residuals. Biometrika, 80(3), 557–572. https://doi.org/10.1093/biomet/80.3.557\n\n\nMao, L. (2025). Regularized win ratio regression for variable selection and risk prediction, with an application to a cardiovascular trial. BMC Medical Research Methodology, 25(1). https://doi.org/10.1186/s12874-025-02554-w\n\n\nMao, L., & Wang, T. (2021). A class of proportional win-fractions regression models for composite outcomes. Biometrics, 77(4), 1265–1275. https://doi.org/10.1111/biom.13382\n\n\nSong, J., Verbeeck, J., Huang, B., Hoaglin, D. C., Gamalo-Siebers, M., Seifu, Y., Wang, D., Cooner, F., & Dong, G. (2022). The win odds: statistical inference and regression. Journal of Biopharmaceutical Statistics, 33(2), 140–150. https://doi.org/10.1080/10543406.2022.2089156\n\n\nUno, H., Cai, T., Pencina, M. J., D’Agostino, R. B., & Wei, L.-J. (2011). On the c-statistics for evaluating overall adequacy of risk prediction procedures with censored survival data. Statistics in Medicine, 30(10), 1105–1117.\n\n\nWang, T., & Mao, L. (2022). Stratified proportional win-fractions regression analysis. Statistics in Medicine, 41(26), 5305–5318. https://doi.org/10.1002/sim.9570\n\n\nZou, H., & Hastie, T. (2005). Regularization and variable selection via the elastic net. Journal of the Royal Statistical Society Series B: Statistical Methodology, 67(2), 301–320."
  },
  {
    "objectID": "chap4.html#regularized-pw-model",
    "href": "chap4.html#regularized-pw-model",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Regularized PW model",
    "text": "Regularized PW model\n\nObjective function (Mao, 2025; Zou & Hastie, 2005): \\[\\begin{align}\\label{eq:obj_fun}\nl_n(\\beta;\\lambda) &= - |\\mathcal R|^{-1}\\sum_{(i, j)\\in\\mathcal R}\\left[\\delta_{ij}\\beta^\\T z_{ij} - \\log\\{1+\\exp(\\beta^\\T z_{ij})\\}\\right]\\notag\\\\\n&\\hspace{3em}+\\lambda\\left\\{(1-\\alpha)||\\beta||_2^2/2+\\alpha||\\beta||_1\\right\\}\n\\end{align}\\]\n\nPathwise solution \\(\\hat\\beta(\\lambda) = \\arg\\min_\\beta l_n(\\beta;\\lambda)\\)\n\nNumerically equivalent to regularized logistic regression\n\nTuning parameter \\(\\lambda\\geq 0\\)—determined by cross-validation (CV)\n\n\\(\\partial l_n(\\beta; 0)/\\partial\\beta = U_n(\\beta)\\)\n\nMixing parameter \\(\\alpha \\in (0, 1)\\)\n\n\\(\\alpha &gt; 0\\) \\(\\longrightarrow\\) some components of \\(\\hat\\beta(\\lambda)=0\\) (performs variable selection)"
  },
  {
    "objectID": "chap4.html#pathwise-solution",
    "href": "chap4.html#pathwise-solution",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Pathwise Solution",
    "text": "Pathwise Solution\n\nPathwise algorithm (Friedman et al., 2010)\n\nEfficient computation of \\(\\hat\\beta(\\lambda)\\) for all \\(\\lambda\\)\n\n\nglmnet::glmnet(x, y, family = \"binomial\", intercept = FALSE, lambda)\n\n\nx: covariate matrix containing \\(z_{ij}\\) ,\ny: response vector \\(\\delta_{ij}\\)\nintercept = FALSE removes intercept\nlambda: user-specified \\(\\lambda\\) vector"
  },
  {
    "objectID": "chap4.html#cross-validation",
    "href": "chap4.html#cross-validation",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Cross Validation",
    "text": "Cross Validation\n\nCV routine for logistic regression cv.glmnet()\n\nPartition pairs into \\(k\\) folds—train and validate\nBuilt-in cv.glmnet()\nNot appropriate\n\nOverlap between analysis and validation sets\nInflation of sample size\n\n\nSubject-based CV\n\nPartition subjects into \\(k\\) folds \\(\\mathcal{S}^{(k)}\\)\nTrain on \\(\\mathcal{S}^{(-k)}\\): \\(\\hat\\beta^{(-k)}(\\lambda)\\) \\(\\longrightarrow\\) validate on \\(\\mathcal{S}^{(k)}\\)\nIdentify optimal \\(\\lambda\\) maximizing average concordance index"
  },
  {
    "objectID": "chap4.html#winrisk-score",
    "href": "chap4.html#winrisk-score",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Win/Risk Score",
    "text": "Win/Risk Score\n\nMotivation\n\nModel-predicted win probability given comparability \\[\\mu(z_i, z_j;\\beta)=\\frac{\\exp\\{\\beta^\\T(z_i-z_j)\\}}{1 + \\exp\\{\\beta^\\T(z_i-z_j)\\}}\\]\n\\(\\beta^\\T z\\) measures tendency to win \\[\\begin{align*}\n\\mu(z_i, z_j;\\beta) &gt; 0.5 &\\Leftrightarrow \\beta^\\T z_i &gt; \\beta^\\T z_j;\\\\\n\\mu(z_i, z_j;\\beta) = 0.5 &\\Leftrightarrow \\beta^\\T z_i = \\beta^\\T z_j;\\\\\n\\mu(z_i, z_j;\\beta) &lt; 0.5 &\\Leftrightarrow \\beta^\\T z_i &lt; \\beta^\\T z_j.\n\\end{align*}\\]\n\\(-\\beta^\\T z\\): risk score"
  },
  {
    "objectID": "chap4.html#generalized-concordance-index",
    "href": "chap4.html#generalized-concordance-index",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Generalized Concordance Index",
    "text": "Generalized Concordance Index\n\nValidation/test set \\(\\mathcal S^*\\)\n\nPairwise indices \\[\n\\mathcal R^* = \\{(i,j): \\delta_{ij}+\\delta_{ji}\\neq 0; i&lt;j; i,j\\in\\S^*\\}\n\\]\n\nConcordance (Cheung et al., 2019; Harrell et al., 1982; Uno et al., 2011)\n\nProportion of correct ranking of pairs \\[\\begin{equation}\\label{eq:c_index}\n\\mathcal C(\\S^*;\\beta) = |\\mathcal R^*|^{-1}\\sum_{(i, j)\\in\\mathcal R^*}\n\\bigl[\\underbrace{I\\{(2\\delta_{ij} -1)(\\beta^\\T z_i - \\beta^\\T z_j)&gt;0\\}}_{\\text{Concordant pair}}+2^{-1}\n\\underbrace{I(\\beta^\\T z_i = \\beta^\\T z_j)}_{\\text{Tied score}}\\bigr]\n\\end{equation}\\]"
  },
  {
    "objectID": "chap4.html#validation-and-testing",
    "href": "chap4.html#validation-and-testing",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Validation and Testing",
    "text": "Validation and Testing\n\nModel tuning\n\n\\(k\\)th-fold CV concordance: \\(C^{(k)}(\\lambda) = \\mathcal C\\left(\\Sk;\\wh\\beta^{(-k)}(\\lambda)\\right)\\)\nOptimal \\(\\lambda_{\\rm opt} = \\arg\\max_\\lambda K^{-1}\\sum_{k=1}^K\\C^{(k)}(\\lambda)\\)\nFinal model: \\(\\wh\\beta(\\lambda_{\\rm opt})\\)\n\nVariable importance\n\nComponent-wise \\(|\\beta|/\\text{sd}(z)\\)\n\nTest C-index\n\n\\(\\mathcal C(\\S^*;\\wh\\beta(\\lambda_{\\rm opt}))\\) for test set \\(\\S^*\\)"
  },
  {
    "objectID": "chap4.html#standard-model-fitting",
    "href": "chap4.html#standard-model-fitting",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Standard Model-Fitting",
    "text": "Standard Model-Fitting\n\nEstimating equation \\[\\begin{equation}\nU_n(\\beta) = |\\mathcal R|^{-1} \\sum_{(i, j)\\in \\mathcal R}\nz_{ij} \\left\\{ \\delta_{ij} - \\frac{\\exp(\\beta^\\top z_{ij})}{1 + \\exp(\\beta^\\top z_{ij})} \\right\\}\n\\end{equation}\\]\n\n\\(z_{ij} = z_i - z_j\\): covariate difference\n\n\\(\\delta_{ij} = \\mathcal{W}(\\bs Y_i, \\bs Y_j)(X_i \\wedge X_j)\\): observed win indicator\n\\(\\mathcal{R}=\\{(i, j): \\delta_{ij} + \\delta_{ji} &gt; 0\\}\\): set of comparable pairs\n\nHigh-dimensional \\(z\\)?\n\nVariable selection\nImprove generalizability"
  },
  {
    "objectID": "chap4.html#workflow---input-data",
    "href": "chap4.html#workflow---input-data",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Input Data",
    "text": "Workflow - Input Data\n\nData format\n\nLong format with columns: id, time, status, and covariates\n\n\n# Load package containing data\nlibrary(WR)\ndf &lt;- gbc # n = 686 subjects, p = 9 covariates\ndf # status = 0 (censored), 1 (death), 2 (recurrence)\n#&gt;   id      time status hormone age menopause size grade ...\n#&gt;1   1 43.836066      2       1  38         1   18     3  \n#&gt;2   1 74.819672      0       1  38         1   18     3  \n#&gt;3   2 46.557377      2       1  52         1   20     1   \n#&gt;4   2 65.770492      0       1  52         1   20     1  \n#&gt;5   3 41.934426      2       1  47         1   30     2   \n#&gt;..."
  },
  {
    "objectID": "chap4.html#workflow---data-partitioning",
    "href": "chap4.html#workflow---data-partitioning",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Data Partitioning",
    "text": "Workflow - Data Partitioning\n\nSplitting data\n\nwr_split() function\n\n\n\n# Data partitioning ------------------------------------\nset.seed(123)\nobj_split &lt;- df |&gt; wr_split(prop = 0.8) # 80% training, 20% test\n# Take training and test set\ndf_train &lt;- obj_split$df_train\ndf_test &lt;- obj_split$df_test"
  },
  {
    "objectID": "chap4.html#workflow---cross-validation-i",
    "href": "chap4.html#workflow---cross-validation-i",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Cross-Validation (I)",
    "text": "Workflow - Cross-Validation (I)\n\n\\(k\\)-fold CV\n\ncv_wrnet(id, time, status, Z, k = 10, ...)\n\n\n\n# 10-fold CV -------------------------------------------\nset.seed(1234)\nobj_cv &lt;- cv_wrnet(df_train$id, df_train$time, df_train$status, \n                    df_train |&gt; select(-c(id, time, status)))\n# Plot CV results (C-index vs log-lambda)\nobj_cv |&gt; \n   ggplot(aes(x =  log(lambda), y = concordance)) +\n   geom_point() + geom_line() + theme_minimal()\n# Optimal lambda\nlambda_opt &lt;- obj_cv$lambda[which.max(obj_cv$concordance)]\nlambda_opt\n#&gt; [1] 0.0171976"
  },
  {
    "objectID": "chap4.html#workflow---cross-validation-ii",
    "href": "chap4.html#workflow---cross-validation-ii",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Cross-Validation (II)",
    "text": "Workflow - Cross-Validation (II)\n\nValidation C-index"
  },
  {
    "objectID": "chap4.html#workflow---final-model",
    "href": "chap4.html#workflow---final-model",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Final Model",
    "text": "Workflow - Final Model\n\nFit final model\n\nwrnet(id, time, status, Z, lambda = lambda_opt, ...)\n\n\n# Final model ------------------------------------------\nfinal_fit &lt;- wrnet(df_train$id, df_train$time, df_train$status, \n          df_train |&gt; select(-c(id, time, status)), lambda = lambda_opt)\nfinal_fit$beta # Estimated coefficients\n#&gt;                      s0\n#&gt; hormone     0.306026364\n#&gt; age         0.003111462\n#&gt; menopause   .          \n#&gt; size       -0.007720497\n#&gt; grade      -0.285511701\n#&gt; nodes      -0.082227827\n#&gt; prog_recp   0.001861367\n#&gt; estrg_recp  ."
  },
  {
    "objectID": "chap4.html#workflow---variable-importance",
    "href": "chap4.html#workflow---variable-importance",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Variable Importance",
    "text": "Workflow - Variable Importance\n\nVariable importance\n\n\nfinal_fit |&gt; vi_wrnet() |&gt; vip()"
  },
  {
    "objectID": "chap4.html#workflow---test-performance",
    "href": "chap4.html#workflow---test-performance",
    "title": "Statistical Methods for Composite Endpoints: Win Ratio and Beyond",
    "section": "Workflow - Test Performance",
    "text": "Workflow - Test Performance\n\nOverall and component-wise C-index\n\ntest_wrnet(final_fit, df_test)\n\n\n\n# Test model performance -------------------------------\ntest_result &lt;- final_fit |&gt; test_wrnet(df_test)\n# Overall and event-specific C-indices\ntest_result$concordance\n#&gt; # A tibble: 3 × 2\n#&gt;   component concordance\n#&gt;   &lt;chr&gt;           &lt;dbl&gt;\n#&gt; 1 death           0.724\n#&gt; 2 nonfatal        0.607\n#&gt; 3 overall         0.664"
  }
]